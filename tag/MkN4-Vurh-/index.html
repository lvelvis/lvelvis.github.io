<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="keywords" content="lvelvisä¸ªäººåšå®¢">
<meta name="description" content="æ—¶å…‰,æµ“æ·¡ç›¸å®œ;äººå¿ƒ,è¿œè¿‘ç›¸å®‰;è¿™å°±æ˜¯æœ€å¥½çš„ç”Ÿæ´»">
<meta name="theme-color" content="#000">
<title>lvelvis</title>
<link rel="shortcut icon" href="/favicon.ico?v=1591165356017">
<link rel="stylesheet" href="/styles/main.css">
<link rel="stylesheet" href="/media/css/mist.css">

<link rel="stylesheet" href="/media/fonts/font-awesome.css">
<link
  href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Rosario:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext"
  rel="stylesheet" type="text/css">

<link href="/media/hljs/styles/androidstudio.css"
  rel="stylesheet">

<script src="/media/hljs/highlight.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.ui.min.js"></script>

<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>



</head>

<body>
  <div class="head-top-line"></div>
  <div class="header-box">
    
<div class="mist">
  <header class="header bg-color ">
    <div class="blog-header box-shadow-wrapper  " id="header">
      <div class="nav-toggle" id="nav_toggle">
        <div class="toggle-box">
          <div class="line line-top"></div>
          <div class="line line-center"></div>
          <div class="line line-bottom"></div>
        </div>
      </div>
      <div class="site-meta">       
        <div class="site-title">
          
            <a href="/" class="">
              <span class="logo-line-before">
                <i class=""></i>
              </span>
              <span class="main-title">lvelvis</span>
              <span class="logo-line-after">
                <i class=""></i>
              </span>
            </a>  
          
        </div>
        
      </div>
      <nav class="site-nav" id="site_nav">
        <ul id="nav_ul">
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/" target="_self">
                  <i class="fa fa-home"></i> é¦–é¡µ
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/archives/" target="_self">
                  <i class="fa fa-archive"></i> å½’æ¡£
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/tags/" target="_self">
                  <i class="fa fa-tags"></i> æ ‡ç­¾
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/post/about/" target="_self">
                  <i class="fa fa-user"></i> å…³äº
                </a>
              
            </li>
          
          
            
              <li class="nav-item ">
                <a href="/friends/" target="_self">
                  
                    <i class="fa fa-address-book"></i> å‹æƒ…é“¾æ¥
                  
                </a>
              </li>
            
          
        </ul>
      </nav>
    </div>
  </header>
</div>

<script type="text/javascript"> 
 
  let showNav = true;

  let navToggle = document.querySelector('#nav_toggle'),
  siteNav = document.querySelector('#site_nav');
  
  function navClick() {
    let sideBar = document.querySelector('.sidebar');
    let navUl = document.querySelector('#nav_ul');
    navToggle.classList.toggle('nav-toggle-active');
    siteNav.classList.toggle('nav-menu-active');
    if (siteNav.classList.contains('nav-menu-active')) {
      siteNav.style = "height: " + (navUl.children.length * 42) +"px !important";
    } else {
      siteNav.style = "";
    }
  }

  navToggle.addEventListener('click',navClick);  
</script>
  </div>
  <div class="main-continer">
    
    <div
      class="section-layout bg-color mist">
      <div class="section-layout-wrapper">
        <div id="sidebarMeta" class="sidebar">
    
<div class="sidebar-wrapper box-shadow-wrapper ">
  <div class="sidebar-item">
    <img class="site-author-image right-motion" src="/images/avatar.png"/>
    <p class="site-author-name">lvelvis</p>
    
    <div class="site-description right-motion">
      
        <p id="binft">æ—¶å…‰,æµ“æ·¡ç›¸å®œ;äººå¿ƒ,è¿œè¿‘ç›¸å®‰;è¿™å°±æ˜¯æœ€å¥½çš„ç”Ÿæ´»</p>
      
    </div>
    
  </div>
  <div class="sidebar-item side-item-stat right-motion">
    <div class="sidebar-item-box">
      <a href="/archives/">
        
        <span class="site-item-stat-count">13</span>
        <span class="site-item-stat-name">æ–‡ç« </span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="">
        <span class="site-item-stat-count">13</span>
        <span class="site-item-stat-name">åˆ†ç±»</span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="/tags/">
        <span class="site-item-stat-count">13</span>
        <span class="site-item-stat-name">æ ‡ç­¾</span>
      </a>
    </div>
  </div>
  
  
    <div class="sidebar-item sidebar-item-social">
      <div class="social-item">
        
          
            <a href="https://github.com/lvelvis">
              <i class="fa fa-github-alt" title="github"></i>
            </a>
          
            <a href="tencent://AddContact/?fromId=45&amp;fromSubId=1&amp;subcmd=all&amp;uin=421220622&amp;website=www.oicqzone.com&#34;&gt;">
              <i class="fa fa-qq" title="QQ"></i>
            </a>
          
        
        
          
            <a class="social-img" href="#">
              <img src="\media\images\custom-array-imgSocials-1588146527513-socialImg.jpg" />
              <i class="fa fa-wechat" title="weixin" ></i>
            </a>
          
        
      </div>
    </div>
  


</div>
</div>
<script>
  let sidebarMeta = document.querySelector('#sidebarMeta');
  let scheme = 'mist';
  let sidebarWrapper = document.querySelector('.sidebar-wrapper');
  if (sidebarMeta && (scheme === 'pisces' || scheme === 'gemini')) {
    document.addEventListener('scroll', function(e) {
      if (document.scrollingElement.scrollTop > parseInt(sidebarMeta.style.marginTop) + 10) {
        sidebarWrapper.classList.add('home-sidebar-fixed')
      } else {
        sidebarWrapper.classList.remove('home-sidebar-fixed')
      }
    });
  }
  </script>
        <div class="section-box tag-line box-shadow-wrapper">
          <section class="section tags-section posts-expand bg-color">
            <div class="padding-wrapper">
  <div class="tag-timeline-box">
    <div class="tag-timeline-wrapper">
      <div class="tag-timeline-title">
        <h2>
          ceph
          <small>æ ‡ç­¾</small>
        </h2>
      </div>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <a href="http://lvelvis.github.io/post/kubernetesæ­å»ºrook-ceph/">
        <div class="motion-warpper">
          <div class="tag-post-node">
            <h1>
              12-12
              <small>kubernetesæ­å»ºrook-ceph</small>
            </h1>
          </div>
        </div>
      </a>
      
      
      
      
      
    </div>
  </div>
</div>
          </section>
        </div>
      </div>
    </div>
    <div class="footer-box">
  <footer class="footer">
    <div class="copyright">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | Â© 2020 Theme By elvis</a>
    </div>
    <div class="poweredby">
      <center><iframe width="280" scrolling="no" height="25" frameborder="0" allowtransparency="true" src="http://i.tianqi.com/index.php?c=code&id=34&icon=1&num=3"></iframe></center><center><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=100 src="//music.163.com/outchain/player?type=0&id=3135828147&auto=1&height=430"></iframe></center><marquee scrollamount="5" ><h2 class="wow fadeIn animated" data-wow-delay="1250ms" style="visibility: visible; animation-delay: 1250ms; animation-name: fadeIn;"><font face="Orbitron" style="color:#CC0707;text-shadow: 0 0 0.9em #6EC101,0 0 0.9em
Yellow;"><b><?php echo $conf['xbmz']?></b></font></h2></marquee>
  <script type="text/javascript"> 
  document.onkeydown = function(event){
   if ((event.ctrlKey)&&(event.keyCode==115 || event.keyCode==83)){
    event.returnValue=false;
    return;
   } 
  }
 </script>
<script async src="https://api.ly522.com/js/jilei.pure.mini.js"></script>
<span id="jilei_container_site_pv">æ€»è®¿é—®é‡<span id="jilei_value_site_pv"></span>æ¬¡</span>
<span class="post-meta-divider">|</span>
<span id="jilei_container_site_uv">åœ¨çº¿äººæ•°<span id="jilei_value_site_uv"></span>äºº</span></p>
    </div>
  </footer>
  
  
    <div class="drawer-box left" id="drawer_box">
      <span class="muse-line muse-line-first"></span>
      <span class="muse-line muse-line-middle"></span>
      <span class="muse-line muse-line-last"></span>
    </div>
  
  <div class="mist back-to-top" id="back_to_top">
    <i class="fa fa-arrow-up"></i>
    
  </div>
  
  
    
<link rel="stylesheet" href="/media/live2d/css/live2d.css" />
<div class="box-scale">
  <div id="landlord" style="left: 5px;bottom: px;"
    data-key="">
    <canvas id="live2d" width="500" height="560" class="live2d"></canvas>
    

      <div class="message" style="opacity:0"></div>
      <div class="live_talk_input_body">
        <div class="live_talk_input_name_body">
          <input name="name" type="text" class="live_talk_name white_input" id="AIuserName" autocomplete="off"
            placeholder="ä½ çš„åå­—" />
        </div>
        <div class="live_talk_input_text_body">
          <input name="talk" type="text" class="live_talk_talk white_input" id="AIuserText" autocomplete="off"
            placeholder="è¦å’Œæˆ‘èŠä»€ä¹ˆå‘€ï¼Ÿ" />
          <button type="button" class="live_talk_send_btn" id="talk_send">å‘é€</button>
        </div>
      </div>
      <input name="live_talk" id="live_talk" value="1" type="hidden" />
      <div class="live_ico_box">
        <div class="live_ico_item type_info" id="showInfoBtn"></div>
        <div class="live_ico_item type_talk" id="showTalkBtn"></div>
        
        <div class="live_ico_item type_music" id="musicButton"></div>
        
        <div class="live_ico_item type_youdu" id="youduButton"></div>
        <div class="live_ico_item type_quit" id="hideButton"></div>
        <input name="live_statu_val" id="live_statu_val" value="0" type="hidden" />
        <audio src="" style="display:none;" id="live2d_bgm" data-bgm="0" preload="none"></audio>
        <input id="duType" value="douqilai" type="hidden">
        
        <input name="live2dBGM" value="" type="hidden">
        
      </div>
    
  </div>
</div>
<div id="open_live2d">å¬å”¤çœ‹æ¿å¨˜</div>
<script src="https://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
<script>
  var message_Path = 'https://cdn.jsdelivr.net/gh/hsxyhao/live2d.github.io@master/';
  let landlord = document.querySelector('#landlord');
  var apiKey = landlord.dataset.key;
</script>
<script type="text/javascript" src="/media/live2d/js/live2d.js"></script>
<script>
	var home_Path = document.location.protocol + '//' + window.document.location.hostname + ":" + window.document.location.port + '/';
	var userAgent = window.navigator.userAgent.toLowerCase();
	var norunAI = ["android", "iphone", "ipod", "ipad", "windows phone", "mqqbrowser", "msie", "trident/7.0"];
	var norunFlag = false;

	for (var i = 0; i < norunAI.length; i++) {
		if (userAgent.indexOf(norunAI[i]) > -1) {
			norunFlag = true;
			break;
		}
	}

	if (!window.WebGLRenderingContext) {
		norunFlag = true;
	}

	if (!norunFlag) {
		var hitFlag = false;
		var AIFadeFlag = false;
		var liveTlakTimer = null;
		var sleepTimer_ = null;
		var AITalkFlag = false;
		var talkNum = 0;
		(function () {
			function renderTip(template, context) {
				var tokenReg = /(\\)?\{([^\{\}\\]+)(\\)?\}/g;
				return template.replace(tokenReg, function (word, slash1, token, slash2) {
					if (slash1 || slash2) {
						return word.replace('\\', '');
					}
					var variables = token.replace(/\s/g, '').split('.');
					var currentObject = context;
					var i, length, variable;
					for (i = 0, length = variables.length; i < length; ++i) {
						variable = variables[i];
						currentObject = currentObject[variable];
						if (currentObject === undefined || currentObject === null) return '';
					}
					return currentObject;
				});
			}

			String.prototype.renderTip = function (context) {
				return renderTip(this, context);
			};

			var re = /x/;
			re.toString = function () {
				showMessage('å“ˆå“ˆï¼Œä½ æ‰“å¼€äº†æ§åˆ¶å°ï¼Œæ˜¯æƒ³è¦çœ‹çœ‹æˆ‘çš„ç§˜å¯†å—ï¼Ÿ', 5000);
				return '';
			};

			$(document).on('copy', function () {
				showMessage('ä½ éƒ½å¤åˆ¶äº†äº›ä»€ä¹ˆå‘€ï¼Œè½¬è½½è¦è®°å¾—åŠ ä¸Šå‡ºå¤„å“¦~~', 5000);
			});

			function initTips() {
				$.ajax({
					cache: true,
					url: message_Path + 'message.json',
					dataType: "json",
					success: function (result) {
						$.each(result.mouseover, function (index, tips) {
							$(tips.selector).mouseover(function () {
								var text = tips.text;
								if (Array.isArray(tips.text)) text = tips.text[Math.floor(Math.random() * tips.text.length + 1) - 1];
								text = text.renderTip({ text: $(this).text() });
								showMessage(text, 3000);
								talkValTimer();
								clearInterval(liveTlakTimer);
								liveTlakTimer = null;
							});
							$(tips.selector).mouseout(function () {
								showHitokoto();
								if (liveTlakTimer == null) {
									liveTlakTimer = window.setInterval(function () {
										showHitokoto();
									}, 15000);
								};
							});
						});
						$.each(result.click, function (index, tips) {
							$(tips.selector).click(function () {
								if (hitFlag) {
									return false
								}
								hitFlag = true;
								setTimeout(function () {
									hitFlag = false;
								}, 8000);
								var text = tips.text;
								if (Array.isArray(tips.text)) text = tips.text[Math.floor(Math.random() * tips.text.length + 1) - 1];
								text = text.renderTip({ text: $(this).text() });
								showMessage(text, 3000);
							});
							clearInterval(liveTlakTimer);
							liveTlakTimer = null;
							if (liveTlakTimer == null) {
								liveTlakTimer = window.setInterval(function () {
									showHitokoto();
								}, 15000);
							};
						});
					}
				});
			}
			initTips();

			var text;
			if (document.referrer !== '') {
				var referrer = document.createElement('a');
				referrer.href = document.referrer;
				text = 'å—¨ï¼æ¥è‡ª <span style="color:#0099cc;">' + referrer.hostname + '</span> çš„æœ‹å‹ï¼';
				var domain = referrer.hostname.split('.')[1];
				if (domain == 'baidu') {
					text = 'å—¨ï¼ æ¥è‡ª ç™¾åº¦æœç´¢ çš„æœ‹å‹ï¼<br>æ¬¢è¿è®¿é—®<span style="color:#0099cc;">ã€Œ ' + document.title.split(' - ')[0] + ' ã€</span>';
				} else if (domain == 'so') {
					text = 'å—¨ï¼ æ¥è‡ª 360æœç´¢ çš„æœ‹å‹ï¼<br>æ¬¢è¿è®¿é—®<span style="color:#0099cc;">ã€Œ ' + document.title.split(' - ')[0] + ' ã€</span>';
				} else if (domain == 'google') {
					text = 'å—¨ï¼ æ¥è‡ª è°·æ­Œæœç´¢ çš„æœ‹å‹ï¼<br>æ¬¢è¿è®¿é—®<span style="color:#0099cc;">ã€Œ ' + document.title.split(' - ')[0] + ' ã€</span>';
				}
			} else {
				if (window.location.href == home_Path) { //ä¸»é¡µURLåˆ¤æ–­ï¼Œéœ€è¦æ–œæ ç»“å°¾
					var now = (new Date()).getHours();
					if (now > 23 || now <= 5) {
						text = 'ä½ æ˜¯å¤œçŒ«å­å‘€ï¼Ÿè¿™ä¹ˆæ™šè¿˜ä¸ç¡è§‰ï¼Œæ˜å¤©èµ·çš„æ¥å˜›ï¼Ÿ';
					} else if (now > 5 && now <= 7) {
						text = 'æ—©ä¸Šå¥½ï¼ä¸€æ—¥ä¹‹è®¡åœ¨äºæ™¨ï¼Œç¾å¥½çš„ä¸€å¤©å°±è¦å¼€å§‹äº†ï¼';
					} else if (now > 7 && now <= 11) {
						text = 'ä¸Šåˆå¥½ï¼å·¥ä½œé¡ºåˆ©å˜›ï¼Œä¸è¦ä¹…åï¼Œå¤šèµ·æ¥èµ°åŠ¨èµ°åŠ¨å“¦ï¼';
					} else if (now > 11 && now <= 14) {
						text = 'ä¸­åˆäº†ï¼Œå·¥ä½œäº†ä¸€ä¸ªä¸Šåˆï¼Œç°åœ¨æ˜¯åˆé¤æ—¶é—´ï¼';
					} else if (now > 14 && now <= 17) {
						text = 'åˆåå¾ˆå®¹æ˜“çŠ¯å›°å‘¢ï¼Œä»Šå¤©çš„è¿åŠ¨ç›®æ ‡å®Œæˆäº†å—ï¼Ÿ';
					} else if (now > 17 && now <= 19) {
						text = 'å‚æ™šäº†ï¼çª—å¤–å¤•é˜³çš„æ™¯è‰²å¾ˆç¾ä¸½å‘¢ï¼Œæœ€ç¾ä¸è¿‡å¤•é˜³çº¢~~';
					} else if (now > 19 && now <= 21) {
						text = 'æ™šä¸Šå¥½ï¼Œä»Šå¤©è¿‡å¾—æ€ä¹ˆæ ·ï¼Ÿ';
					} else if (now > 21 && now <= 23) {
						text = 'å·²ç»è¿™ä¹ˆæ™šäº†å‘€ï¼Œæ—©ç‚¹ä¼‘æ¯å§ï¼Œæ™šå®‰~~';
					} else {
						text = 'å—¨~ å¿«æ¥é€—æˆ‘ç©å§ï¼';
					}
				} else {
					text = 'æ¬¢è¿é˜…è¯»<span style="color:#0099cc;">ã€Œ ' + document.title.split(' - ')[0] + ' ã€</span>';
				}
			}
			showMessage(text, 12000);
		})();

		liveTlakTimer = setInterval(function () {
			showHitokoto();
		}, 15000);

		function showHitokoto() {
			if (sessionStorage.getItem("Sleepy") !== "1") {
				if (!AITalkFlag) {
					$.getJSON('https://v1.hitokoto.cn/', function (result) {
						talkValTimer();
						showMessage(result.hitokoto, 0);
					});
				}
			} else {
				hideMessage(0);
				if (sleepTimer_ == null) {
					sleepTimer_ = setInterval(function () {
						checkSleep();
					}, 200);
				}
			}
		}

		function checkSleep() {
			var sleepStatu = sessionStorage.getItem("Sleepy");
			if (sleepStatu !== '1') {
				talkValTimer();
				showMessage('ä½ å›æ¥å•¦~', 0);
				clearInterval(sleepTimer_);
				sleepTimer_ = null;
			}
		}

		function showMessage(text, timeout) {
			if (Array.isArray(text)) text = text[Math.floor(Math.random() * text.length + 1) - 1];
			$('.message').stop();
			$('.message').html(text);
			$('.message').fadeTo(200, 1);
			//if (timeout === null) timeout = 5000;
			//hideMessage(timeout);
		}
		function talkValTimer() {
			$('#live_talk').val('1');
		}

		function hideMessage(timeout) {
			//$('.message').stop().css('opacity',1);
			if (timeout === null) timeout = 5000;
			$('.message').delay(timeout).fadeTo(200, 0);
		}

		function initLive2d() {
			$('#hideButton').on('click', function () {
				if (AIFadeFlag) {
					return false;
				} else {
					AIFadeFlag = true;
					localStorage.setItem("live2dhidden", "0");
					$('#landlord').fadeOut(200);
					$('#open_live2d').delay(200).fadeIn(200);
					setTimeout(function () {
						AIFadeFlag = false;
					}, 300);
				}
			});
			$('#open_live2d').on('click', function () {
				if (AIFadeFlag) {
					return false;
				} else {
					AIFadeFlag = true;
					localStorage.setItem("live2dhidden", "1");
					$('#open_live2d').fadeOut(200);
					$('#landlord').delay(200).fadeIn(200);
					setTimeout(function () {
						AIFadeFlag = false;
					}, 300);
				}
			});
			$('#youduButton').on('click', function () {
				if ($('#youduButton').hasClass('doudong')) {
					var typeIs = $('#youduButton').attr('data-type');
					$('#youduButton').removeClass('doudong');
					$('body').removeClass(typeIs);
					$('#youduButton').attr('data-type', '');
				} else {
					var duType = $('#duType').val();
					var duArr = duType.split(",");
					var dataType = duArr[Math.floor(Math.random() * duArr.length)];

					$('#youduButton').addClass('doudong');
					$('#youduButton').attr('data-type', dataType);
					$('body').addClass(dataType);
				}
			});
			if (apiKey) {
				$('#showInfoBtn').on('click', function () {
					var live_statu = $('#live_statu_val').val();
					if (live_statu == "0") {
						return
					} else {
						$('#live_statu_val').val("0");
						$('.live_talk_input_body').fadeOut(500);
						AITalkFlag = false;
						showHitokoto();
						$('#showTalkBtn').show();
						$('#showInfoBtn').hide();
					}
				});
				$('#showTalkBtn').on('click', function () {
					var live_statu = $('#live_statu_val').val();
					if (live_statu == "1") {
						return
					} else {
						$('#live_statu_val').val("1");
						$('.live_talk_input_body').fadeIn(500);
						AITalkFlag = true;
						$('#showTalkBtn').hide();
						$('#showInfoBtn').show();

					}
				});
				$('#talk_send').on('click', function () {
					var info_ = $('#AIuserText').val();
					var userid_ = $('#AIuserName').val();
					if (info_ == "") {
						showMessage('å†™ç‚¹ä»€ä¹ˆå§ï¼', 0);
						return;
					}
					if (userid_ == "") {
						showMessage('èŠä¹‹å‰è¯·å‘Šè¯‰æˆ‘ä½ çš„åå­—å§ï¼', 0);
						return;
					}
					showMessage('æ€è€ƒä¸­~', 0);
					let protocol = window.location.protocol.indexOf("s") > 0 ? "https" : "http";
					$.ajax({
						type: "get",
						url: `${protocol}://www.tuling123.com/openapi/api?key=${apiKey}&info=${info_}`,
						dataType: "json",
						success: function (res) {
							talkValTimer();
							showMessage(res.text, 0);
							$('#AIuserText').val("");
							sessionStorage.setItem("live2duser", userid_);
						},
						error: function (e) {
							talkValTimer();
							showMessage('ä¼¼ä¹æœ‰ä»€ä¹ˆé”™è¯¯ï¼Œè¯·å’Œç«™é•¿è”ç³»ï¼', 0);
						}
					});
				});
			} else {
				$('#showInfoBtn').hide();
				$('#showTalkBtn').hide();
			}
			//è·å–éŸ³ä¹ä¿¡æ¯åˆå§‹åŒ–
			var bgmListInfo = $('input[name=live2dBGM]');
			if (bgmListInfo.length == 0) {
				$('#musicButton').hide();
			} else {
				var bgmPlayNow = parseInt($('#live2d_bgm').attr('data-bgm'));
				var bgmPlayTime = 0;
				var live2dBGM_Num = sessionStorage.getItem("live2dBGM_Num");
				var live2dBGM_PlayTime = sessionStorage.getItem("live2dBGM_PlayTime");
				if (live2dBGM_Num) {
					if (live2dBGM_Num <= $('input[name=live2dBGM]').length - 1) {
						bgmPlayNow = parseInt(live2dBGM_Num);
					}
				}
				if (live2dBGM_PlayTime) {
					bgmPlayTime = parseInt(live2dBGM_PlayTime);
				}
				var live2dBGMSrc = bgmListInfo.eq(bgmPlayNow).val();
				$('#live2d_bgm').attr('data-bgm', bgmPlayNow);
				$('#live2d_bgm').attr('src', live2dBGMSrc);
				$('#live2d_bgm')[0].currentTime = bgmPlayTime;
				$('#live2d_bgm')[0].volume = 0.5;
				var live2dBGM_IsPlay = sessionStorage.getItem("live2dBGM_IsPlay");
				var live2dBGM_WindowClose = sessionStorage.getItem("live2dBGM_WindowClose");
				if (live2dBGM_IsPlay == '0' && live2dBGM_WindowClose == '0') {
					$('#live2d_bgm')[0].play();
					$('#musicButton').addClass('play');
				}
				sessionStorage.setItem("live2dBGM_WindowClose", '1');
				$('#musicButton').on('click', function () {
					if ($('#musicButton').hasClass('play')) {
						$('#live2d_bgm')[0].pause();
						$('#musicButton').removeClass('play');
						sessionStorage.setItem("live2dBGM_IsPlay", '1');
					} else {
						$('#live2d_bgm')[0].play();
						$('#musicButton').addClass('play');
						sessionStorage.setItem("live2dBGM_IsPlay", '0');
					}
				});
				window.onbeforeunload = function () {
					sessionStorage.setItem("live2dBGM_WindowClose", '0');
					if ($('#musicButton').hasClass('play')) {
						sessionStorage.setItem("live2dBGM_IsPlay", '0');
					}
				}
				document.getElementById('live2d_bgm').addEventListener("timeupdate", function () {
					var live2dBgmPlayTimeNow = document.getElementById('live2d_bgm').currentTime;
					sessionStorage.setItem("live2dBGM_PlayTime", live2dBgmPlayTimeNow);
				});
				document.getElementById('live2d_bgm').addEventListener("ended", function () {
					var listNow = parseInt($('#live2d_bgm').attr('data-bgm'));
					listNow++;
					if (listNow > $('input[name=live2dBGM]').length - 1) {
						listNow = 0;
					}
					var listNewSrc = $('input[name=live2dBGM]').eq(listNow).val();
					sessionStorage.setItem("live2dBGM_Num", listNow);
					$('#live2d_bgm').attr('src', listNewSrc);
					$('#live2d_bgm')[0].play();
					$('#live2d_bgm').attr('data-bgm', listNow);
				});
				document.getElementById('live2d_bgm').addEventListener("error", function () {
					$('#live2d_bgm')[0].pause();
					$('#musicButton').removeClass('play');
					showMessage('éŸ³ä¹ä¼¼ä¹åŠ è½½ä¸å‡ºæ¥äº†å‘¢ï¼', 0);
				});
			}
			//è·å–ç”¨æˆ·å
			var live2dUser = sessionStorage.getItem("live2duser");
			if (live2dUser !== null) {
				$('#AIuserName').val(live2dUser);
			}
			//è·å–ä½ç½®
			var landL = sessionStorage.getItem("historywidth");
			var landB = sessionStorage.getItem("historyheight");
			if (landL == null || landB == null) {
				landL = '5px'
				landB = '0px'
			}
			$('#landlord').css('left', landL + 'px');
			$('#landlord').css('bottom', landB + 'px');
			//ç§»åŠ¨
			function getEvent() {
				return window.event || arguments.callee.caller.arguments[0];
			}
			var smcc = document.getElementById("landlord");
			var moveX = 0;
			var moveY = 0;
			var moveBottom = 0;
			var moveLeft = 0;
			var moveable = false;
			var docMouseMoveEvent = document.onmousemove;
			var docMouseUpEvent = document.onmouseup;
			smcc.onmousedown = function () {
				var ent = getEvent();
				moveable = true;
				moveX = ent.clientX;
				moveY = ent.clientY;
				var obj = smcc;
				moveBottom = parseInt(obj.style.bottom);
				moveLeft = parseInt(obj.style.left);
				if (isFirefox = navigator.userAgent.indexOf("Firefox") > 0) {
					window.getSelection().removeAllRanges();
				}
				document.onmousemove = function () {
					if (moveable) {
						var ent = getEvent();
						var x = moveLeft + ent.clientX - moveX;
						var y = moveBottom + (moveY - ent.clientY);
						obj.style.left = x + "px";
						obj.style.bottom = y + "px";
					}
				};
				document.onmouseup = function () {
					if (moveable) {
						var historywidth = obj.style.left;
						var historyheight = obj.style.bottom;
						historywidth = historywidth.replace('px', '');
						historyheight = historyheight.replace('px', '');
						sessionStorage.setItem("historywidth", historywidth);
						sessionStorage.setItem("historyheight", historyheight);
						document.onmousemove = docMouseMoveEvent;
						document.onmouseup = docMouseUpEvent;
						moveable = false;
						moveX = 0;
						moveY = 0;
						moveBottom = 0;
						moveLeft = 0;
					}
				};
			};
		}
		$(document).ready(function () {
			var AIimgSrc = [];
			let chooseLive2d = 'hijiki'
			if (chooseLive2d === 'histoire') {
				AIimgSrc.push(message_Path + "model/histoire/histoire.1024/texture_00.png");
				AIimgSrc.push(message_Path + "model/histoire/histoire.1024/texture_01.png");
				AIimgSrc.push(message_Path + "model/histoire/histoire.1024/texture_02.png");
				AIimgSrc.push(message_Path + "model/histoire/histoire.1024/texture_03.png");
			} else if (chooseLive2d === 'rem') {
				AIimgSrc.push(message_Path + "model/rem/remu2048/texture_00.png");
			} else if (chooseLive2d === 'Aoba') {
				AIimgSrc.push(message_Path + "model/Aoba/textures/texture_00.png");
			} else if (chooseLive2d === 'hijiki') {
				AIimgSrc.push(message_Path + "model/hijiki/moc/hijiki.2048/texture_00.png");
			} else if (chooseLive2d === 'tororo') {
				AIimgSrc.push(message_Path + "model/tororo/moc/tororo.2048/texture_00.png");
			}
			var images = [];
			var imgLength = AIimgSrc.length;
			var loadingNum = 0;
			for (var i = 0; i < imgLength; i++) {
				images[i] = new Image();
				images[i].src = AIimgSrc[i];
				images[i].onload = function () {
					loadingNum++;
					if (loadingNum === imgLength) {
						var live2dhidden = localStorage.getItem("live2dhidden");
						if (live2dhidden === "0") {
							setTimeout(function () {
								$('#open_live2d').fadeIn(200);
							}, 1300);
						} else {
							setTimeout(function () {
								$('#landlord').fadeIn(200);
							}, 1300);
						}
						let model = '';
						if (chooseLive2d === 'histoire') {
							model = message_Path + "model/histoire/model.json";
						} else if (chooseLive2d === 'rem') {
							model = message_Path + "model/rem/model.json";
						} else if (chooseLive2d === 'Aoba') {
							model = message_Path + "model/Aoba/model.json";
						} else if (chooseLive2d === 'hijiki') {
							model = message_Path + "model/hijiki/hijiki.model.json";
						} else if (chooseLive2d === 'tororo') {
							model = message_Path + "model/tororo/tororo.model.json";
						}
						setTimeout(function () {
							loadlive2d("live2d", model);
						}, 1000);
						initLive2d();
						images = null;
					}
				}
			}
		});
	}
</script>
  
  
</div>
<script>

  let sideBarOpen = 'sidebar-open';
  let body = document.body;
  let back2Top = document.querySelector('#back_to_top'),
  back2TopText = document.querySelector('#back_to_top_text'),
  drawerBox = document.querySelector('#drawer_box'),
  rightSideBar = document.querySelector('.sidebar'),
  viewport = document.querySelector('body');

  function scrollAnimation(currentY, targetY) {
   
    let needScrollTop = targetY - currentY
    let _currentY = currentY
    setTimeout(() => {
      const dist = Math.ceil(needScrollTop / 10)
      _currentY += dist
      window.scrollTo(_currentY, currentY)
      if (needScrollTop > 10 || needScrollTop < -10) {
        scrollAnimation(_currentY, targetY)
      } else {
        window.scrollTo(_currentY, targetY)
      }
    }, 1)
  }

  back2Top.addEventListener("click", function(e) {
    scrollAnimation(document.scrollingElement.scrollTop, 0);
    e.stopPropagation();
    return false;
  });
  
  window.addEventListener('scroll', function(e) {
    let percent = document.scrollingElement.scrollTop / (document.scrollingElement.scrollHeight - document.scrollingElement.clientHeight) * 100;
    if (percent > 1 && !back2Top.classList.contains('back-top-active')) {
      back2Top.classList.add('back-top-active');
    }
    if (percent == 0) {
      back2Top.classList.remove('back-top-active');
    }
    if (back2TopText) {
      back2TopText.textContent = Math.floor(percent);
    }
  });

  
  let hasCacu = false;
  window.onresize = function() {
    if (window.width > 991) {
      calcuHeight();
    } else {
      hasCacu = false;
    }
  }

  function calcuHeight() {
    // åŠ¨æ€è°ƒæ•´ç«™ç‚¹æ¦‚è§ˆé«˜åº¦
    if (!hasCacu && back2Top.classList.contains('pisces') || back2Top.classList.contains('gemini')) {
      let sideBar = document.querySelector('.sidebar');
      let navUl = document.querySelector('#site_nav');
      sideBar.style = 'margin-top:' + (navUl.offsetHeight + navUl.offsetTop + 15) + 'px;';
      hasCacu = true;
    }
  }
  calcuHeight();
  
  let open = false, MOTION_TIME = 300, RIGHT_MOVE_DIS = '320px';

  if (drawerBox) {
    let rightMotions = document.querySelectorAll('.right-motion');
    let right = drawerBox.classList.contains('right');

    let transitionDir = right ? "transition.slideRightIn" : "transition.slideLeftIn";

    let openProp, closeProp;
    if (right) {
      openProp = {
        paddingRight: RIGHT_MOVE_DIS 
      };
      closeProp = {
        paddingRight: '0px'
      };
    } else {
      openProp = {
        paddingLeft: RIGHT_MOVE_DIS 
      };
      closeProp = {
        paddingLeft: '0px'
      };
    }

    drawerBox.onclick = function() {
      open = !open;
      window.Velocity(rightSideBar, 'stop');
      window.Velocity(viewport, 'stop');
      window.Velocity(rightMotions, 'stop');
      if (open) {
        window.Velocity(rightSideBar, {
          width: RIGHT_MOVE_DIS
        }, {
          duration: MOTION_TIME,
          begin: function() {
            window.Velocity(rightMotions, transitionDir,{ });
          }
        })
        window.Velocity(viewport, openProp,{
          duration: MOTION_TIME
        });
      } else {
        window.Velocity(rightSideBar, {
          width: '0px'
        }, {
          duration: MOTION_TIME,
          begin: function() {
            window.Velocity(rightMotions, {
              opacity: 0
            });
          }
        })
        window.Velocity(viewport, closeProp ,{
          duration: MOTION_TIME
        });
      }
      for (let i = 0; i < drawerBox.children.length; i++) {
        drawerBox.children[i].classList.toggle('muse-line');
      }
      drawerBox.classList.toggle(sideBarOpen);
    }
  }

  // é“¾æ¥è·³è½¬
  let newWindow = 'false'
  if (newWindow === 'true') {
    let links = document.querySelectorAll('.post-body a')
    links.forEach(item => {
      if (!item.classList.contains('btn')) {
        item.setAttribute("target","_blank");
      }
    })
  }
  // ä»£ç é«˜äº®
  hljs.initHighlightingOnLoad();

</script>
  </div>
</body>
<input hidden id="copy" />
<script>
  //æ‹¿æ¥ä¸»ä¹‰(çœŸé¦™)^_^ï¼ŒClipboard å®ç°æ‘˜è‡ªæ˜é‡‘ https://juejin.im/post/5aefeb6e6fb9a07aa43c20af
  window.Clipboard = (function (window, document, navigator) {
    var textArea,
      copy;

    // åˆ¤æ–­æ˜¯ä¸æ˜¯iosç«¯
    function isOS() {
      return navigator.userAgent.match(/ipad|iphone/i);
    }
    //åˆ›å»ºæ–‡æœ¬å…ƒç´ 
    function createTextArea(text) {
      textArea = document.createElement('textArea');
      textArea.value = text;
      textArea.style.width = 0;
      textArea.style.height = 0;
      textArea.clientHeight = 0;
      textArea.clientWidth = 0;
      document.body.appendChild(textArea);
    }
    //é€‰æ‹©å†…å®¹
    function selectText() {
      var range,
        selection;

      if (isOS()) {
        range = document.createRange();
        range.selectNodeContents(textArea);
        selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
        textArea.setSelectionRange(0, 999999);
      } else {
        textArea.select();
      }
    }

    //å¤åˆ¶åˆ°å‰ªè´´æ¿
    function copyToClipboard() {
      try {
        document.execCommand("Copy")
      } catch (err) {
        alert("å¤åˆ¶é”™è¯¯ï¼è¯·æ‰‹åŠ¨å¤åˆ¶ï¼")
      }
      document.body.removeChild(textArea);
    }

    copy = function (text) {
      createTextArea(text);
      selectText();
      copyToClipboard();
    };

    return {
      copy: copy
    };
  })(window, document, navigator);

  function copyCode(e) {
    if (e.srcElement.tagName === 'SPAN' && e.srcElement.classList.contains('copy-code')) {
      let code = e.currentTarget.querySelector('code');
      var text = code.innerText;
      if (e.srcElement.textContent === 'å¤åˆ¶æˆåŠŸ') {
        console.log('å¤åˆ¶æ“ä½œé¢‘ç‡è¿‡é«˜');
        return;
      }
      e.srcElement.textContent = 'å¤åˆ¶æˆåŠŸ';
      (function (elem) {
        setTimeout(() => {
          if (elem.textContent === 'å¤åˆ¶æˆåŠŸ') {
            elem.textContent = 'å¤åˆ¶ä»£ç '
          }
        }, 1000);
      })(e.srcElement)
      Clipboard.copy(text);
    }
  }

  let pres = document.querySelectorAll('pre');
  pres.forEach(pre => {
    let code = pre.querySelector('code');
    let copyElem = document.createElement('span');
    copyElem.classList.add('copy-code');
    copyElem.textContent = 'å¤åˆ¶ä»£ç ';
    pre.appendChild(copyElem);
    pre.onclick = copyCode
  })
</script>
<script src="/media/js/motion.js"></script>

<script src="https://cdn.jsdelivr.net/gh/cferdinandi/smooth-scroll/dist/smooth-scroll.polyfills.min.js"></script>
<script>
  var scroll = new SmoothScroll('a[href*="#"]', {
    speed: 500
  });
</script>

<!-- <div class="search-mask" id="search_mask">
  <div class="search-box">
    <div class="search-title">
      <i class="fa fa-search"></i>
      <div class="input-box">
        <input type="text" placeholder="æœç´¢">
      </div>
      <i class="fa fa-times-circle"></i>
    </div>
    <div class="result">
      
      <div class="item">
        <a class="result-title" href="http://lvelvis.github.io/post/golang-bi-ji-zip-ri-zhi-shi-yong/"" data-c="
          &lt;p&gt;åœ¨beegoä¸­ä½¿ç”¨zapç®¡ç†æ—¥å¿—ï¼Œå¾ˆæ–¹ä¾¿ğŸ‘&lt;br&gt;
éœ€è¦åœ¨conf/app.confå®šä¹‰å‡ ä¸ªå‚æ•°&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;appname = web-terminal
httpport = &amp;quot;9600&amp;quot;

runmode = &amp;quot;prod&amp;quot;
LogLevel = &amp;quot;info&amp;quot;
autorender = true
recoverpanic = false
copyrequestbody = true
viewspath = &amp;quot;static&amp;quot;
LogPath = &amp;quot;logs/k8s-websocket.log&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;logger.go&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;package controllers

import (
	&amp;quot;os&amp;quot;

	&amp;quot;github.com/astaxie/beego&amp;quot;
	&amp;quot;github.com/natefinch/lumberjack&amp;quot;
	&amp;quot;go.uber.org/zap&amp;quot;
	&amp;quot;go.uber.org/zap/zapcore&amp;quot;
)

//MyLoggeråˆå§‹åŒ–zaploggeræ—¥å¿—åº“
var MyLogger *zap.Logger

func initLogger(logpath string, loglevel string) *zap.Logger {

	// è®¾ç½®æ—¥å¿—çº§åˆ«
	var level zapcore.Level
	switch loglevel {
	case &amp;quot;debug&amp;quot;:
		level = zap.DebugLevel
	case &amp;quot;info&amp;quot;:
		level = zap.InfoLevel
	case &amp;quot;error&amp;quot;:
		level = zap.ErrorLevel
	default:
		level = zap.InfoLevel
	}

	hook := lumberjack.Logger{
		Filename:   logpath, // æ—¥å¿—æ–‡ä»¶è·¯å¾„
		MaxSize:    20,      // æ¯ä¸ªæ—¥å¿—æ–‡ä»¶ä¿å­˜çš„æœ€å¤§å°ºå¯¸ å•ä½ï¼šM
		MaxBackups: 10,      // æ—¥å¿—æ–‡ä»¶æœ€å¤šä¿å­˜å¤šå°‘ä¸ªå¤‡ä»½
		MaxAge:     7,       // æ–‡ä»¶æœ€å¤šä¿å­˜å¤šå°‘å¤©
		Compress:   true,    // æ˜¯å¦å‹ç¼©
	}

	encoderConfig := zapcore.EncoderConfig{
		TimeKey:        &amp;quot;time&amp;quot;,
		LevelKey:       &amp;quot;level&amp;quot;,
		NameKey:        &amp;quot;logger&amp;quot;,
		CallerKey:      &amp;quot;linenum&amp;quot;,
		MessageKey:     &amp;quot;msg&amp;quot;,
		StacktraceKey:  &amp;quot;stacktrace&amp;quot;,
		LineEnding:     zapcore.DefaultLineEnding,
		EncodeLevel:    zapcore.LowercaseLevelEncoder,  // å°å†™ç¼–ç å™¨
		EncodeTime:     zapcore.ISO8601TimeEncoder,     // ISO8601 UTC æ—¶é—´æ ¼å¼
		EncodeDuration: zapcore.SecondsDurationEncoder, //
		EncodeCaller:   zapcore.ShortCallerEncoder,     // çŸ­è·¯å¾„ç¼–ç å™¨
		EncodeName:     zapcore.FullNameEncoder,
	}

	core := zapcore.NewCore(
		zapcore.NewJSONEncoder(encoderConfig),                                           // ç¼–ç å™¨é…ç½®
		zapcore.NewMultiWriteSyncer(zapcore.AddSync(os.Stdout), zapcore.AddSync(&amp;amp;hook)), // æ‰“å°åˆ°æ§åˆ¶å°å’Œæ–‡ä»¶
		level, // æ—¥å¿—çº§åˆ«
	)

	// å¼€å¯å¼€å‘æ¨¡å¼ï¼Œå †æ ˆè·Ÿè¸ª
	caller := zap.AddCaller()
	// å¼€å¯æ–‡ä»¶åŠè¡Œå·
	development := zap.Development()

	// è®¾ç½®åˆå§‹åŒ–å­—æ®µ
	filed := zap.Fields(zap.String(&amp;quot;serviceName&amp;quot;, &amp;quot;k8s-websocket-dashboard&amp;quot;))
	// æ„é€ æ—¥å¿—
	logger := zap.New(core, caller, development, filed)

	logger.Info(&amp;quot;initlog åˆå§‹åŒ–æˆåŠŸ&amp;quot;)
	return logger
}

// åˆå§‹åŒ–æ—¥å¿—
func init() {
	logPath := beego.AppConfig.String(&amp;quot;LogPath&amp;quot;)
	loglevel := beego.AppConfig.String(&amp;quot;LogLevel&amp;quot;)
	MyLogger = initLogger(logPath, loglevel)
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ—¥å¿—è¾“å‡ºï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{&amp;quot;level&amp;quot;:&amp;quot;info&amp;quot;,&amp;quot;time&amp;quot;:&amp;quot;2020-06-02T19:41:37.799+0800&amp;quot;,&amp;quot;linenum&amp;quot;:&amp;quot;controllers/logger.go:59&amp;quot;,&amp;quot;msg&amp;quot;:&amp;quot;log åˆå§‹åŒ–æˆåŠŸ&amp;quot;,&amp;quot;serviceName&amp;quot;:&amp;quot;k8s-websocket-dashboard&amp;quot;}
&lt;/code&gt;&lt;/pre&gt;
">golangç¬”è®°-zipæ—¥å¿—ä½¿ç”¨</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="http://lvelvis.github.io/post/golang-bi-ji-beego-huo-qu-url-qing-qiu-de-can-shu/"" data-c="
          &lt;h1 id=&#34;è·å–å‚æ•°&#34;&gt;è·å–å‚æ•°&lt;/h1&gt;
&lt;p&gt;æˆ‘ä»¬ç»å¸¸éœ€è¦è·å–ç”¨æˆ·ä¼ é€’çš„æ•°æ®ï¼ŒåŒ…æ‹¬Getã€POSTç­‰æ–¹å¼çš„è¯·æ±‚ï¼Œbeegoé‡Œé¢ä¼šè‡ªåŠ¨è§£æè¿™äº›æ•°æ®ï¼Œä½ å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è·å–æ•°æ®ï¼š&lt;/p&gt;
&lt;p&gt;GetString(key string) string&lt;br&gt;
GetStrings(key string) []string&lt;br&gt;
GetInt(key string) (int64, error)&lt;br&gt;
GetBool(key string) (bool, error)&lt;br&gt;
GetFloat(key string) (float64, error)&lt;br&gt;
ç¤ºä¾‹1ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;func (this *MainController) Post() {
    jsoninfo := &amp;lt;strong&amp;gt;this.GetString&amp;lt;/strong&amp;gt;(&amp;quot;jsoninfo&amp;quot;)
    if jsoninfo == &amp;quot;&amp;quot; {
        this.Ctx.WriteString(&amp;quot;jsoninfo is empty&amp;quot;)
        return
    }
}```
å¦‚æœä½ éœ€è¦çš„æ•°æ®å¯èƒ½æ˜¯å…¶å®ƒç±»å‹ï¼Œä¾‹å¦‚æ˜¯intç±»å‹è€Œä¸æ˜¯int64ï¼Œé‚£ä¹ˆä½ éœ€è¦è¿™æ ·å¤„ç†ï¼š

ç¤ºä¾‹2ï¼š
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;func (this *MainController) Post() {&lt;br&gt;
id := &lt;strong&gt;this.Input().Get&lt;/strong&gt;(&amp;quot;id&amp;quot;)&lt;br&gt;
intid, err := &lt;strong&gt;strconv.Atoi&lt;/strong&gt;(id)&lt;br&gt;
}```&lt;br&gt;
æ›´å¤šå…¶ä»–çš„requestçš„ä¿¡æ¯ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡this.Ctx.Requestè·å–ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;å…³äºè¯¥å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•å¯å‚è€ƒrequestå®˜æ–¹æ‰‹å†Œhttps://gowalker.org/net/http#Request&lt;/p&gt;
&lt;h1 id=&#34;ç›´æ¥è§£æåˆ°struct&#34;&gt;ç›´æ¥è§£æåˆ°struct&lt;/h1&gt;
&lt;p&gt;å¦‚æœè¦æŠŠè¡¨å•é‡Œçš„å†…å®¹èµ‹å€¼åˆ°ä¸€ä¸ªstructé‡Œï¼Œé™¤äº†ç”¨ä¸Šé¢çš„æ–¹æ³•ä¸€ä¸ªä¸€ä¸ªè·å–å†èµ‹å€¼ä¹‹å¤–ï¼Œ&lt;br&gt;
beegoæä¾›äº†é€šè¿‡å¦å¤–ä¸€ä¸ªæ›´ä¾¿æ·çš„æ–¹å¼ï¼Œå°±æ˜¯é€šè¿‡structçš„å­—æ®µåæˆ–tagä¸è¡¨å•å­—æ®µå¯¹åº”ç›´æ¥è§£æåˆ°structã€‚&lt;/p&gt;
&lt;p&gt;ç¤ºä¾‹3ï¼š&lt;/p&gt;
&lt;p&gt;å®šä¹‰struct&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;type user struct {
    Id    int         `form:&amp;quot;-&amp;quot;`
    Name  interface{} `form:&amp;quot;&amp;lt;strong&amp;gt;username&amp;lt;/strong&amp;gt;&amp;quot;`
    Age   int         `form:&amp;quot;&amp;lt;strong&amp;gt;age&amp;lt;/strong&amp;gt;&amp;quot;`
    Email string
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¡¨å•&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;form id=&amp;quot;&amp;lt;strong&amp;gt;user&amp;lt;/strong&amp;gt;&amp;quot;&amp;gt;
    åå­—ï¼š&amp;lt;input name=&amp;quot;&amp;lt;strong&amp;gt;username&amp;lt;/strong&amp;gt;&amp;quot; type=&amp;quot;text&amp;quot; /&amp;gt;
    å¹´é¾„ï¼š&amp;lt;input name=&amp;quot;&amp;lt;strong&amp;gt;age&amp;lt;/strong&amp;gt;&amp;quot; type=&amp;quot;text&amp;quot; /&amp;gt;
    é‚®ç®±ï¼š&amp;lt;input name=&amp;quot;Email&amp;quot; type=&amp;quot;text&amp;quot; /&amp;gt;
    &amp;lt;input type=&amp;quot;submit&amp;quot; value=&amp;quot;æäº¤&amp;quot; /&amp;gt;
&amp;lt;/form&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;controlleré‡Œè§£æ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;func (this *MainController) Post() {
    u := &amp;lt;strong&amp;gt;user{}&amp;lt;/strong&amp;gt;
    if err := this.ParseForm(&amp;lt;strong&amp;gt;&amp;amp;u&amp;lt;/strong&amp;gt;); err != nil {
        //handle error
    }
}ã€€ã€€
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;éœ€è¦è¯´æ˜çš„æ˜¯ï¼š&lt;/p&gt;
&lt;p&gt;ï¼ˆ1ï¼‰structTag formçš„å®šä¹‰å’Œrenderformæ–¹æ³•å…±ç”¨ä¸€ä¸ªæ ‡ç­¾ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆ2ï¼‰å®šä¹‰structæ—¶ï¼Œå­—æ®µååå¦‚æœæœ‰formè¿™ä¸ªtagï¼Œåˆ™ä¼šæŠŠformè¡¨å•é‡Œçš„nameå’Œtagçš„åå­—ä¸€æ ·çš„å­—æ®µèµ‹å€¼ç»™è¿™ä¸ªå­—æ®µï¼Œ&lt;/p&gt;
&lt;p&gt;å¦åˆ™å°±ä¼šæŠŠformè¡¨å•é‡Œä¸å­—æ®µåä¸€æ ·çš„è¡¨å•å†…å®¹èµ‹å€¼ç»™è¿™ä¸ªå­—æ®µã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œä¼šæŠŠè¡¨å•ä¸­çš„usernameå’Œageåˆ†åˆ«èµ‹å€¼ç»™useré‡Œçš„Nameå’ŒAgeå­—æ®µï¼Œè€ŒEmailé‡Œçš„å†…å®¹åˆ™ä¼šèµ‹å€¼ç»™Emailè¿™ä¸ªå­—æ®µã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆ3ï¼‰è°ƒç”¨Controller PraseFormè¿™ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œä¼ å…¥çš„å‚æ•°å¿…é¡»ä¸ºä¸€ä¸ªstructçš„æŒ‡é’ˆï¼Œå¦åˆ™å¯¹structçš„èµ‹å€¼ä¸ä¼šæˆåŠŸå¹¶è¿”å›xx must be a struct pointerçš„é”™è¯¯ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆ4ï¼‰å¦‚æœè¦å¿½ç•¥ä¸€ä¸ªå­—æ®µï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€æ˜¯ï¼šå­—æ®µåå°å†™å¼€å¤´ï¼ŒäºŒæ˜¯ï¼šformæ ‡ç­¾è®¾ç½®ä¸º_&lt;/p&gt;
&lt;h1 id=&#34;è·å–request-bodyé‡Œçš„å†…å®¹&#34;&gt;è·å–Request Bodyé‡Œçš„å†…å®¹&lt;/h1&gt;
&lt;p&gt;åœ¨APIçš„å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šç”¨åˆ°JSONæˆ–XMLæ¥ä½œä¸ºæ•°æ®äº¤äº’çš„æ ¼å¼ï¼Œå¦‚ä½•åœ¨beegoä¸­è·å–Request Bodyé‡Œçš„JSONæˆ–XMLçš„æ•°æ®å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œåœ¨é…ç½®æ–‡ä»¶é‡Œè®¾ç½®copyrequestbody = true&lt;/p&gt;
&lt;p&gt;å…¶æ¬¡ï¼Œåœ¨Controllerä¸­ï¼š&lt;/p&gt;
&lt;p&gt;ç¤ºä¾‹4ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;func (this *ObjectController) Post() {
    var ob models.Object
    var err error
    if err = json.Unmarshal(this.Ctx.Input.RequestBody, &amp;amp;ob); err == nil {
        objectid := models.AddOne(ob)
        this.Data[&amp;quot;json&amp;quot;] = &amp;quot;{\&amp;quot;ObjectId\&amp;quot;:\&amp;quot;&amp;quot; + objectid + &amp;quot;\&amp;quot;}&amp;quot;
    } else {
        this.Data[&amp;quot;json&amp;quot;] = err.Error()
    }
    this.ServeJSON()
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/p&gt;
&lt;h1 id=&#34;æ–‡ä»¶ä¸Šä¼ &#34;&gt;æ–‡ä»¶ä¸Šä¼ &lt;/h1&gt;
&lt;p&gt;åœ¨beegoä¸­ä½ å¯ä»¥å¾ˆå®¹æ˜“çš„å¤„ç†æ–‡ä»¶ä¸Šä¼ ï¼Œå°±æ˜¯åˆ«å¿˜è®°åœ¨ä½ çš„formè¡¨å•ä¸­å¢åŠ â€œenctype=&amp;quot;multipart/form-dataâ€ï¼Œå¦åˆ™ä½ çš„æµè§ˆå™¨ä¸ä¼šä¼ è¾“ä½ çš„ä¸Šä¼ æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;æ–‡ä»¶ä¸Šä¼ ä¹‹åä¸€èˆ¬æ˜¯æ”¾åœ¨ç³»ç»Ÿçš„å†…å­˜é‡Œé¢ï¼Œå¦‚æœæ–‡ä»¶çš„sizeå¤§äºè®¾ç½®çš„ç¼“å­˜å¤§å°ï¼Œé‚£ä¹ˆå°±æ”¾åœ¨ä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œ&lt;/p&gt;
&lt;p&gt;é»˜è®¤çš„ç¼“å­˜å†…å­˜æ˜¯64Mï¼Œä½ å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼æ¥è°ƒæ•´è¿™ä¸ªç¼“å­˜å†…å­˜çš„å¤§å°ã€‚&lt;/p&gt;
&lt;p&gt;beego.MaxMemory = 1&amp;lt;&amp;lt;22&lt;br&gt;
æˆ–è€…åœ¨é…ç½®æ–‡ä»¶ä¸­é€šè¿‡å¦‚ä¸‹è®¾ç½®ï¼š&lt;/p&gt;
&lt;p&gt;maxmemory = 1&amp;lt;&amp;lt;22&lt;br&gt;
Beegoæä¾›äº†ä¸¤ä¸ªå¾ˆæ–¹ä¾¿çš„æ–¹æ³•æ¥å¤„ç†æ–‡ä»¶ä¸Šä¼ ï¼š&lt;/p&gt;
&lt;p&gt;ï¼ˆ1ï¼‰GetFile(key string) (multipart.File, *multipart.FileHeader, error)&lt;/p&gt;
&lt;p&gt;è¯¥æ–¹æ³•ä¸»è¦ç”¨äºç”¨æˆ·è¯»å–è¡¨å•ä¸­çš„æ–‡ä»¶åthe_fileï¼Œç„¶åè¿”å›ç›¸åº”çš„ä¿¡æ¯ï¼Œç”¨æˆ·æ ¹æ®è¿™äº›å˜é‡æ¥å¤„ç†æ–‡ä»¶ä¸Šä¼ ï¼šè¿‡æ»¤ã€ä¿å­˜æ–‡ä»¶ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆ2ï¼‰SaveToFile(fromfile, tofile string) error&lt;/p&gt;
&lt;p&gt;è¯¥æ–¹æ³•æ˜¯åœ¨GetFileçš„åŸºç¡€ä¸Šå®ç°äº†å¿«é€Ÿä¿å­˜çš„åŠŸèƒ½ï¼Œfromfileæ˜¯æäº¤çš„æ—¶å€™htmlè¡¨å•ä¸­çš„nameã€‚&lt;/p&gt;
&lt;p&gt;ç¤ºä¾‹5&lt;/p&gt;
&lt;p&gt;è¡¨å•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;form enctype=&amp;quot;multipart/form-data&amp;quot; method=&amp;quot;post&amp;quot;&amp;gt;
    &amp;lt;input type=&amp;quot;file&amp;quot; name=&amp;quot;uploadname&amp;quot; /&amp;gt;
    &amp;lt;input type=&amp;quot;submit&amp;quot;&amp;gt;
&amp;lt;/form&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Controllerä¸­ä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;func (c *FormController) Post() {
    f, h, err := c.GetFile(&amp;quot;uploadname&amp;quot;)
    if err != nil {
        log.Fatal(&amp;quot;getfile err &amp;quot;, err)
    }
    defer f.Close()
    c.SaveToFile(&amp;quot;uploadname&amp;quot;, &amp;quot;static/upload/&amp;quot; + h.Filename) // ä¿å­˜ä½ç½®åœ¨ static/upload, æ²¡æœ‰æ–‡ä»¶å¤¹è¦å…ˆåˆ›å»º
     
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;æ•°æ®ç»‘å®š&#34;&gt;æ•°æ®ç»‘å®š&lt;/h1&gt;
&lt;p&gt;æ”¯æŒä»ç”¨æˆ·è¯·æ±‚ä¸­ç›´æ¥æ•°æ®bindåˆ°æŒ‡å®šçš„å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;ç¤ºä¾‹6ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;var id int
this.Ctx.Input.Bind(&amp;amp;id, &amp;quot;id&amp;quot;)  //id ==123
 
var isok bool
this.Ctx.Input.Bind(&amp;amp;isok, &amp;quot;isok&amp;quot;)  //isok ==true
 
var ft float64
this.Ctx.Input.Bind(&amp;amp;ft, &amp;quot;ft&amp;quot;)  //ft ==1.2
 
ol := make([]int, 0, 2)
this.Ctx.Input.Bind(&amp;amp;ol, &amp;quot;ol&amp;quot;)  //ol ==[1 2]
 
ul := make([]string, 0, 2)
this.Ctx.Input.Bind(&amp;amp;ul, &amp;quot;ul&amp;quot;)  //ul ==[str array]
 
user struct{Name}
this.Ctx.Input.Bind(&amp;amp;user, &amp;quot;user&amp;quot;)  //user =={Name:&amp;quot;astaxie&amp;quot;}
&lt;/code&gt;&lt;/pre&gt;
">golangç¬”è®°-beegoè·å–urlè¯·æ±‚çš„å‚æ•°</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="http://lvelvis.github.io/post/golang-bi-ji-json-shu-ju-jie-xi-marshal-yu-unmarshal/"" data-c="
          &lt;h1 id=&#34;ç®€ä»‹&#34;&gt;ç®€ä»‹&lt;/h1&gt;
&lt;p&gt;Json(Javascript Object Nanotation)æ˜¯ä¸€ç§æ•°æ®äº¤æ¢æ ¼å¼ï¼Œå¸¸ç”¨äºå‰åç«¯æ•°æ®ä¼ è¾“ã€‚ä»»æ„ä¸€ç«¯å°†æ•°æ®è½¬æ¢æˆjson å­—ç¬¦ä¸²ï¼Œå¦ä¸€ç«¯å†å°†è¯¥å­—ç¬¦ä¸²è§£ææˆç›¸åº”çš„æ•°æ®ç»“æ„ï¼Œå¦‚stringç±»å‹ï¼Œstrcutå¯¹è±¡ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;goè¯­è¨€æœ¬èº«ä¸ºæˆ‘ä»¬æä¾›äº†jsonçš„å·¥å…·åŒ…â€encoding/jsonâ€ã€‚&lt;br&gt;
æ›´å¤šçš„ä½¿ç”¨æ–¹å¼ï¼Œå¯ä»¥å‚è€ƒï¼šhttps://studygolang.com/articles/6742&lt;/p&gt;
&lt;h1 id=&#34;å®ç°&#34;&gt;å®ç°&lt;/h1&gt;
&lt;p&gt;Json Marshalï¼šå°†æ•°æ®ç¼–ç æˆjsonå­—ç¬¦ä¸²&lt;br&gt;
çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;type Stu struct {
    Name  string `json:&amp;quot;name&amp;quot;`
    Age   int
    HIgh  bool
    sex   string
    Class *Class `json:&amp;quot;class&amp;quot;`
}

type Class struct {
    Name  string
    Grade int
}

func main() {
    //å®ä¾‹åŒ–ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œç”¨äºç”Ÿæˆjsonå­—ç¬¦ä¸²
    stu := Stu{
        Name: &amp;quot;å¼ ä¸‰&amp;quot;,
        Age:  18,
        HIgh: true,
        sex:  &amp;quot;ç”·&amp;quot;,
    }

    //æŒ‡é’ˆå˜é‡
    cla := new(Class)
    cla.Name = &amp;quot;1ç­&amp;quot;
    cla.Grade = 3
    stu.Class=cla

    //Marshalå¤±è´¥æ—¶err!=nil
    jsonStu, err := json.Marshal(stu)
    if err != nil {
        fmt.Println(&amp;quot;ç”Ÿæˆjsonå­—ç¬¦ä¸²é”™è¯¯&amp;quot;)
    }

    //jsonStuæ˜¯[]byteç±»å‹ï¼Œè½¬åŒ–æˆstringç±»å‹ä¾¿äºæŸ¥çœ‹
    fmt.Println(string(jsonStu))
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{&amp;quot;name&amp;quot;:&amp;quot;å¼ ä¸‰&amp;quot;,&amp;quot;Age&amp;quot;:18,&amp;quot;HIgh&amp;quot;:true,&amp;quot;class&amp;quot;:{&amp;quot;Name&amp;quot;:&amp;quot;1ç­&amp;quot;,&amp;quot;Grade&amp;quot;:3}}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»ç»“æœä¸­å¯ä»¥çœ‹å‡º&lt;/p&gt;
&lt;p&gt;åªè¦æ˜¯å¯å¯¼å‡ºæˆå‘˜ï¼ˆå˜é‡é¦–å­—æ¯å¤§å†™ï¼‰ï¼Œéƒ½å¯ä»¥è½¬æˆjsonã€‚å› æˆå‘˜å˜é‡sexæ˜¯ä¸å¯å¯¼å‡ºçš„ï¼Œæ•…æ— æ³•è½¬æˆjsonã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœå˜é‡æ‰“ä¸Šäº†jsonæ ‡ç­¾ï¼Œå¦‚Nameæ—è¾¹çš„ &lt;code&gt;json:&amp;quot;name&amp;quot;&lt;/code&gt; ï¼Œé‚£ä¹ˆè½¬åŒ–æˆçš„json keyå°±ç”¨è¯¥æ ‡ç­¾â€œnameâ€ï¼Œå¦åˆ™å–å˜é‡åä½œä¸ºkeyï¼Œå¦‚â€œAgeâ€ï¼Œâ€œHIghâ€ã€‚&lt;/p&gt;
&lt;p&gt;boolç±»å‹ä¹Ÿæ˜¯å¯ä»¥ç›´æ¥è½¬æ¢ä¸ºjsonçš„valueå€¼ã€‚Channelï¼Œ complex ä»¥åŠå‡½æ•°ä¸èƒ½è¢«ç¼–ç jsonå­—ç¬¦ä¸²ã€‚å½“ç„¶ï¼Œå¾ªç¯çš„æ•°æ®ç»“æ„ä¹Ÿä¸è¡Œï¼Œå®ƒä¼šå¯¼è‡´marshalé™·å…¥æ­»å¾ªç¯ã€‚&lt;/p&gt;
&lt;p&gt;æŒ‡é’ˆå˜é‡ï¼Œç¼–ç æ—¶è‡ªåŠ¨è½¬æ¢ä¸ºå®ƒæ‰€æŒ‡å‘çš„å€¼ï¼Œå¦‚claå˜é‡ã€‚&lt;br&gt;
ï¼ˆå½“ç„¶ï¼Œä¸ä¼ æŒ‡é’ˆï¼ŒStu structçš„æˆå‘˜Classå¦‚æœæ¢æˆClass structç±»å‹ï¼Œæ•ˆæœä¹Ÿæ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚åªä¸è¿‡æŒ‡é’ˆæ›´å¿«ï¼Œä¸”èƒ½èŠ‚çœå†…å­˜ç©ºé—´ã€‚ï¼‰&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œå¼ºè°ƒä¸€å¥ï¼šjsonç¼–ç æˆå­—ç¬¦ä¸²åå°±æ˜¯çº¯ç²¹çš„å­—ç¬¦ä¸²äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šé¢çš„æˆå‘˜å˜é‡éƒ½æ˜¯å·²çŸ¥çš„ç±»å‹ï¼Œåªèƒ½æ¥æ”¶æŒ‡å®šçš„ç±»å‹ï¼Œæ¯”å¦‚stringç±»å‹çš„Nameåªèƒ½èµ‹å€¼stringç±»å‹çš„æ•°æ®ã€‚&lt;br&gt;
ä½†æœ‰æ—¶ä¸ºäº†é€šç”¨æ€§ï¼Œæˆ–ä½¿ä»£ç ç®€æ´ï¼Œæˆ‘ä»¬å¸Œæœ›æœ‰ä¸€ç§ç±»å‹å¯ä»¥æ¥å—å„ç§ç±»å‹çš„æ•°æ®ï¼Œå¹¶è¿›è¡Œjsonç¼–ç ã€‚è¿™å°±ç”¨åˆ°äº†interface{}ç±»å‹ã€‚&lt;/p&gt;
&lt;p&gt;å‰è¨€ï¼š&lt;br&gt;
interface{}ç±»å‹å…¶å®æ˜¯ä¸ªç©ºæ¥å£ï¼Œå³æ²¡æœ‰æ–¹æ³•çš„æ¥å£ã€‚goçš„æ¯ä¸€ç§ç±»å‹éƒ½å®ç°äº†è¯¥æ¥å£ã€‚å› æ­¤ï¼Œä»»ä½•å…¶ä»–ç±»å‹çš„æ•°æ®éƒ½å¯ä»¥èµ‹å€¼ç»™interface{}ç±»å‹ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;type Stu struct {
    Name  interface{} `json:&amp;quot;name&amp;quot;`
    Age   interface{}
    HIgh  interface{}
    sex   interface{}
    Class interface{} `json:&amp;quot;class&amp;quot;`
}

type Class struct {
    Name  string
    Grade int
}

func main() {
    //ä¸å‰é¢çš„ä¾‹å­ä¸€æ ·
    ......
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{&amp;quot;name&amp;quot;:&amp;quot;å¼ ä¸‰&amp;quot;,&amp;quot;Age&amp;quot;:18,&amp;quot;HIgh&amp;quot;:true,&amp;quot;class&amp;quot;:{&amp;quot;Name&amp;quot;:&amp;quot;1ç­&amp;quot;,&amp;quot;Grade&amp;quot;:3}}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»ç»“æœä¸­å¯ä»¥çœ‹å‡ºï¼Œæ— è®ºæ˜¯stringï¼Œintï¼Œboolï¼Œè¿˜æ˜¯æŒ‡é’ˆç±»å‹ç­‰ï¼Œéƒ½å¯èµ‹å€¼ç»™interface{}ç±»å‹ï¼Œä¸”æ­£å¸¸ç¼–ç ï¼Œæ•ˆæœä¸å‰é¢çš„ä¾‹å­ä¸€æ ·ã€‚&lt;/p&gt;
&lt;p&gt;è¡¥å……ï¼š&lt;br&gt;
åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œç¼–ç æˆjsonä¸²çš„æ•°æ®ç»“æ„ï¼Œå¾€å¾€æ˜¯åˆ‡ç‰‡ç±»å‹ã€‚å¦‚ä¸‹å®šä¹‰äº†ä¸€ä¸ª[]StuReadç±»å‹çš„åˆ‡ç‰‡&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;//æ­£ç¡®ç¤ºèŒƒ

//æ–¹å¼1ï¼šåªå£°æ˜ï¼Œä¸åˆ†é…å†…å­˜
var stus1 []*StuRead

//æ–¹å¼2ï¼šåˆ†é…åˆå§‹å€¼ä¸º0çš„å†…å­˜
stus2 := make([]*StuRead,0)

//é”™è¯¯ç¤ºèŒƒ
//new()åªèƒ½å®ä¾‹åŒ–ä¸€ä¸ªstructå¯¹è±¡ï¼Œè€Œ[]StuReadæ˜¯åˆ‡ç‰‡ï¼Œä¸æ˜¯å¯¹è±¡
stus := new([]StuRead)

stu1 := StuRead{æˆå‘˜èµ‹å€¼...}
stu2 := StuRead{æˆå‘˜èµ‹å€¼...}

//ç”±æ–¹å¼1å’Œ2åˆ›å»ºçš„åˆ‡ç‰‡ï¼Œéƒ½èƒ½æˆåŠŸè¿½åŠ æ•°æ®
//æ–¹å¼2æœ€å¥½åˆ†é…0é•¿åº¦ï¼Œappendæ—¶ä¼šè‡ªåŠ¨å¢é•¿ã€‚åä¹‹æŒ‡å®šåˆå§‹é•¿åº¦ï¼Œé•¿åº¦ä¸å¤Ÿæ—¶ä¸ä¼šè‡ªåŠ¨å¢é•¿ï¼Œå¯¼è‡´æ•°æ®ä¸¢å¤±
stus1 := appen(stus1,stu1,stu2)
stus2 := appen(stus2,stu1,stu2)

//æˆåŠŸç¼–ç 
json1,_ := json.Marshal(stus1)
json2,_ := json.Marshal(stus2)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è§£ç æ—¶å®šä¹‰å¯¹åº”çš„åˆ‡ç‰‡æ¥å—å³å¯&lt;/p&gt;
&lt;p&gt;Json Unmarshalï¼šå°†jsonå­—ç¬¦ä¸²è§£ç åˆ°ç›¸åº”çš„æ•°æ®ç»“æ„&lt;br&gt;
æˆ‘ä»¬å°†ä¸Šé¢çš„ä¾‹å­è¿›è¡Œè§£ç &lt;/p&gt;
&lt;pre&gt;&lt;code&gt;type StuRead struct {
    Name  interface{} `json:&amp;quot;name&amp;quot;`
    Age   interface{}
    HIgh  interface{}
    sex   interface{}
    Class interface{} `json:&amp;quot;class&amp;quot;`
    Test  interface{}
}

type Class struct {
    Name  string
    Grade int
}

func main() {
    //jsonå­—ç¬¦ä¸­çš„&amp;quot;å¼•å·ï¼Œéœ€ç”¨\è¿›è¡Œè½¬ä¹‰ï¼Œå¦åˆ™ç¼–è¯‘å‡ºé”™
    //jsonå­—ç¬¦ä¸²æ²¿ç”¨ä¸Šé¢çš„ç»“æœï¼Œä½†å¯¹keyè¿›è¡Œäº†å¤§å°çš„ä¿®æ”¹ï¼Œå¹¶æ·»åŠ äº†sexæ•°æ®
    data:=&amp;quot;{\&amp;quot;name\&amp;quot;:\&amp;quot;å¼ ä¸‰\&amp;quot;,\&amp;quot;Age\&amp;quot;:18,\&amp;quot;high\&amp;quot;:true,\&amp;quot;sex\&amp;quot;:\&amp;quot;ç”·\&amp;quot;,\&amp;quot;CLASS\&amp;quot;:{\&amp;quot;naME\&amp;quot;:\&amp;quot;1ç­\&amp;quot;,\&amp;quot;GradE\&amp;quot;:3}}&amp;quot;
    str:=[]byte(data)

    //1.Unmarshalçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯jsonå­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ¥å—jsonè§£æçš„æ•°æ®ç»“æ„ã€‚
    //ç¬¬äºŒä¸ªå‚æ•°å¿…é¡»æ˜¯æŒ‡é’ˆï¼Œå¦åˆ™æ— æ³•æ¥æ”¶è§£æçš„æ•°æ®ï¼Œå¦‚stuä»ä¸ºç©ºå¯¹è±¡StuRead{}
    //2.å¯ä»¥ç›´æ¥stu:=new(StuRead),æ­¤æ—¶çš„stuè‡ªèº«å°±æ˜¯æŒ‡é’ˆ
    stu:=StuRead{}
    err:=json.Unmarshal(str,&amp;amp;stu)

    //è§£æå¤±è´¥ä¼šæŠ¥é”™ï¼Œå¦‚jsonå­—ç¬¦ä¸²æ ¼å¼ä¸å¯¹ï¼Œç¼º&amp;quot;å·ï¼Œç¼º}ç­‰ã€‚
    if err!=nil{
        fmt.Println(err)
    }

    fmt.Println(stu)
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{å¼ ä¸‰ 18 true &amp;lt;nil&amp;gt; map[naME:1ç­ GradE:3] &amp;lt;nil&amp;gt;}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ€»ç»“ï¼š&lt;/p&gt;
&lt;p&gt;jsonå­—ç¬¦ä¸²è§£ææ—¶ï¼Œéœ€è¦ä¸€ä¸ªâ€œæ¥æ”¶ä½“â€æ¥å—è§£æåçš„æ•°æ®ï¼Œä¸”Unmarshalæ—¶æ¥æ”¶ä½“å¿…é¡»ä¼ é€’æŒ‡é’ˆã€‚å¦åˆ™è§£æè™½ä¸æŠ¥é”™ï¼Œä½†æ•°æ®æ— æ³•èµ‹å€¼åˆ°æ¥å—ä½“ä¸­ã€‚å¦‚è¿™é‡Œç”¨çš„æ˜¯StuRead{}æ¥æ”¶ã€‚&lt;/p&gt;
&lt;p&gt;è§£ææ—¶ï¼Œæ¥æ”¶ä½“å¯è‡ªè¡Œå®šä¹‰ã€‚jsonä¸²ä¸­çš„keyè‡ªåŠ¨åœ¨æ¥æ”¶ä½“ä¸­å¯»æ‰¾åŒ¹é…çš„é¡¹è¿›è¡Œèµ‹å€¼ã€‚åŒ¹é…è§„åˆ™æ˜¯ï¼š&lt;/p&gt;
&lt;p&gt;å…ˆæŸ¥æ‰¾ä¸keyä¸€æ ·çš„jsonæ ‡ç­¾ï¼Œæ‰¾åˆ°åˆ™èµ‹å€¼ç»™è¯¥æ ‡ç­¾å¯¹åº”çš„å˜é‡(å¦‚Name)ã€‚&lt;br&gt;
æ²¡æœ‰jsonæ ‡ç­¾çš„ï¼Œå°±ä»ä¸Šå¾€ä¸‹ä¾æ¬¡æŸ¥æ‰¾å˜é‡åä¸keyä¸€æ ·çš„å˜é‡ï¼Œå¦‚Ageã€‚æˆ–è€…å˜é‡åå¿½ç•¥å¤§å°å†™åä¸keyä¸€æ ·çš„å˜é‡ã€‚å¦‚HIghï¼ŒClassã€‚ç¬¬ä¸€ä¸ªåŒ¹é…çš„å°±èµ‹å€¼ï¼Œåé¢å°±ç®—æœ‰åŒ¹é…çš„ä¹Ÿå¿½ç•¥ã€‚&lt;br&gt;
(å‰ææ˜¯è¯¥å˜é‡å¿…éœ€æ˜¯å¯å¯¼å‡ºçš„ï¼Œå³é¦–å­—æ¯å¤§å†™)ã€‚&lt;br&gt;
ä¸å¯å¯¼å‡ºçš„å˜é‡æ— æ³•è¢«è§£æï¼ˆå¦‚sexå˜é‡ï¼Œè™½ç„¶jsonä¸²ä¸­æœ‰keyä¸ºsexçš„k-vï¼Œè§£æåå…¶å€¼ä»ä¸ºnil,å³ç©ºå€¼ï¼‰&lt;/p&gt;
&lt;p&gt;å½“æ¥æ”¶ä½“ä¸­å­˜åœ¨jsonä¸²ä¸­åŒ¹é…ä¸äº†çš„é¡¹æ—¶ï¼Œè§£æä¼šè‡ªåŠ¨å¿½ç•¥è¯¥é¡¹ï¼Œè¯¥é¡¹ä»ä¿ç•™åŸå€¼ã€‚å¦‚å˜é‡Testï¼Œä¿ç•™ç©ºå€¼nilã€‚&lt;/p&gt;
&lt;p&gt;ä½ ä¸€å®šä¼šå‘ç°ï¼Œå˜é‡Classè²Œä¼¼æ²¡æœ‰è§£æä¸ºæˆ‘ä»¬æœŸå¾…æ ·å­ã€‚å› ä¸ºæ­¤æ—¶çš„Classæ˜¯ä¸ªinterface{}ç±»å‹çš„å˜é‡ï¼Œè€Œjsonä¸²ä¸­keyä¸ºCLASSçš„valueæ˜¯ä¸ªå¤åˆç»“æ„ï¼Œä¸æ˜¯å¯ä»¥ç›´æ¥è§£æçš„ç®€å•ç±»å‹æ•°æ®ï¼ˆå¦‚â€œå¼ ä¸‰â€ï¼Œ18ï¼Œtrueç­‰ï¼‰ã€‚æ‰€ä»¥è§£ææ—¶ï¼Œç”±äºæ²¡æœ‰æŒ‡å®šå˜é‡Classçš„å…·ä½“ç±»å‹ï¼Œjsonè‡ªåŠ¨å°†valueä¸ºå¤åˆç»“æ„çš„æ•°æ®è§£æä¸ºmap[string]interface{}ç±»å‹çš„é¡¹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ­¤æ—¶çš„struct Classå¯¹è±¡ä¸StuReadä¸­çš„Classå˜é‡æ²¡æœ‰åŠæ¯›é’±å…³ç³»ï¼Œæ•…ä¸è¿™æ¬¡çš„jsonè§£ææ²¡æœ‰åŠæ¯›é’±å…³ç³»ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™å‡ ä¸ªinterface{}å˜é‡è§£æåçš„ç±»å‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;func main() {
    //ä¸å‰è¾¹jsonè§£æçš„ä»£ç ä¸€è‡´
    ...
    fmt.Println(stu) //æ‰“å°jsonè§£æå‰å˜é‡ç±»å‹
    err:=json.Unmarshal(str,&amp;amp;stu)
    fmt.Println(&amp;quot;--------------json è§£æå-----------&amp;quot;)
    ... 
    fmt.Println(stu) //æ‰“å°jsonè§£æåå˜é‡ç±»å‹    
}

//åˆ©ç”¨åå°„ï¼Œæ‰“å°å˜é‡ç±»å‹
func printType(stu *StuRead){
    nameType:=reflect.TypeOf(stu.Name)
    ageType:=reflect.TypeOf(stu.Age)
    highType:=reflect.TypeOf(stu.HIgh)
    sexType:=reflect.TypeOf(stu.sex)
    classType:=reflect.TypeOf(stu.Class)
    testType:=reflect.TypeOf(stu.Test)

    fmt.Println(&amp;quot;nameType:&amp;quot;,nameType)
    fmt.Println(&amp;quot;ageType:&amp;quot;,ageType)
    fmt.Println(&amp;quot;highType:&amp;quot;,highType)
    fmt.Println(&amp;quot;sexType:&amp;quot;,sexType)
    fmt.Println(&amp;quot;classType:&amp;quot;,classType)
    fmt.Println(&amp;quot;testType:&amp;quot;,testType)
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;nameType: &amp;lt;nil&amp;gt;
ageType: &amp;lt;nil&amp;gt;
highType: &amp;lt;nil&amp;gt;
sexType: &amp;lt;nil&amp;gt;
classType: &amp;lt;nil&amp;gt;
testType: &amp;lt;nil&amp;gt;
--------------json è§£æå-----------
nameType: string
ageType: float64
highType: bool
sexType: &amp;lt;nil&amp;gt;
classType: map[string]interface {}
testType: &amp;lt;nil&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»ç»“æœä¸­å¯è§&lt;/p&gt;
&lt;p&gt;interface{}ç±»å‹å˜é‡åœ¨jsonè§£æå‰ï¼Œæ‰“å°å‡ºçš„ç±»å‹éƒ½ä¸ºnilï¼Œå°±æ˜¯æ²¡æœ‰å…·ä½“ç±»å‹ï¼Œè¿™æ˜¯ç©ºæ¥å£ï¼ˆinterface{}ç±»å‹ï¼‰çš„ç‰¹ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;jsonè§£æåï¼Œjsonä¸²ä¸­valueï¼Œåªè¦æ˜¯â€ç®€å•æ•°æ®â€ï¼Œéƒ½ä¼šæŒ‰ç…§é»˜è®¤çš„ç±»å‹èµ‹å€¼ï¼Œå¦‚â€å¼ ä¸‰â€è¢«èµ‹å€¼æˆstringç±»å‹åˆ°Nameå˜é‡ä¸­ï¼Œæ•°å­—18å¯¹åº”float64ï¼Œtrueå¯¹åº”boolç±»å‹ã€‚&lt;/p&gt;
&lt;p&gt;â€œç®€å•æ•°æ®â€ï¼šæ˜¯æŒ‡ä¸èƒ½å†è¿›è¡ŒäºŒæ¬¡jsonè§£æçš„æ•°æ®ï¼Œå¦‚â€nameâ€:â€å¼ ä¸‰â€åªèƒ½è¿›è¡Œä¸€æ¬¡jsonè§£æã€‚&lt;br&gt;
â€œå¤åˆæ•°æ®â€ï¼šç±»ä¼¼â€CLASS\â€:{\â€naME\â€:\â€1ç­\â€,\â€GradE\â€:3}è¿™æ ·çš„æ•°æ®ï¼Œæ˜¯å¯è¿›è¡ŒäºŒæ¬¡ç”šè‡³å¤šæ¬¡jsonè§£æçš„ï¼Œå› ä¸ºå®ƒçš„valueä¹Ÿæ˜¯ä¸ªå¯è¢«è§£æçš„ç‹¬ç«‹jsonã€‚å³ç¬¬ä¸€æ¬¡è§£ækeyä¸ºCLASSçš„valueï¼Œç¬¬äºŒæ¬¡è§£ævalueä¸­çš„keyä¸ºnaMEå’ŒGradEçš„value&lt;/p&gt;
&lt;p&gt;å¯¹äºâ€å¤åˆæ•°æ®â€ï¼Œå¦‚æœæ¥æ”¶ä½“ä¸­é…çš„é¡¹è¢«å£°æ˜ä¸ºinterface{}ç±»å‹ï¼Œgoéƒ½ä¼šé»˜è®¤è§£ææˆmap[string]interface{}ç±»å‹ã€‚å¦‚æœæˆ‘ä»¬æƒ³ç›´æ¥è§£æåˆ°struct Classå¯¹è±¡ä¸­ï¼Œå¯ä»¥å°†æ¥å—ä½“å¯¹åº”çš„é¡¹å®šä¹‰ä¸ºè¯¥structç±»å‹ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;type StuRead struct {&lt;br&gt;
...&lt;br&gt;
//æ™®é€šstructç±»å‹&lt;br&gt;
Class Class &lt;code&gt;json:&amp;quot;class&amp;quot;&lt;/code&gt;&lt;br&gt;
//æŒ‡é’ˆç±»å‹&lt;br&gt;
Class *Class &lt;code&gt;json:&amp;quot;class&amp;quot;&lt;/code&gt;&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;stuæ‰“å°ç»“æœ&lt;/p&gt;
&lt;p&gt;Classç±»å‹ï¼š{å¼ ä¸‰ 18 true &lt;nil&gt; {1ç­ 3} &lt;nil&gt;}&lt;br&gt;
*Classç±»å‹ï¼š{å¼ ä¸‰ 18 true &lt;nil&gt; 0xc42008a0c0 &lt;nil&gt;}&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹å‡ºï¼Œä¼ é€’Classç±»å‹çš„æŒ‡é’ˆæ—¶ï¼Œstuä¸­çš„Classå˜é‡å­˜çš„æ˜¯æŒ‡é’ˆï¼Œæˆ‘ä»¬å¯é€šè¿‡è¯¥æŒ‡é’ˆç›´æ¥è®¿é—®æ‰€å±çš„æ•°æ®ï¼Œå¦‚stu.Class.Name/stu.Class.Grade&lt;/p&gt;
&lt;p&gt;Classå˜é‡è§£æåç±»å‹&lt;/p&gt;
&lt;p&gt;classType: main.Class&lt;br&gt;
classType: *main.Class&lt;br&gt;
è§£ææ—¶ï¼Œå¦‚æœæ¥å—ä½“ä¸­åŒæ—¶å­˜åœ¨2ä¸ªåŒ¹é…çš„é¡¹ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ&lt;br&gt;
æµ‹è¯•1&lt;/p&gt;
&lt;p&gt;type StuRead struct {&lt;br&gt;
NAme interface{}&lt;br&gt;
Name  interface{}&lt;br&gt;
NAMe interface{}    &lt;code&gt;json:&amp;quot;name&amp;quot;&lt;/code&gt;&lt;br&gt;
}&lt;br&gt;
ç»“æœ1:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;//å½“å­˜åœ¨åŒ¹é…çš„jsonæ ‡ç­¾æ—¶ï¼Œå…¶å¯¹åº”çš„é¡¹è¢«èµ‹å€¼ã€‚
//åˆ‡è®°ï¼šåŒ¹é…çš„æ ‡ç­¾å¯ä»¥æ²¡æœ‰ï¼Œä½†æœ‰æ—¶æœ€å¥½åªæœ‰ä¸€ä¸ªå“¦
{&amp;lt;nil&amp;gt; &amp;lt;nil&amp;gt; å¼ ä¸‰}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æµ‹è¯•2&lt;/p&gt;
&lt;p&gt;type StuRead struct {&lt;br&gt;
NAme interface{}&lt;br&gt;
Name  interface{}&lt;br&gt;
NAMe interface{}    &lt;code&gt;json:&amp;quot;name&amp;quot;&lt;/code&gt;&lt;br&gt;
NamE interface{}    &lt;code&gt;json:&amp;quot;name&amp;quot;&lt;/code&gt;&lt;br&gt;
}&lt;br&gt;
ç»“æœ2&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;//å½“åŒ¹é…çš„jsonæ ‡ç­¾æœ‰å¤šä¸ªæ—¶ï¼Œæ ‡ç­¾å¯¹åº”çš„é¡¹éƒ½ä¸ä¼šè¢«èµ‹å€¼ã€‚
//å¿½ç•¥æ ‡ç­¾é¡¹ï¼Œä»ä¸Šå¾€ä¸‹å¯»æ‰¾ç¬¬ä¸€ä¸ªæ²¡æœ‰æ ‡ç­¾ä¸”åŒ¹é…çš„é¡¹èµ‹å€¼
{å¼ ä¸‰ &amp;lt;nil&amp;gt; &amp;lt;nil&amp;gt; &amp;lt;nil&amp;gt;}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æµ‹è¯•3&lt;/p&gt;
&lt;p&gt;type StuRead struct {&lt;br&gt;
NAme interface{}&lt;br&gt;
Name  interface{}&lt;br&gt;
}&lt;br&gt;
ç»“æœ3&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;//æ²¡æœ‰jsonæ ‡ç­¾æ—¶ï¼Œä»ä¸Šå¾€ä¸‹ï¼Œç¬¬ä¸€ä¸ªåŒ¹é…çš„é¡¹ä¼šè¢«èµ‹å€¼å“¦
{å¼ ä¸‰ &amp;lt;nil&amp;gt;}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æµ‹è¯•4&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;type StuRead struct {
    NAMe interface{}    `json:&amp;quot;name&amp;quot;`
    NamE interface{}    `json:&amp;quot;name&amp;quot;`
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç»“æœ4&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;//å½“ç›¸åŒçš„jsonæ ‡ç­¾æœ‰å¤šä¸ªï¼Œä¸”æ²¡æœ‰ä¸å¸¦æ ‡ç­¾çš„åŒ¹é…é¡¹æ—¶ï¼ŒæŠ¥é”™äº†å“¦
# command-line-arguments
src/test/b.go:48: stu.Name undefined (type *StuRead has no field or method Name, but does have NAMe)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯è§ï¼Œä¸å‰è¾¹è¯´è¿‡çš„åŒ¹é…è§„åˆ™æ˜¯ä¸€è‡´çš„ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä¸æƒ³æŒ‡å®šClasså˜é‡ä¸ºå…·ä½“çš„ç±»å‹ï¼Œä»æƒ³ä¿ç•™interface{}ç±»å‹ï¼Œä½†åˆå¸Œæœ›è¯¥å˜é‡å¯ä»¥è§£æåˆ°struct Classå¯¹è±¡ä¸­ï¼Œè¿™æ—¶å€™è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿™ç§éœ€æ±‚æ˜¯å¾ˆå¯èƒ½å­˜åœ¨çš„ï¼Œä¾‹å¦‚ç¬”è€…æˆ‘å°±ç¢°åˆ°äº†&lt;/p&gt;
&lt;p&gt;åŠæ³•è¿˜æ˜¯æœ‰çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¯¥å˜é‡å®šä¹‰ä¸ºjson.RawMessageç±»å‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;type StuRead struct {
    Name  interface{}
    Age   interface{}
    HIgh  interface{}
    Class json.RawMessage `json:&amp;quot;class&amp;quot;` //æ³¨æ„è¿™é‡Œ
}

type Class struct {
    Name  string
    Grade int
}

func main() {
    data:=&amp;quot;{\&amp;quot;name\&amp;quot;:\&amp;quot;å¼ ä¸‰\&amp;quot;,\&amp;quot;Age\&amp;quot;:18,\&amp;quot;high\&amp;quot;:true,\&amp;quot;sex\&amp;quot;:\&amp;quot;ç”·\&amp;quot;,\&amp;quot;CLASS\&amp;quot;:{\&amp;quot;naME\&amp;quot;:\&amp;quot;1ç­\&amp;quot;,\&amp;quot;GradE\&amp;quot;:3}}&amp;quot;
    str:=[]byte(data)
    stu:=StuRead{}
    _:=json.Unmarshal(str,&amp;amp;stu)

    //æ³¨æ„è¿™é‡Œï¼šäºŒæ¬¡è§£æï¼
    cla:=new(Class)
    json.Unmarshal(stu.Class,cla)

    fmt.Println(&amp;quot;stu:&amp;quot;,stu)
    fmt.Println(&amp;quot;string(stu.Class):&amp;quot;,string(stu.Class))
    fmt.Println(&amp;quot;class:&amp;quot;,cla)
    printType(&amp;amp;stu) //å‡½æ•°å®ç°å‰é¢ä¾‹å­æœ‰
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç»“æœ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;stu: {å¼ ä¸‰ 18 true [123 34 110 97 77 69 34 58 34 49 231 143 173 34 44 34 71 114 97 100 69 34 58 51 125]}
string(stu.Class): {&amp;quot;naME&amp;quot;:&amp;quot;1ç­&amp;quot;,&amp;quot;GradE&amp;quot;:3}
class: &amp;amp;{1ç­ 3}
nameType: string
ageType: float64
highType: bool
classType: json.RawMessage
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»ç»“æœä¸­å¯è§&lt;/p&gt;
&lt;p&gt;æ¥æ”¶ä½“ä¸­ï¼Œè¢«å£°æ˜ä¸ºjson.RawMessageç±»å‹çš„å˜é‡åœ¨jsonè§£ææ—¶ï¼Œå˜é‡å€¼ä»ä¿ç•™jsonçš„åŸå€¼ï¼Œå³æœªè¢«è‡ªåŠ¨è§£æä¸ºmap[string]interface{}ç±»å‹ã€‚å¦‚å˜é‡Classè§£æåçš„å€¼ä¸ºï¼š{â€œnaMEâ€:â€1ç­â€,â€GradEâ€:3}&lt;/p&gt;
&lt;p&gt;ä»æ‰“å°çš„ç±»å‹ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œåœ¨ç¬¬ä¸€æ¬¡jsonè§£ææ—¶ï¼Œå˜é‡Classçš„ç±»å‹æ˜¯json.RawMessageã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹è¯¥å˜é‡è¿›è¡ŒäºŒæ¬¡jsonè§£æï¼Œå› ä¸ºå…¶å€¼ä»æ˜¯ä¸ªç‹¬ç«‹ä¸”å¯è§£æçš„å®Œæ•´jsonä¸²ã€‚æˆ‘ä»¬åªéœ€å†å®šä¹‰ä¸€ä¸ªæ–°çš„æ¥å—ä½“å³å¯ï¼Œå¦‚json.Unmarshal(stu.Class,cla)&lt;/p&gt;
">golangç¬”è®°-jsonæ•°æ®è§£æï¼šMarshalä¸Unmarshal</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="http://lvelvis.github.io/post/golang-bi-ji-shu-zu-qie-pian-map/"" data-c="
          &lt;h1 id=&#34;æ•°ç»„&#34;&gt;æ•°ç»„&lt;/h1&gt;
&lt;p&gt;æ•°ç»„çš„é•¿åº¦ä¸€æ—¦å®šä¹‰äº†å°±ä¸èƒ½åŠ¨æ€å¢é•¿ï¼Œå¹¶ä¸”å­˜å‚¨çš„æ•°æ®ç±»å‹å¿…é¡»ç›¸åŒã€‚&lt;/p&gt;
&lt;h2 id=&#34;åˆ›å»ºæ–¹æ³•&#34;&gt;åˆ›å»ºæ–¹æ³•ï¼š&lt;/h2&gt;
&lt;p&gt;var æ•°ç»„å [é•¿åº¦]æ•°æ®ç±»å‹&lt;br&gt;
ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;package main
import &amp;quot;fmt&amp;quot;
 
func main(){
    var test [5]int //å®šä¹‰æ•°ç»„åå­—testï¼Œé•¿åº¦ä¸º5ï¼Œæ•°æ®ç±»å‹ä¸ºintçš„æ•°ç»„
    test[0] = 1    //èµ‹å€¼
    test[1] = 2   
    test[2] = 3
    test[3] = 4
    fmt.Println(test) 
    fmt.Println(test[2])
    fmt.Println(test[1:3]) //è¾“å‡º1åˆ°3çš„æ•°ç»„
    fmt.Println(test[0:]) //0åˆ°ç»“å°¾
    fmt.Println(test[:3])  //0åˆ°3
 
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##ç»“æœ##
[1 2 3 4 0]
3
[2 3]
[1 2 3 4 0]
[1 2 3]
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;æ•°ç»„çš„å››ç§åˆå§‹åŒ–æ–¹å¼&#34;&gt;æ•°ç»„çš„å››ç§åˆå§‹åŒ–æ–¹å¼&lt;/h2&gt;
&lt;p&gt;ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;var s1 [3]int = [3]int{1,2,3}
fmt.Println(&amp;quot;s1&amp;quot;,s1)
var s2 [4]int = [...]int{5,6,7,8} //[...]æ˜¯å›ºå®šå†™æ³•
fmt.Println(&amp;quot;s2&amp;quot;,s2)
var s3 = [2]int{9,10} //ç¬¬ä¸€ç§çš„ç®€åŒ–
fmt.Println(&amp;quot;s3&amp;quot;,s3)
var s4 = [...]int{3:43,1:41,0:40,2:42} //ç±»ä¼¼é”®å€¼å¯¹
fmt.Println(&amp;quot;s4&amp;quot;,s4)
var s5 = new([5]int)
s5[4] =12
fmt.Println(&amp;quot;s5&amp;quot;,s5)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##ç»“æœ##
s1 [1 2 3]
s2 [5 6 7 8]
s3 [9 10]
s4 [40 41 42 43]
s5 [0 0 0 0 5]
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;æ•°ç»„çš„éå†&#34;&gt;æ•°ç»„çš„éå†&lt;/h2&gt;
&lt;p&gt;ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;var s4 = [...]int{3:43,1:41,0:40,2:42} //ç±»ä¼¼é”®å€¼å¯¹
fmt.Println(&amp;quot;s4&amp;quot;,s4)
     
for index,value := range s4{
fmt.Println(index,value)
}
 
#ç»“æœ##
0 40
1 41
2 42
3 43
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;var s4 = [...]int{3:43,1:41,0:40,2:42} //ç±»ä¼¼é”®å€¼å¯¹
for i := 0;i &amp;lt;len(s4);i++{
fmt.Println(i,s4[i])
}
 
#ç»“æœ##
0 40
1 41
2 42
3 43
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;sliceåˆ‡ç‰‡&#34;&gt;sliceåˆ‡ç‰‡&lt;/h1&gt;
&lt;p&gt;1ã€åˆ‡ç‰‡æ˜¯æ•°ç»„çš„å¼•ç”¨(åˆ‡ç‰‡æ˜¯æ•°ç»„çš„ä¸€éƒ¨åˆ†)&lt;br&gt;
2ã€åˆ‡ç‰‡çš„ä½¿ç”¨ç±»ä¼¼æ•°ç»„ï¼Œå¦‚éå†&lt;br&gt;
3ã€åˆ‡ç‰‡çš„é•¿åº¦æ˜¯å¯å˜çš„&lt;/p&gt;
&lt;h2 id=&#34;åˆ›å»ºè¯­æ³•&#34;&gt;åˆ›å»ºè¯­æ³•&lt;/h2&gt;
&lt;p&gt;var åˆ‡ç‰‡å []ç±»å‹&lt;br&gt;
å¦‚ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;var qiepian []int
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;åˆ‡ç‰‡ç¤ºä¾‹&#34;&gt;åˆ‡ç‰‡ç¤ºä¾‹:&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;###ä¾‹å­ä¸€&amp;lt;br&amp;gt;var suzhu [4]int = [...]int{5,6,7,8}
slice := suzhu[1:4] //1åˆ°4çš„å€¼ï¼Œä¸åŒ…å«4
fmt.Println(suzhu)
fmt.Println(slice)
fmt.Println(&amp;quot;åˆ‡ç‰‡çš„å®¹é‡&amp;quot;,cap(slice))
 
##ç»“æœ
[5 6 7 8]
[6 7 8]
åˆ‡ç‰‡çš„å®¹é‡ 3&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;
###ä¾‹å­äºŒã€ä½¿ç”¨makeåˆ›å»ºåˆ‡ç‰‡
var slice []int = make([]int,4,10) //ç±»å‹ï¼Œå¤§å°(é•¿åº¦),å®¹é‡ï¼ˆå¯é€‰ï¼‰ï¼Œå®¹é‡å¿…é¡»å¤§äºé•¿åº¦
slice[0] = 10
slice[1] = 11
fmt.Println(slice)
 
##ç»“æœ##
[10 11 0 0]
 
 
###ä¾‹å­ä¸‰
var slice []int = []int {2,4,6}
fmt.Println(slice)
 
##ç»“æœ##
2 4 6
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;åˆ‡ç‰‡çš„appendè¿½åŠ &#34;&gt;åˆ‡ç‰‡çš„appendè¿½åŠ &lt;/h2&gt;
&lt;p&gt;ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;var slice []int = []int {2,4,6}
fmt.Println(slice)
//ä½¿ç”¨appendç›´æ¥è¿½åŠ åˆ‡ç‰‡å†…å®¹ï¼ˆç±»ä¼¼python listçš„appendï¼‰
slice = append(slice,8,10)
fmt.Println(slice)
slice = append(slice,slice...) //è¿½åŠ åˆ‡ç‰‡ï¼Œ...æ˜¯å›ºå®šå†™æ³•
fmt.Println(slice)
 
###ç»“æœ###
[2 4 6]
[2 4 6 8 10]
[2 4 6 8 10 2 4 6 8 10]
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;åˆ‡ç‰‡çš„copyæ“ä½œ&#34;&gt;åˆ‡ç‰‡çš„copyæ“ä½œ&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨copyå†…ç½®å‡½æ•°&lt;br&gt;
ä¾‹å¦‚:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;var slice []int = []int {2,4,6}
fmt.Println(slice)
var slice2 []int = make([]int,5)
fmt.Println(slice2)
copy(slice2,slice) //å°†sliceå¤åˆ¶ç»™slice2
fmt.Println(slice)
fmt.Println(slice2)
 
##ç»“æœ##
[2 4 6]
[0 0 0 0 0]
[2 4 6]
[2 4 6 0 0]
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;ä½¿ç”¨åˆ‡ç‰‡æ”¹å˜å­—ç¬¦ä¸²çš„å†…å®¹&#34;&gt;ä½¿ç”¨åˆ‡ç‰‡æ”¹å˜å­—ç¬¦ä¸²çš„å†…å®¹&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;var str string = &amp;quot;hello&amp;quot;
fmt.Println(str)
arr := []byte(str)
arr[1] = &#39;a&#39; //è½¬æˆå­—ç¬¦ä¸²
arr1 := []rune(str) //ä¸­æ–‡è½¬æ¢
arr1[0] = &#39;ç‹—&#39;
fmt.Println(arr)
str = string(arr)
fmt.Println(str)
str = string(arr1)
fmt.Println(str)
 
##ç»“æœ##
hello
[104 97 108 108 111]
hello
ç‹—hello
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;map&#34;&gt;map&lt;/h1&gt;
&lt;p&gt;mapæ˜¯key-valueæ•°æ®ç»“æ„(ç±»ä¼¼pythonçš„dict)&lt;br&gt;
mapæ˜¯æ— åºå­˜å‚¨çš„&lt;/p&gt;
&lt;p&gt;åˆ›å»ºmapè¯­æ³•&lt;br&gt;
var map å˜é‡å map[keytype]valuetype&lt;/p&gt;
&lt;p&gt;å¦‚ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;var m1 map[string]string
var m2 map[string]int
var m3 map[int]string
var m4 map[string]map[string]string
```ã€€ã€€

ä½¿ç”¨ä¾‹å­ï¼š
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;package main&lt;br&gt;
import &amp;quot;fmt&amp;quot;&lt;/p&gt;
&lt;p&gt;func main(){&lt;br&gt;
var m1 map[string]string&lt;br&gt;
//åœ¨ä½¿ç”¨mapå‰,éœ€è¦å…ˆmakeï¼Œmakeçš„ä½œç”¨æŠ€æœ¯ç»™mapåˆ†é…æ•°æ®ç©ºé—´&lt;br&gt;
m1 = make(map[string]string)&lt;br&gt;
m2 := map[string]string{  //ä½¿ç”¨æ–¹å¼äºŒ&lt;br&gt;
&amp;quot;a1&amp;quot; : &amp;quot;q1&amp;quot;,&lt;br&gt;
&amp;quot;a2&amp;quot; : &amp;quot;a2&amp;quot;,&lt;br&gt;
}&lt;br&gt;
m1[&amp;quot;s1&amp;quot;] = &amp;quot;äºšç´¢&amp;quot;&lt;br&gt;
m1[&amp;quot;s2&amp;quot;] = &amp;quot;ç›–ä¼¦&amp;quot;&lt;br&gt;
fmt.Println(m1)&lt;br&gt;
fmt.Println(m1[&amp;quot;s1&amp;quot;])&lt;br&gt;
fmt.Println(m2)&lt;br&gt;
}&lt;/p&gt;
&lt;p&gt;###ç»“æœ###&lt;br&gt;
map[s1:äºšç´¢ s2:ç›–ä¼¦]&lt;br&gt;
äºšç´¢&lt;br&gt;
map[a1:q1 a2:a2]&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
 

mapçš„å¢åˆ æ”¹æŸ¥
å¢ã€æ”¹
map[key] = value //æ²¡æœ‰å°±å¢åŠ ï¼Œå­˜åœ¨å°±ä¿®æ”¹

åˆ 
delete(map,key)

æŸ¥
map[key]   //å¯¹åº”çš„valueï¼Œå’Œpythonçš„dictä¸€æ ·&lt;/code&gt;&lt;/pre&gt;
">golangç¬”è®°-æ•°ç»„ã€åˆ‡ç‰‡ã€map</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="http://lvelvis.github.io/post/k8s-hpa-dan-xing-kuo-rong-pei-zhi/"" data-c="
          &lt;pre&gt;&lt;code&gt;HPAå…¨ç§°Horizontal Pod Autoscalingï¼Œæ˜¯K8så®ç°podè‡ªåŠ¨æ°´å¹³æ‰©å®¹ç¼©å®¹çš„ç‰¹æ€§ï¼Œè¿™ä¸ªç‰¹æ€§ä½¿æ•´ä¸ªkubernetesé›†ç¾¤é©¬ä¸Šé«˜å¤§ä¸Šèµ·æ¥äº†ã€‚
è¦ä½¿ç”¨HPAä¹Ÿä¸æ˜¯è¿™ä¹ˆç®€å•çš„ï¼ŒHPA apiåˆ†v1ã€v2beta1ã€v2bate2ä¸‰ç§ï¼Œv1åªæ”¯æŒé€šè¿‡CPUè¡¡é‡æ‰©ç¼©å®¹ï¼Œv2bate1åŠ å…¥é’ˆå¯¹å†…å­˜ä½œä¸ºåº¦é‡ï¼Œv2bate2å¯ä»¥ç”¨customer metricsä¾‹å¦‚ç½‘ç»œç­‰ï¼Œæ‰€ä»¥v2bate1å¼€å§‹æ‰æ¯”è¾ƒå®ç”¨ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¦ä½¿ç”¨HPAå¿…é¡»è¦å¼€å¯ä»¥ä¸‹ä¸¤ä¸ªç‰¹æ€§ï¼š&lt;/p&gt;
&lt;p&gt;Aggregation Layer èšåˆå±‚ï¼Œé€šè¿‡ä¸æ ¸å¿ƒçš„apiserveråˆ†ç¦»ï¼Œå®ç°è‡ªå®šä¹‰çš„æ‰©å±•åŠŸèƒ½&lt;br&gt;
metrics-server æ•°æ®æ”¶é›†ï¼Œèƒ½å¤Ÿæ”¶é›†podã€nodeç­‰å®æ—¶è¿è¡ŒæŒ‡æ ‡ï¼ˆcpuã€å†…å­˜ï¼‰ï¼Œç»™k8sé›†ç¾¤ä½¿ç”¨ï¼Œä¾‹å¦‚kubectl topå‘½ä»¤ã€HPA&lt;br&gt;
æ¯”è¾ƒè€çš„ç‰ˆæœ¬ä½¿ç”¨heapster&lt;/p&gt;
&lt;h1 id=&#34;aggregation-layer&#34;&gt;Aggregation Layer&lt;/h1&gt;
&lt;p&gt;è¦æ‰“å¼€Aggregation Layerï¼Œéœ€è¦é…ç½®ä¸€ä¸‹apiserverï¼Œå¢åŠ ç›¸å…³è®¤è¯è¯ä¹¦ã€‚è®¤è¯æµç¨‹æ˜¯clientå‘èµ·è¯·æ±‚åˆ°apiserverï¼Œapiserverä¸aggergated apiserverå»ºç«‹tlså®‰å…¨é“¾æ¥ï¼ŒæŠŠè¯·æ±‚proxyåˆ°aggergated apiserverï¼Œç»§ç»­è¿›è¡Œâ€“requestheader-*å‚æ•°çš„ç›¸å…³è®¤è¯ã€‚&lt;/p&gt;
&lt;p&gt;è®¤è¯æµç¨‹&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1589865988979.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;éœ€è¦ç”Ÿæˆaggregateä½¿ç”¨çš„è¯ä¹¦ï¼Œå‚è€ƒcfsslç”Ÿæˆè¯ä¹¦æ–¹æ³•ï¼Œproxy-client-cert-fileçš„CNéœ€è¦ä¸requestheader-allowed-namesåŒ¹é…ã€‚&lt;br&gt;
åœ¨apiserverå¢åŠ å¦‚ä¸‹å¯åŠ¨å‚æ•°&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;--requestheader-client-ca-file=/etc/kubernetes/pki/agg-ca.pem
--proxy-client-cert-file=/etc/kubernetes/pki/aggregate.pem
--proxy-client-key-file=/etc/kubernetes/pki/aggregate-key.pem
--requestheader-allowed-names=aggregator
--requestheader-extra-headers-prefix=X-Remote-Extra-
--requestheader-group-headers=X-Remote-Group
--requestheader-username-headers=X-Remote-User
#å¦‚æœkube-proxyæ²¡æœ‰åœ¨Masterä¸Šé¢è¿è¡Œï¼Œè¿˜éœ€è¦é…ç½®
--enable-aggregator-routing=true
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;metrics-server&#34;&gt;metrics server&lt;/h1&gt;
&lt;p&gt;ä»k8s 1.8å¼€å§‹ï¼Œé›†ç¾¤çš„èµ„æºä½¿ç”¨æƒ…å†µéƒ½é€šè¿‡metrics apiæ”¶é›†ï¼Œä¾‹å¦‚å®¹å™¨CPUã€å†…å­˜ã€‚è¿™äº›æŒ‡æ ‡å¯ç”¨äºkuberctl topæˆ–è€…k8sçš„HPAç­‰ç‰¹æ€§ã€‚&lt;br&gt;
metrice serverå¯ä»¥åœ¨githubæ‰¾åˆ°å¹¶éƒ¨ç½²&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;git clone https://github.com/kubernetes-incubator/metrics-server
cd metrics-server
kubectl create -f deploy/1.8+/
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;æ³¨1ï¼šmetrics-serveré»˜è®¤ä½¿ç”¨nodeçš„ä¸»æœºåï¼Œä½†æ˜¯corednsé‡Œé¢æ²¡æœ‰ç‰©ç†æœºä¸»æœºåçš„è§£æï¼Œä¸€ç§æ˜¯éƒ¨ç½²çš„æ—¶å€™æ·»åŠ ä¸€ä¸ªå‚æ•°ï¼š â€“kubelet-preferred-address-types=InternalIP,Hostname,InternalDNS,ExternalDNS,ExternalIP,ç¬¬äºŒç§æ˜¯ä½¿ç”¨dnsmasqæ„å»ºä¸€ä¸ªä¸Šæ¸¸çš„dnsæœåŠ¡
æ³¨2ï¼škubelet çš„10250ç«¯å£ä½¿ç”¨çš„æ˜¯httpsåè®®ï¼Œè¿æ¥éœ€è¦éªŒè¯tlsè¯ä¹¦ã€‚å¯ä»¥åœ¨metrics serverå¯åŠ¨å‘½ä»¤æ·»åŠ å‚æ•°â€“kubelet-insecure-tlsä¸éªŒè¯å®¢æˆ·ç«¯è¯ä¹¦
æ³¨3ï¼šyamlæ–‡ä»¶ä¸­çš„imageåœ°å€k8s.gcr.io/metrics-server-amd64:v0.3.3 éœ€è¦æ¢¯å­ï¼Œéœ€è¦æ”¹æˆä¸­å›½å¯ä»¥è®¿é—®çš„imageåœ°å€ï¼Œå¯ä»¥ä½¿ç”¨aliyunçš„ã€‚è¿™é‡Œä½¿ç”¨hub.docker.comé‡Œçš„googleé•œåƒåœ°å€ image: mirrorgooglecontainers/metrics-server-amd64:v0.3.3
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆåŠŸè¿è¡Œkubectl topå‘½ä»¤&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ubuntu@k8s-dev-m1:~/k8sssl/agglayer$ kubectl top nodes
NAME                   CPU(cores)   CPU%   MEMORY(bytes)   MEMORY%   
k8s-dev-node2          103m         5%      2696Mi                 72%       
k8s-dev-node3.bxr.cn   115m      2%     5312Mi                  67%  
k8s-dev-node4          57m          2%       2634Mi                  70%     
k8s-dev-node5          148m         7%       2443Mi                  65%
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;hpa&#34;&gt;HPA&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;æœ‰äº†metricså°±å¯ä»¥å¼€å§‹ä½¿ç”¨HPAç‰¹æ€§äº†ã€‚hpaæœ‰å‡ ä¸ªç‰¹ç‚¹
deployæˆ–è€…rsç­‰éœ€è¦è®¾ç½®resourcesæ‰èƒ½ä½¿ç”¨hpa
å¦‚æœæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªHPA controllerï¼Œå®ƒä¼šæ¯éš”15sï¼ˆå¯ä»¥é€šè¿‡â€“horizontal-pod-autoscaler-sync-periodä¿®æ”¹ï¼‰æ£€æµ‹ä¸€æ¬¡hpaå®šä¹‰çš„èµ„æºä¸å®é™…èµ„æºä½¿ç”¨æƒ…å†µï¼Œå¦‚æœè¾¾åˆ°é˜€å€¼å°±ä¼šè°ƒæ•´podæ•°é‡ã€‚
HPAè®¾ç½®çš„é˜€å€¼ä¸æ˜¯ç»å¯¹çš„ï¼Œå…è®¸è®¾ç½®ä¸€ä¸ªæµ®åŠ¨èŒƒå›´ï¼Œâ€“horizontal-pod-autoscaler-toleranceé»˜è®¤æ˜¯0.1
podè°ƒæ•´ç®—æ³• desiredReplicas = ceil[currentReplicas * ( currentMetricValue / desiredMetricValue )]
scaleæœ‰ä¸€ä¸ªçª—å£æœŸï¼ŒæœŸé—´æ¯æ¬¡å˜åŒ–ä¼šè®°å½•ä¸‹æ¥ï¼Œé€‰æ‹©æœ€ä¼˜çš„è°ƒæ•´å»ºè®®å†è¿›è¡Œscaleï¼Œè¿™æ ·å¯ä»¥ä¿è¯èµ„æºå¹³æ»‘å˜åŠ¨ï¼Œé€šè¿‡â€“horizontal-pod-autoscaler-downscale-stabilizationè®¾å®šï¼Œé»˜è®¤5åˆ†é’Ÿã€‚
é€šè¿‡hpaè°ƒæ•´æ–°å¢çš„podä¸ä¼šé©¬ä¸Šreadyï¼Œè¿™æ—¶å€™æ”¶é›†çš„metricså°±ä¸å‡†ï¼Œä¸ºäº†å‡å°‘å½±å“ï¼Œhpaä¸€å¼€å§‹ä¸ä¼šæ”¶é›†æ–°podçš„metricsã€‚é€šè¿‡â€“horizontal-pod-autoscaler-initial-readiness-delayï¼ˆé»˜è®¤30sï¼‰å’Œ â€“horizontal-pod-autoscaler-cpu-initialization-periodï¼ˆé»˜è®¤ä¸º 5 åˆ†é’Ÿï¼‰è°ƒæ•´
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;http://lvelvis.github.io/post-images/1589866316410.svg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ç¤ºä¾‹hpa.yml:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: autoscaling/v2beta2
kind: HorizontalPodAutoscaler
metadata:
  name: hpa-test
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: podinfo
  minReplicas: 2
  maxReplicas: 10
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 75
  - type: Resource
    resource:
      name: memory
      target:
        type: Utilization 
        averageUtilization: 160
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šé¢çš„ç¤ºä¾‹åŒ…æ‹¬cpuå’ŒmemoryæŒ‡æ ‡ï¼ŒaverageUtilizationè¿™ä¸ªç™¾åˆ†æ¯”æ˜¯æ ¹æ®deploymentçš„resources.requestsè®¡ç®—çš„ã€‚ä¾‹å¦‚æœ‰deploymenté™åˆ¶requestsæ˜¯512Miï¼Œreplicasæ˜¯2ï¼Œå®é™…pod1ç”¨äº†612Miï¼Œpod2ç”¨äº†598Miï¼Œè®¡ç®—å…¬å¼æ˜¯ (612+598)/2/512 = 118%&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹hpaçš„æƒ…å†µï¼Œtargetsç¬¬ä¸€ä¸ªæ˜¯memoryï¼Œç¬¬äºŒä¸ªæ˜¯cpuæŒ‡æ ‡ï¼ŒREPLICASæ˜¯æ ¹æ®è®¡ç®—åçš„å½“å‰podæ•°&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ubuntu@k8s-m1:~/k8s/hpa$ kubectl get hpa
NAME       REFERENCE            TARGETS             MINPODS   MAXPODS   REPLICAS   AGE
hpa-test   Deployment/podinfo   120%/160%, 6%/75%   2         4         3          97m
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å®˜æ–¹ç¤ºä¾‹è¿˜åŒ…æ‹¬packets-per-secondã€requests-per-secondè¿™äº›æŒ‡æ ‡ï¼Œéœ€è¦è¿›ä¸€æ­¥éªŒè¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: autoscaling/v2beta1
kind: HorizontalPodAutoscaler
metadata:
  name: php-apache
  namespace: default
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: php-apache
  minReplicas: 1
  maxReplicas: 10
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: AverageUtilization
        averageUtilization: 50
  - type: Pods
    pods:
      metric:
        name: packets-per-second
      targetAverageValue: 1k
  - type: Object
    object:
      metric:
        name: requests-per-second
      describedObject:
        apiVersion: networking.k8s.io/v1beta1
        kind: Ingress
        name: main-route
      target:
        kind: Value
        value: 10k
status:
  observedGeneration: 1
  lastScaleTime: &amp;lt;some-time&amp;gt;
  currentReplicas: 1
  desiredReplicas: 1
  currentMetrics:
  - type: Resource
    resource:
      name: cpu
    current:
      averageUtilization: 0
      averageValue: 0
  - type: Object
    object:
      metric:
        name: requests-per-second
      describedObject:
        apiVersion: networking.k8s.io/v1beta1
        kind: Ingress
        name: main-route
      current:
        value: 10k

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale-walkthrough/#create-horizontal-pod-autoscaler&#34;&gt;å®˜æ–¹hpaå‚æ•°&lt;/a&gt;&lt;/p&gt;
">k8s hpaå¼¹æ€§æ‰©å®¹é…ç½®</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="http://lvelvis.github.io/post/beego-jing-tai-wen-jian-jia-zai-lu-jing-xiu-gai/"" data-c="
          &lt;p&gt;Go è¯­è¨€å†…éƒ¨å…¶å®å·²ç»æä¾›äº† http.ServeFileï¼Œé€šè¿‡è¿™ä¸ªå‡½æ•°å¯ä»¥å®ç°é™æ€æ–‡ä»¶çš„æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;beego é’ˆå¯¹è¿™ä¸ªåŠŸèƒ½è¿›è¡Œäº†ä¸€å±‚å°è£…ï¼Œé€šè¿‡ä¸‹é¢çš„æ–¹å¼è¿›è¡Œé™æ€æ–‡ä»¶æ³¨å†Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;beego.SetStaticPath(&amp;quot;/static&amp;quot;,&amp;quot;public&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è·¯å¾„ï¼Œurl è·¯å¾„ä¿¡æ¯&lt;br&gt;
ç¬¬äºŒä¸ªå‚æ•°æ˜¯é™æ€æ–‡ä»¶ç›®å½•ï¼ˆç›¸å¯¹åº”ç”¨æ‰€åœ¨çš„ç›®å½•ï¼‰&lt;br&gt;
beego æ”¯æŒå¤šä¸ªç›®å½•çš„é™æ€æ–‡ä»¶æ³¨å†Œï¼Œç”¨æˆ·å¯ä»¥æ³¨å†Œå¦‚ä¸‹çš„é™æ€æ–‡ä»¶ç›®å½•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;beego.SetStaticPath(&amp;quot;/images&amp;quot;,&amp;quot;images&amp;quot;)
beego.SetStaticPath(&amp;quot;/css&amp;quot;,&amp;quot;css&amp;quot;)
beego.SetStaticPath(&amp;quot;/js&amp;quot;,&amp;quot;js&amp;quot;)
```ã€€ã€€

è®¾ç½®äº†å¦‚ä¸Šçš„é™æ€ç›®å½•ä¹‹åï¼Œç”¨æˆ·è®¿é—® /images/login/login.pngï¼Œé‚£ä¹ˆå°±ä¼šè®¿é—®åº”ç”¨å¯¹åº”çš„ç›®å½•ä¸‹é¢çš„ images/login/login.png æ–‡ä»¶ã€‚

å¦‚æœæ˜¯è®¿é—® /static/img/logo.pngï¼Œé‚£ä¹ˆå°±è®¿é—® public/img/logo.pngæ–‡ä»¶ã€‚

é»˜è®¤æƒ…å†µä¸‹ beego ä¼šåˆ¤æ–­ç›®å½•ä¸‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨ç›´æ¥è¿”å› 404 é¡µé¢ï¼Œå¦‚æœè¯·æ±‚çš„æ˜¯ index.htmlï¼Œé‚£ä¹ˆç”±äº http.ServeFile é»˜è®¤æ˜¯ä¼šè·³è½¬çš„ï¼Œä¸æä¾›è¯¥é¡µé¢çš„æ˜¾ç¤ºã€‚

å› æ­¤ beego å¯ä»¥è®¾ç½® beego.BConfig.WebConfig.DirectoryIndex=true è¿™æ ·æ¥ä½¿å¾—æ˜¾ç¤º index.html é¡µé¢ã€‚è€Œä¸”å¼€å¯è¯¥åŠŸèƒ½ä¹‹åï¼Œç”¨æˆ·è®¿é—®ç›®å½•å°±ä¼šæ˜¾ç¤ºè¯¥ç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶åˆ—è¡¨ã€‚&lt;/code&gt;&lt;/pre&gt;
">beegoé™æ€æ–‡ä»¶åŠ è½½è·¯å¾„ä¿®æ”¹</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="http://lvelvis.github.io/post/yong-hu-kong-jian-gua-zai-ceph-wen-jian-xi-tong/"" data-c="
          &lt;p&gt;Ceph v0.55 åŠåç»­ç‰ˆæœ¬é»˜è®¤å¼€å¯äº† cephx è®¤è¯ã€‚ä»ç”¨æˆ·ç©ºé—´ï¼ˆ FUSE ï¼‰æŒ‚è½½ä¸€ Ceph æ–‡ä»¶ç³»ç»Ÿå‰ï¼Œç¡®ä¿å®¢æˆ·ç«¯ä¸»æœºæœ‰ä¸€ä»½ Ceph é…ç½®å‰¯æœ¬ã€å’Œå…·å¤‡ Ceph å…ƒæ•°æ®æœåŠ¡å™¨èƒ½åŠ›çš„å¯†é’¥ç¯ã€‚&lt;/p&gt;
&lt;p&gt;1ã€ åœ¨å®¢æˆ·ç«¯ä¸»æœºä¸Šï¼ŒæŠŠç›‘è§†å™¨ä¸»æœºä¸Šçš„ Ceph é…ç½®æ–‡ä»¶æ‹·è´åˆ° /etc/ceph/ ç›®å½•ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo mkdir -p /etc/ceph
sudo scp {user}@{server-machine}:/etc/ceph/ceph.conf /etc/ceph/ceph.conf
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€ åœ¨å®¢æˆ·ç«¯ä¸»æœºä¸Šï¼ŒæŠŠç›‘è§†å™¨ä¸»æœºä¸Šçš„ Ceph å¯†é’¥ç¯æ‹·è´åˆ° /etc/ceph ç›®å½•ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo scp {user}@{server-machine}:/etc/ceph/ceph.keyring /etc/ceph/ceph.keyring
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€ ç¡®ä¿å®¢æˆ·ç«¯æœºå™¨ä¸Šçš„ Ceph é…ç½®æ–‡ä»¶å’Œå¯†é’¥ç¯éƒ½æœ‰åˆé€‚çš„æƒé™ä½ï¼Œå¦‚ chmod 644 ã€‚&lt;br&gt;
cephx å¦‚ä½•é…ç½®è¯·å‚è€ƒ CEPHX é…ç½®å‚è€ƒã€‚&lt;br&gt;
è¦æŠŠ Ceph æ–‡ä»¶ç³»ç»ŸæŒ‚è½½ä¸ºç”¨æˆ·ç©ºé—´æ–‡ä»¶ç³»ç»Ÿï¼Œå¯ä»¥ç”¨ ceph-fuse å‘½ä»¤ï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo mkdir /home/usernname/cephfs
sudo ceph-fuse -m 192.168.0.1:6789 /home/username/cephfs
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¯¦æƒ…è§ &lt;a href=&#34;http://docs.ceph.org.cn/man/8/ceph-fuse/&#34;&gt;ceph-fuse&lt;/a&gt;&lt;/p&gt;
">ç”¨æˆ·ç©ºé—´æŒ‚è½½ CEPH æ–‡ä»¶ç³»ç»Ÿ</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="http://lvelvis.github.io/post/linux-ru-he-dao-ru-zi-ding-yi-zheng-shu/"" data-c="
          &lt;h1 id=&#34;é—®é¢˜&#34;&gt;é—®é¢˜&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;curl https://192.168.0.200:8443
æç¤ºcurl: (60) Peer&#39;s Certificate issuer is not recognized.
curl: (60) Peer&#39;s Certificate issuer is not recognized.
More details here: http://curl.haxx.se/docs/sslcerts.html

curl performs SSL certificate verification by default, using a &amp;quot;bundle&amp;quot;
 of Certificate Authority (CA) public keys (CA certs). If the default
 bundle file isn&#39;t adequate, you can specify an alternate file
 using the --cacert option.
If this HTTPS server uses a certificate signed by a CA represented in
 the bundle, the certificate verification probably failed due to a
 problem with the certificate (it might be expired, or the name might
 not match the domain name in the URL).
If you&#39;d like to turn off curl&#39;s verification of the certificate, use
 the -k (or --insecure) option.
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;mac-os-x&#34;&gt;Mac OS X&lt;/h1&gt;
&lt;h2 id=&#34;æ·»åŠ è¯ä¹¦&#34;&gt;æ·»åŠ è¯ä¹¦ï¼š&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;sudo security add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain ~/new-root-certificate.crt
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;ç§»é™¤è¯ä¹¦&#34;&gt;ç§»é™¤è¯ä¹¦ï¼š&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;sudo security delete-certificate -c &amp;quot;&amp;lt;name of existing certificate&amp;gt;&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;windows&#34;&gt;Windows&lt;/h1&gt;
&lt;h2 id=&#34;æ·»åŠ è¯ä¹¦-2&#34;&gt;æ·»åŠ è¯ä¹¦ï¼š&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;certutil -addstore -f &amp;quot;ROOT&amp;quot; new-root-certificate.crt
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;ç§»é™¤è¯ä¹¦-2&#34;&gt;ç§»é™¤è¯ä¹¦ï¼š&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;certutil -delstore &amp;quot;ROOT&amp;quot; serial-number-hex
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;linux-ubuntu-debian&#34;&gt;Linux (Ubuntu, Debian)&lt;/h1&gt;
&lt;h2 id=&#34;æ·»åŠ è¯ä¹¦-3&#34;&gt;æ·»åŠ è¯ä¹¦ï¼š&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;å¤åˆ¶ CA æ–‡ä»¶åˆ°ç›®å½•ï¼š /usr/local/share/ca-certificates/
æ‰§è¡Œ:
sudo cp foo.crt /usr/local/share/ca-certificates/foo.crt
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;æ›´æ–°-ca-è¯ä¹¦åº“&#34;&gt;æ›´æ–° CA è¯ä¹¦åº“:&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;sudo update-ca-certificates
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;ç§»é™¤è¯ä¹¦-3&#34;&gt;ç§»é™¤è¯ä¹¦ï¼š&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;Remove your CA.

Update the CA store:

sudo update-ca-certificates --fresh

Restart Kerio Connect to reload the certificates in the 32-bit versions or Debian 7.
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;linux-centos-6&#34;&gt;Linux (CentOs 6)&lt;/h1&gt;
&lt;h2 id=&#34;æ·»åŠ è¯ä¹¦-4&#34;&gt;æ·»åŠ è¯ä¹¦ï¼š&lt;/h2&gt;
&lt;p&gt;// root-ca.crt ä¸ºcaè¯ä¹¦&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;å®‰è£… ca-certificates package:

yum install ca-certificates

å¯ç”¨dynamic CA configuration feature:

update-ca-trust force-enable

Add it as a new file to /etc/pki/ca-trust/source/anchors/:
cp root-ca.crt /etc/pki/ca-trust/source/anchors/

æ‰§è¡Œ:

update-ca-trust extract

Restart Kerio Connect to reload the certificates in the 32-bit version.
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;linux-centos-5&#34;&gt;Linux (CentOs 5)&lt;/h1&gt;
&lt;h2 id=&#34;æ·»åŠ è¯ä¹¦-5&#34;&gt;æ·»åŠ è¯ä¹¦ï¼š&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;Append your trusted certificate to file /etc/pki/tls/certs/ca-bundle.crt

cat foo.crt &amp;gt;&amp;gt; /etc/pki/tls/certs/ca-bundle.crt
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;æµ‹è¯•è®¿é—®&#34;&gt;æµ‹è¯•è®¿é—®&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt; curl -v &amp;quot;https:/gitlab.test.com/micro-lib/server?go-get=1&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
">linuxå¦‚ä½•å¯¼å…¥è‡ªå®šä¹‰è¯ä¹¦</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="http://lvelvis.github.io/post/istio-ke-hu-duan-yuan-di-zhi-ru-he-xian-shi/"" data-c="
          &lt;h3 id=&#34;å‰æ&#34;&gt;å‰æ&lt;/h3&gt;
&lt;p&gt;ç”±äºistioéƒ¨ç½²åˆ°IDCã€éäº‘ç¯å¢ƒæ— æ³•è·å–å®¢æˆ·ç«¯çœŸå®IPåœ°å€ï¼Œwebåº”ç”¨æ— æ³•ä½¿ç”¨è¯¥ç»„ä»¶ï¼Œæ—©æœŸç‰ˆæœ¬çš„istioåšäº†å¾ˆå¤šæµ‹è¯•ï¼Œæœ€ç»ˆæ— æ³•å®ç°è·å–remote client addressï¼›&lt;/p&gt;
&lt;h3 id=&#34;ç¯å¢ƒ&#34;&gt;ç¯å¢ƒ&lt;/h3&gt;
&lt;p&gt;kubernetesç‰ˆæœ¬ï¼šk8s-1.16.9&lt;br&gt;
istioç‰ˆæœ¬ï¼š1.5&lt;/p&gt;
&lt;h3 id=&#34;æ–¹æ³•&#34;&gt;æ–¹æ³•&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;kubectl -n istio-system edit  deployments. istio-pilot
æ·»åŠ å¦‚ä¸‹ï¼š
       env:
       - name: PILOT_SIDECAR_USE_REMOTE_ADDRESS
          value: &amp;quot;true&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯githubç›¸åº”çš„issue&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588232244321.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;å…¶ä»–æµ‹è¯•&#34;&gt;å…¶ä»–æµ‹è¯•&lt;/h3&gt;
&lt;p&gt;istio-1.5ç‰ˆæœ¬å›å½’å•ä½“ï¼Œå„ä¸ªç»„ä»¶ä¼˜åŒ–äº†å¾ˆå¤šï¼ŒåæœŸæµ‹è¯•httpé“¾æ¥ä¸tcpé“¾æ¥åº”ç”¨&lt;/p&gt;
">istio-å®¢æˆ·ç«¯æºåœ°å€å¦‚ä½•æ˜¾ç¤º</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="http://lvelvis.github.io/post/k8s-tong-guo-helm-bu-shu-elk-73/"" data-c="
          &lt;h1 id=&#34;å‰æ&#34;&gt;å‰æï¼š&lt;/h1&gt;
&lt;p&gt;åœ¨kubernetesé›†ç¾¤ä¸­éƒ¨ç½²elkç»„ä»¶ï¼Œesé›†ç¾¤éƒ¨ç½²3ä¸ªèŠ‚ç‚¹ï¼Œkibanaéƒ¨ç½²ä¸€ä¸ªï¼Œå®¹å™¨æ•°æ®æŒä¹…åŒ–éœ€è¦storageclass&lt;/p&gt;
&lt;p&gt;ä¾èµ–ï¼š&lt;br&gt;
Helm&lt;br&gt;
Persistent Volumes&lt;/p&gt;
&lt;h1 id=&#34;å‡†å¤‡é…ç½®&#34;&gt;å‡†å¤‡é…ç½®&lt;/h1&gt;
&lt;p&gt;ç”±äºrepoåœ¨çº¿å®‰è£…å¤ªæ…¢ï¼Œå»ºè®®ä¸‹è½½charæœ¬åœ°ä¿®æ”¹å‚æ•°åå®‰è£…&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;git clone https://github.com/elastic/helm-charts.git
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;éƒ¨ç½²-elk&#34;&gt;éƒ¨ç½² ELK&lt;/h1&gt;
&lt;h2 id=&#34;åˆ›å»ºelkå‘½åç©ºé—´&#34;&gt;åˆ›å»ºelkå‘½åç©ºé—´&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;#cat elk-ns.yml
apiVersion: v1
kind: Namespace
metadata:
  name: elk
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;éƒ¨ç½²elasticsearch&#34;&gt;éƒ¨ç½²elasticsearch&lt;/h2&gt;
&lt;p&gt;cd helm-charts/elasticsearch&lt;/p&gt;
&lt;p&gt;helm install --namespace=elk  --name=elasticsearch .&lt;/p&gt;
&lt;h2 id=&#34;éƒ¨ç½²-kibana&#34;&gt;éƒ¨ç½² Kibana&lt;/h2&gt;
&lt;p&gt;cd helm-charts/kibana&lt;/p&gt;
&lt;p&gt;helm install --namespace=elk --name=kibana .&lt;br&gt;
é€šè¿‡ kubectl get deploy å’Œ pod äº†è§£éƒ¨ç½²çŠ¶æ€ï¼›&lt;/p&gt;
&lt;h1 id=&#34;å°çŸ¥è¯†&#34;&gt;å°çŸ¥è¯†&lt;/h1&gt;
&lt;p&gt;Kibana ç›´æ¥é€šè¿‡ K8S å†…éƒ¨ DNS åŸŸå è®¿é—® ESã€‚&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹å®¹å™¨å†…çš„é…ç½®&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl  exec kibana-kibana-7cbc5db55c-6qct7 -c kibana -- cat /usr/share/kibana/config/kibana.yml

# Default Kibana configuration for docker target
server.name: kibana
server.host: &amp;quot;0&amp;quot;
elasticsearch.hosts: [ &amp;quot;http://elasticsearch:9200&amp;quot; ]
xpack.monitoring.ui.container.elasticsearch.enabled: true
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;kibana-æ·»åŠ -ingress&#34;&gt;Kibana æ·»åŠ  Ingress&lt;/h1&gt;
&lt;p&gt;é€šè¿‡ Ingress æ·»åŠ è®¿é—®å…¥å£&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: kibana
  namespace: default
spec:
  rules:
  - host: &amp;lt;YourDomain&amp;gt;  ## è®¿é—® Kibana çš„åŸŸå 
    http:
      paths:
      - backend:
          serviceName: kibana-kibana
          servicePort: 5601
        path: /
 status:
  loadBalancer:
    ingress:
    - ip: &amp;lt;YourLoadBalancerIP&amp;gt;  ## LB çš„ IP
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;è®¿é—®æµ‹è¯•&#34;&gt;è®¿é—®æµ‹è¯•&lt;/h1&gt;
&lt;p&gt;è®¿é—®åŸŸåï¼Œå³å¯æ‰“å¼€ Kibana 7.3 ç‰ˆæœ¬ï¼›&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;http://lvelvis.github.io/post-images/1588231324831.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æŸ¥çœ‹é›†ç¾¤çš„è¿è¡ŒçŠ¶æ€&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;http://lvelvis.github.io/post-images/1588231313286.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤è¡ŒæŸ¥çœ‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;~$ curl  -s &amp;lt;YourESHost&amp;gt;/_cluster/health | jq .
{
  &amp;quot;cluster_name&amp;quot;: &amp;quot;elasticsearch&amp;quot;,
  &amp;quot;status&amp;quot;: &amp;quot;yellow&amp;quot;,
  &amp;quot;timed_out&amp;quot;: false,
  &amp;quot;number_of_nodes&amp;quot;: 3,
  &amp;quot;number_of_data_nodes&amp;quot;: 3,
  &amp;quot;active_primary_shards&amp;quot;: 19,
  &amp;quot;active_shards&amp;quot;: 35,
  &amp;quot;relocating_shards&amp;quot;: 0,
  &amp;quot;initializing_shards&amp;quot;: 0,
  &amp;quot;unassigned_shards&amp;quot;: 3,
  &amp;quot;delayed_unassigned_shards&amp;quot;: 0,
  &amp;quot;number_of_pending_tasks&amp;quot;: 0,
  &amp;quot;number_of_in_flight_fetch&amp;quot;: 0,
  &amp;quot;task_max_waiting_in_queue_millis&amp;quot;: 0,
  &amp;quot;active_shards_percent_as_number&amp;quot;: 92.10526315789474
}
&lt;/code&gt;&lt;/pre&gt;
">K8Sé€šè¿‡helm éƒ¨ç½² ELK 7.3</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="http://lvelvis.github.io/post/kubesphere-an-zhuang-shi-yong-ti-yan/"" data-c="
          &lt;p&gt;æœ€è¿‘åˆå‡ºæ¥ä¸ªkubesphereçš„å·¥å…·ç”¨æ¥ç®¡ç†k8sï¼Œä»Šå¤©ç‰¹æ„æ¥å®‰è£…ä½“éªŒä¸‹ï¼›&lt;br&gt;
githubåœ°å€ï¼šhttps://github.com/pixiake/ks-installer&lt;/p&gt;
&lt;p&gt;å®˜æ–¹ä½¿ç”¨æ–‡æ¡£ï¼šhttps://kubesphere.io/docs/advanced-v2.0/zh-CN/installation/all-in-one/&lt;/p&gt;
&lt;p&gt;å…ˆæ”¾ä¸Šå®‰è£…æ•ˆæœå›¾ï¼ŒUIç•Œé¢è¿˜æ˜¯å¾ˆæ¸…çˆ½çš„ï¼š&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588152934567.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;å½“å‰ç¯å¢ƒ&#34;&gt;å½“å‰ç¯å¢ƒï¼š&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;k8sé›†ç¾¤å·²ç»å®‰è£…å®Œæˆï¼Œç”¨kubesphereç®¡ç†ç°æœ‰çš„k8sé›†ç¾¤ï¼›

k8sç‰ˆæœ¬ä¸º1.14  

ç³»ç»Ÿä¸ºcentos7.6

kubesphereä½¿ç”¨è¦æ±‚ï¼š

kubernetes version &amp;gt; 1.13.0

helm version &amp;gt; 2.10.0

a default storage class must be in kubernetes cluster
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å®‰è£…å®Œæˆåé»˜è®¤ç”¨æˆ·åå¯†ç ï¼š&lt;/p&gt;
&lt;p&gt;ç”¨æˆ·åï¼šadmin&lt;/p&gt;
&lt;p&gt;å¯†ç ï¼šP@88w0rd&lt;/p&gt;
&lt;h3 id=&#34;å¼€å§‹å®‰è£…&#34;&gt;å¼€å§‹å®‰è£…&lt;/h3&gt;
&lt;p&gt;å®‰è£…æ­¥éª¤å¤§æ¦‚è®°å½•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl create ns kubesphere-system
kubectl create ns kubesphere-monitoring-system

#è®¿é—®etcdç”¨åˆ°çš„secret
kubectl -n kubesphere-monitoring-system create secret generic kube-etcd-client-certs  --from-file=etcd-client-ca.crt=ca.pem  --from-file=etcd-client.crt=etcd-key.pem  --from-file=etcd-client.key=etcd.pem

#ç®¡ç†k8sç”¨åˆ°çš„secret

kubectl -n kubesphere-system create secret generic kubesphere-ca  --from-file=ca.crt=ca.pem --from-file=ca.key=ca-key.pem

#cloneå¥½githubé¡¹ç›®ï¼Œæ‰§è¡Œä¸‹é¢çš„è¿™æ¡å‘½ä»¤

cd deploy
kubectl apply -f kubesphere-installer.yaml
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰§è¡Œå®Œä¸Šé¢çš„å‘½ä»¤ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤ï¼ŒæŸ¥çœ‹å®‰è£…è¿‡ç¨‹æ—¥å¿—&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kubectl logs -n kubesphere-system $(kubectl get pod -n kubesphere-system -l job-name=kubesphere-installer -o jsonpath=&#39;{.items[0].metadata.name}&#39;) -f
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æŸ¥çœ‹å®‰è£…ç»“æœï¼ŒSTATUSè·Ÿä¸‹é¢ä¿æŒä¸€è‡´æ‰è¯´æ˜å®‰è£…æˆåŠŸ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[root@ks-allinone deploy]# kubectl get pods -n kubesphere-system
NAME                                     READY   STATUS      RESTARTS   AGE
ks-account-6db466d8dc-srrwj              1/1     Running     0          149m
ks-apigateway-7d77cb9495-jzmg6           1/1     Running     0          170m
ks-apiserver-f8469fd47-b58rm             1/1     Running     0          166m
ks-console-54c849bdc9-dfkbf              1/1     Running     0          168m
ks-console-54c849bdc9-z2d5q              1/1     Running     0          168m
ks-controller-manager-569456b4cd-gngm5   1/1     Running     0          170m
ks-docs-6bbdcc9bfb-6jldz                 1/1     Running     0          3h7m
kubesphere-installer-7ph6l               0/1     Completed   1          3h11m
openldap-5c986c5bff-rzqwv                1/1     Running     0          3h25m
redis-76dc4db5dd-lv6kg                   1/1     Running     0          149m
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å®‰è£…è¿‡ç¨‹å‡ºç°çš„é”™è¯¯&#34;&gt;å®‰è£…è¿‡ç¨‹å‡ºç°çš„é”™è¯¯&lt;/h3&gt;
&lt;p&gt;1.åœ¨å®‰è£…çš„æ—¶æç¤ºmetrics-serverå·²ç»å®‰è£…ï¼Œå¯¼è‡´å®‰è£…ä¸­æ–­ï¼›&lt;/p&gt;
&lt;p&gt;è§£æåŠæ³•ï¼šåœ¨kubesphere-installer.yamlçš„configMapå¢åŠ é…ç½®ï¼šmetrics_server_enable: Falseï¼ˆé»˜è®¤æ˜¯æ²¡æœ‰çš„ï¼‰&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: v1
data:
  ks-config.yaml: |
    kube_apiserver_host: 10.10.5.208:6443
    etcd_tls_enable: True
    etcd_endpoint_ips: 10.10.5.169,10.10.5.183,10.10.5.184
    disableMultiLogin: True
    elk_prefix: logstash
    metrics_server_enable: False
  #  local_registry: 192.168.1.2:5000
kind: ConfigMap
metadata:
  name: kubesphere-config
  namespace: kubesphere-system
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¢åŠ Ingressé…ç½®ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: kubesphere
  namespace: kubesphere-system
  annotations:
    #kubernetes.io/ingress.class: traefik
    kubernetes.io/ingress.class: nginx
spec:
  rules:
  - host: ks.staplescn.com
    http:
      paths:
      - path:
        backend:
          serviceName: ks-console
          servicePort: 80
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è®¿é—®ç•Œé¢ï¼š&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588153130667.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
">kubesphereå®‰è£…ä½¿ç”¨ä½“éªŒ</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="http://lvelvis.github.io/post/kubernetes-tekton-cicd-chi-xu-ji-cheng-liu-shui-xian/"" data-c="
          &lt;h1 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h1&gt;
&lt;p&gt;æˆ‘ä»¬é€šå¸¸çš„å¼€å‘æµç¨‹æ˜¯ï¼Œåœ¨æœ¬åœ°å¼€å‘å®Œæˆåº”ç”¨ä¹‹åï¼Œä½¿ç”¨gitä½œä¸ºç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œå°†æœ¬åœ°ä»£ç æäº¤åˆ°ç±»ä¼¼Githubè¿™æ ·çš„ä»“åº“ä¸­åšæŒä¹…åŒ–å­˜å‚¨ï¼Œå½“æˆ‘ä»¬å¯èƒ½æ¥è‡ªå¤šä¸ªä»“åº“ã€å¯èƒ½æ¶‰åŠåˆ°å¤šä¸ªä¸­é—´ä»¶ä½œä¸ºåº•å±‚ä¾èµ–ä¸€èµ·éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¸­æ—¶ï¼Œç›¸ä¿¡ä¸å°‘åœ¨å¤§ä¸­å‹ä¼ä¸šå·¥ä½œçš„å°ä¼™ä¼´éƒ½çŸ¥é“å…¬å¸å†…éƒ¨é€šå¸¸ä¼šæœ‰å‘å¸ƒç³»ç»Ÿï¼Œé‚£ä¹ˆäº‘åŸç”ŸæŠ€æœ¯æ ˆä¸­æœ‰æ²¡æœ‰ä¸ºæˆ‘ä»¬æä¾›ç±»ä¼¼çš„å‘å¸ƒç³»ç»Ÿå‘¢ï¼Ÿæ¡£æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œè€Œä¸”ä¸ä¹ç«äº‰è€…ï¼Œä¸šå†…çŸ¥åçš„æœ‰knavtie Build/jekinsX/spinnaker/orgo/tektonï¼Œå…¶ä¸­ï¼Œtekonå‡­å€Ÿå…¶ä¼—å¤šä¼˜è‰¯ç‰¹æ€§åœ¨ä¸€ä¼—ç«äº‰è€…ä¸­èƒœå‡ºï¼Œæˆä¸ºé¢†åŸŸå†…çš„äº‹å®æ ‡å‡†ï¼Œä»Šå¤©æˆ‘ä»¬å°±æ¥æ­å¼€Tektonçš„ç¥ç§˜é¢çº±ã€‚&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588236885419.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;æ­£æ–‡&#34;&gt;æ­£æ–‡&lt;/h1&gt;
&lt;h3 id=&#34;ä»€ä¹ˆæ˜¯tekton&#34;&gt;ä»€ä¹ˆæ˜¯Tekton&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;http://lvelvis.github.io/post-images/1588236902661.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
é‚£Tektonéƒ½æä¾›äº†å“ªäº›CRDå‘¢ï¼Ÿ&lt;br&gt;
â€¢	Taskï¼šé¡¾åæ€ä¹‰ï¼Œtaskè¡¨ç¤ºä¸€ä¸ªæ„å»ºä»»åŠ¡ï¼Œtaské‡Œå¯ä»¥å®šä¹‰ä¸€ç³»åˆ—çš„stepsï¼Œä¾‹å¦‚ç¼–è¯‘ä»£ç ã€æ„å»ºé•œåƒã€æ¨é€é•œåƒç­‰ï¼Œæ¯ä¸ªstepå®é™…ç”±ä¸€ä¸ªPodæ‰§è¡Œã€‚&lt;br&gt;
â€¢	TaskRunï¼štaskåªæ˜¯å®šä¹‰äº†ä¸€ä¸ªæ¨¡ç‰ˆï¼ŒtaskRunæ‰çœŸæ­£ä»£è¡¨äº†ä¸€æ¬¡å®é™…çš„è¿è¡Œï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥è‡ªå·±æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªtaskRunï¼ŒtaskRunåˆ›å»ºå‡ºæ¥ä¹‹åï¼Œå°±ä¼šè‡ªåŠ¨è§¦å‘taskæè¿°çš„æ„å»ºä»»åŠ¡ã€‚&lt;br&gt;
â€¢	Pipelineï¼šä¸€ä¸ªæˆ–å¤šä¸ªtaskã€PipelineResourceä»¥åŠå„ç§å®šä¹‰å‚æ•°çš„é›†åˆã€‚&lt;br&gt;
â€¢	PipelineRunï¼šç±»ä¼¼taskå’ŒtaskRunçš„å…³ç³»ï¼ŒpipelineRunä¹Ÿè¡¨ç¤ºæŸä¸€æ¬¡å®é™…è¿è¡Œçš„pipelineï¼Œä¸‹å‘ä¸€ä¸ªpipelineRun CRDå®ä¾‹åˆ°kubernetesåï¼ŒåŒæ ·ä¹Ÿä¼šè§¦å‘ä¸€æ¬¡pipelineçš„æ„å»ºã€‚&lt;br&gt;
â€¢	PipelineResourceï¼šè¡¨ç¤ºpipeline inputèµ„æºï¼Œæ¯”å¦‚githubä¸Šçš„æºç ï¼Œæˆ–è€…pipeline outputèµ„æºï¼Œä¾‹å¦‚ä¸€ä¸ªå®¹å™¨é•œåƒæˆ–è€…æ„å»ºç”Ÿæˆçš„jaråŒ…ç­‰ã€‚&lt;br&gt;
ä»–ä»¬å¤§æ¦‚æœ‰å¦‚ä¸‹å›¾æ‰€ç¤ºçš„å…³ç³»ï¼š&lt;br&gt;
å®˜æ–¹ä»‹ç»ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Tekton æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ä¸”çµæ´»çš„ Kubernetes åŸç”Ÿå¼€æºæ¡†æ¶ï¼Œç”¨äºåˆ›å»ºæŒç»­é›†æˆå’Œäº¤ä»˜ï¼ˆCI/CDï¼‰ç³»ç»Ÿã€‚é€šè¿‡æŠ½è±¡åº•å±‚å®ç°ç»†èŠ‚ï¼Œç”¨æˆ·å¯ä»¥è·¨å¤šäº‘å¹³å°å’Œæœ¬åœ°ç³»ç»Ÿè¿›è¡Œæ„å»ºã€æµ‹è¯•å’Œéƒ¨ç½²ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;ä¸ªäººç†è§£ï¼š
â€¢	ä»¥yamlæ–‡ä»¶ç¼–æ’åº”ç”¨æ„å»ºåŠéƒ¨ç½²æµç¨‹
â€¢	knavtive buildæ¨¡å—å‡çº§ç‰ˆï¼Œç¤¾åŒºæœ€ç»ˆé‡‡ç”¨ Tekton æ›¿ä»£ knavtive Buildä½œä¸ºäº‘åŸç”Ÿé¢†åŸŸçš„CI/CD è§£å†³æ–¹æ¡ˆ
â€¢	æ ‡å‡†åŒ–CI/CDæµæ°´çº¿æ„å»ºã€æµ‹è¯•åŠéƒ¨ç½²æµç¨‹çš„å·¥å…·
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Tektonåœ¨ä¸€ä¼—ç«äº‰å¯¹æ‰‹çš„æ¯”æ‹¼ä¸­PKèƒœå‡ºï¼š&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588236947460.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹é¢å°±è®©æˆ‘ä»¬ä¸€èµ·æ¥æ·±å…¥è¯¦ç»†äº†è§£ä¸‹Tektonåˆ°åº•æ€ä¹ˆç©ã€‚&lt;br&gt;
Tekton Pipelineä¸­æœ‰5ç±»å¯¹è±¡ï¼Œæ ¸å¿ƒç†å¿µæ˜¯é€šè¿‡å®šä¹‰yamlå®šä¹‰æ„å»ºè¿‡ç¨‹ã€‚&lt;br&gt;
â€¢	Taskï¼šä¸€ä¸ªä»»åŠ¡çš„æ‰§è¡Œæ¨¡æ¿ï¼Œç”¨äºæè¿°å•ä¸ªä»»åŠ¡çš„æ„å»ºè¿‡ç¨‹&lt;br&gt;
â€¢	TaskRunï¼šéœ€è¦é€šè¿‡å®šä¹‰TaskRunä»»åŠ¡å»è¿è¡ŒTaskã€‚&lt;br&gt;
â€¢	Pipelineï¼šåŒ…å«å¤šä¸ªTask,å¹¶åœ¨æ­¤åŸºç¡€ä¸Šå®šä¹‰inputå’Œoutput,inputå’Œoutputä»¥PipelineResourceä½œä¸ºäº¤ä»˜ã€‚&lt;br&gt;
â€¢	PipelineRunï¼šéœ€è¦å®šä¹‰PipelineRunæ‰ä¼šè¿è¡ŒPipelineã€‚&lt;br&gt;
â€¢	PipelineResourceï¼šå¯ç”¨äºinputå’Œoutputçš„å¯¹è±¡é›†åˆã€‚&lt;/p&gt;
&lt;h3 id=&#34;task&#34;&gt;Task&lt;/h3&gt;
&lt;p&gt;Task å°±æ˜¯ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œæ¨¡æ¿ï¼Œä¹‹æ‰€ä»¥è¯´ Task æ˜¯ä¸€ä¸ªæ¨¡æ¿æ˜¯å› ä¸º Task å®šä¹‰ä¸­å¯ä»¥åŒ…å«å˜é‡ï¼ŒTask åœ¨çœŸæ­£æ‰§è¡Œçš„æ—¶å€™éœ€è¦ç»™å®šå˜é‡çš„å…·ä½“å€¼ã€‚å¦‚æœæŠŠ Tekton çš„ Task æœ‰ç‚¹å„¿ç±»ä¼¼äºå®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼ŒTask é€šè¿‡ inputs.params å®šä¹‰éœ€è¦å“ªäº›å…¥å‚ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªå…¥å‚è¿˜å¯ä»¥æŒ‡å®šé»˜è®¤å€¼ã€‚Task çš„ steps å­—æ®µè¡¨ç¤ºå½“å‰ Task æ˜¯æœ‰å“ªäº›æ­¥éª¤ç»„æˆçš„ï¼Œæ¯ä¸€ä¸ªæ­¥éª¤å…·ä½“å°±æ˜¯åŸºäºé•œåƒå¯åŠ¨ä¸€ä¸ª container æ‰§è¡Œä¸€äº›æ“ä½œï¼Œcontainer çš„å¯åŠ¨å‚æ•°å¯ä»¥é€šè¿‡ Task çš„å…¥å‚ä½¿ç”¨æ¨¡æ¿è¯­æ³•è¿›è¡Œé…ç½®ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªDemoï¼š&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588236983683.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;taskrun&#34;&gt;TaskRun&lt;/h3&gt;
&lt;p&gt;Task å®šä¹‰å¥½ä»¥åæ˜¯ä¸èƒ½æ‰§è¡Œçš„ï¼Œå°±åƒä¸€ä¸ªå‡½æ•°å®šä¹‰å¥½ä»¥åéœ€è¦è°ƒç”¨æ‰èƒ½æ‰§è¡Œä¸€æ ·ã€‚æ‰€ä»¥éœ€è¦å†å®šä¹‰ä¸€ä¸ª TaskRun å»æ‰§è¡Œ Taskã€‚&lt;br&gt;
TaskRun ä¸»è¦æ˜¯è´Ÿè´£è®¾ç½® Task éœ€è¦çš„å‚æ•°ï¼Œå¹¶é€šè¿‡ taskRef å­—æ®µå¼•ç”¨è¦æ‰§è¡Œçš„ Taskã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªDemoï¼š&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588237005091.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯åœ¨å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬å¾ˆå°‘ä½¿ç”¨TaskRunï¼Œå› ä¸ºå®ƒåªèƒ½ç»™ä¸ä¸€ä¸ªTask ä¼ å‚ï¼ŒTektonæä¾›äº†ç»™å¤šä¸ªTaskåŒæ—¶ä¼ å‚çš„è§£å†³æ–¹æ¡ˆPipelineå’ŒPipelineRunï¼Œä¸”çœ‹ä¸‹æ–‡è¯¦è§£ï¼Œè¿™é‡Œåªæ˜¯å¤šå˜´ä¸€ä¸‹ï¼Œè¿™ä¸ªTaskRunå¾ˆå°‘ä½¿ç”¨ï¼Œç¨å¾®äº†è§£ä¸‹å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;pipeline&#34;&gt;Pipeline&lt;/h3&gt;
&lt;p&gt;ä¸€ä¸ª TaskRun åªèƒ½æ‰§è¡Œä¸€ä¸ª Taskï¼Œå½“éœ€è¦ç¼–æ’å¤šä¸ª Task çš„æ—¶å€™å°±éœ€è¦ Pipeline å‡ºé©¬äº†ã€‚Pipeline æ˜¯ä¸€ä¸ªç¼–æ’ Task çš„æ¨¡æ¿ã€‚Pipeline çš„ params å£°æ˜äº†æ‰§è¡Œæ—¶éœ€è¦çš„å…¥å‚ã€‚ Pipeline çš„ spec.tasks å®šä¹‰äº†éœ€è¦ç¼–æ’çš„ Taskã€‚Tasks æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­çš„ task å¹¶ä¸æ˜¯é€šè¿‡æ•°ç»„å£°æ˜çš„é¡ºåºå»æ‰§è¡Œçš„ï¼Œè€Œæ˜¯é€šè¿‡ runAfter æ¥å£°æ˜ task æ‰§è¡Œçš„é¡ºåºã€‚Tekton controller åœ¨è§£æ CRD çš„æ—¶å€™ä¼šè§£æ Task çš„é¡ºåºï¼Œç„¶åæ ¹æ® runAfter è®¾ç½®ç”Ÿæˆçš„ä¾æ¬¡æ ‘ä¾æ¬¡å»æ‰§è¡Œã€‚Pipeline åœ¨ç¼–æ’ Task çš„æ—¶å€™éœ€è¦ç»™æ¯ä¸€ä¸ª Task ä¼ å…¥å¿…é¡»çš„å‚æ•°ï¼Œè¿™äº›å‚æ•°çš„å€¼å¯ä»¥æ¥è‡ª Pipeline è‡ªèº«çš„ params è®¾ç½®ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªDemoï¼š&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588237033509.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588237113343.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;pipelinerun&#34;&gt;PipelineRun&lt;/h3&gt;
&lt;p&gt;å’Œ Task ä¸€æ · Pipeline å®šä¹‰å®Œæˆä»¥åä¹Ÿæ˜¯ä¸èƒ½ç›´æ¥æ‰§è¡Œçš„ï¼Œéœ€è¦ PipelineRun æ‰èƒ½æ‰§è¡Œ Pipelineã€‚PipelineRun çš„ä¸»è¦ä½œç”¨æ˜¯ç»™ Pipeline ä¼ å…¥å¿…è¦çš„å…¥å‚ï¼Œå¹¶æ‰§è¡Œ Pipelineã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªDemoï¼š&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588237145814.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588237151158.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;pipelineresource&#34;&gt;PipelineResource&lt;/h3&gt;
&lt;p&gt;å¯èƒ½ä½ è¿˜æƒ³åœ¨ Task ä¹‹é—´å…±äº«èµ„æºï¼Œè¿™å°±æ˜¯ PipelineResource çš„ä½œç”¨ã€‚æ¯”å¦‚æˆ‘ä»¬å¯ä»¥æŠŠ git ä»“åº“ä¿¡æ¯æ”¾åœ¨ PipelineResource ä¸­ã€‚è¿™æ ·æ‰€æœ‰ Task å°±å¯ä»¥å…±äº«è¿™äº›ä¿¡æ¯äº†ã€‚&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588237189249.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588237194640.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588237221271.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;å®æˆ˜&#34;&gt;å®æˆ˜&lt;/h1&gt;
&lt;p&gt;å…³äºTektonçš„å®æˆ˜ï¼Œå¯ä»¥å‚è€ƒGithubé‡Œé¢çš„è¿™ä¸ªå®Œæ•´çš„Demoï¼Œé‡Œé¢æ˜¯ä¸€ä¸ªgoè¯­è¨€å§ç¼–å†™çš„webæœåŠ¡ï¼Œæ¥å£å¯ä»¥æ‰“å°&amp;quot;Hello world&amp;quot;ã€‚æ—¶é—´æœ‰é™ï¼Œå°±ä¸åšæ¼”ç¤ºäº†ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥åœ¨è‡ªå·±çš„k8sé›†ç¾¤ä¸Šé¢è·‘ä¸€ä¸‹æ„Ÿå—ä¸€ä¸‹ï¼Œç›¸å…³çš„yamlæ–‡ä»¶ä¹Ÿå¯ä»¥æ‹·è´ä¸‹æ¥ï¼Œä½œä¸ºåé¢æ”¹å†™çš„æ¨¡æ¿ã€‚&lt;br&gt;
å‡†å¤‡ PIpeline çš„èµ„æº&lt;br&gt;
kubectl apply -f tasks/source-to-image.yaml -f tasks/deploy-using-kubectl.yaml  -f resources/picalc-git.yaml -f image-secret.yaml -f pipeline-account.yaml -f pipeline/build-and-deploy-pipeline.yaml&lt;br&gt;
æ‰§è¡Œ create æŠŠ pipelieRun æäº¤åˆ° Kubernetes é›†ç¾¤ã€‚ä¹‹æ‰€ä»¥è¿™é‡Œä½¿ç”¨ create è€Œä¸æ˜¯ä½¿ç”¨ apply æ˜¯å› ä¸º PIpelineRun æ¯æ¬¡éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ï¼Œkubectl çš„ create æŒ‡ä»¤ä¼šåŸºäº generateName åˆ›å»ºæ–°çš„ PIpelineRun èµ„æºã€‚&lt;br&gt;
kubectl create -f run/picalc-pipeline-run.yaml&lt;/p&gt;
&lt;h1 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h1&gt;
&lt;p&gt;Tektonä»¥K8Sä¸ºä¾æ‰˜ï¼Œæˆä¸ºäº‘åŸç”Ÿé¢†åŸŸCI/CDçš„äº‹å®æ€§æ ‡å‡†ï¼Œå¸®åŠ©æˆ‘ä»¬æé«˜äº‘åŸç”Ÿç¯å¢ƒä¸‹çš„åº”ç”¨æ„å»ºå’Œéƒ¨ç½²æ•ˆç‡ã€‚&lt;br&gt;
æ¥ä¸€å¼ å›¾å¯¹å…¨æ–‡åšä¸€ä¸ªç®€å•çš„æ€»ç»“ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;http://lvelvis.github.io/post-images/1588236724398.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;å‚è€ƒèµ„æ–™&#34;&gt;å‚è€ƒèµ„æ–™&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;https://cloud.google.com/tekton/&#34;&gt;Tektonå®˜ç½‘&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/knative-sample/tekton-knative/tree/b1.0?spm=ata.13261165.0.0.21213a182xyMm5&amp;amp;file=b1.0&#34;&gt;Tekton Demo&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
">kubernetes Tekton-CI/CD æŒç»­é›†æˆæµæ°´çº¿</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="http://lvelvis.github.io/post/kubernetesæ­å»ºrook-ceph/"" data-c="
          &lt;h1 id=&#34;ç®€ä»‹&#34;&gt;ç®€ä»‹&lt;/h1&gt;
&lt;p&gt;Rookå®˜ç½‘ï¼šhttps://rook.io&lt;br&gt;
Rookæ˜¯äº‘åŸç”Ÿè®¡ç®—åŸºé‡‘ä¼š(CNCF)çš„å­µåŒ–çº§é¡¹ç›®.&lt;br&gt;
Rookæ˜¯Kubernetesçš„å¼€æºäº‘æœ¬åœ°å­˜å‚¨åè°ƒå™¨ï¼Œä¸ºå„ç§å­˜å‚¨è§£å†³æ–¹æ¡ˆæä¾›å¹³å°ï¼Œæ¡†æ¶å’Œæ”¯æŒï¼Œä»¥ä¾¿ä¸äº‘åŸç”Ÿç¯å¢ƒæœ¬åœ°é›†æˆã€‚&lt;br&gt;
è‡³äºCEPHï¼Œå®˜ç½‘åœ¨è¿™ï¼šhttps://ceph.com/&lt;br&gt;
cephå®˜æ–¹æä¾›çš„helméƒ¨ç½²ï¼Œè‡³ä»Šæˆ‘æ²¡æˆåŠŸè¿‡ï¼Œæ‰€ä»¥è½¬å‘ä½¿ç”¨rookæä¾›çš„æ–¹æ¡ˆ&lt;br&gt;
æœ‰é“ç¬”è®°åŸæ–‡ï¼šhttp://note.youdao.com/noteshare?id=281719f1f0374f787effc90067e0d5ad&amp;amp;sub=0B59EA339D4A4769B55F008D72C1A4C0&lt;/p&gt;
&lt;h1 id=&#34;ç¯å¢ƒ&#34;&gt;ç¯å¢ƒ&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;centos 7.5
kernel 4.18.7-1.el7.elrepo.x86_64
docker 18.06
kubernetes v1.12.2
    kubeadméƒ¨ç½²ï¼š
        ç½‘ç»œ: canal
        DNS: coredns
    é›†ç¾¤æˆå‘˜ï¼š    
    192.168.1.1 kube-master
    192.168.1.2 kube-node1
    192.168.1.3 kube-node2
    192.168.1.4 kube-node3
    192.168.1.5 kube-node4

æ‰€æœ‰nodeèŠ‚ç‚¹å‡†å¤‡ä¸€å—200Gçš„ç£ç›˜ï¼š/dev/sdb
kubernetesæ­å»ºrook-ceph
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;http://lvelvis.github.io/post-images/1588233297037.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;å‡†å¤‡å·¥ä½œ&#34;&gt;å‡†å¤‡å·¥ä½œ&lt;/h1&gt;
&lt;p&gt;æ‰€æœ‰èŠ‚ç‚¹å¼€å¯ip_forward&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cat &amp;lt;&amp;lt;EOF &amp;gt;  /etc/sysctl.d/ceph.conf
net.ipv4.ip_forward = 1
net.bridge.bridge-nf-call-ip6tables = 1
net.bridge.bridge-nf-call-iptables = 1
EOF
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;sysctl -p&lt;/p&gt;
&lt;h1 id=&#34;å¼€å§‹éƒ¨ç½²operator&#34;&gt;å¼€å§‹éƒ¨ç½²Operator&lt;/h1&gt;
&lt;h2 id=&#34;éƒ¨ç½²rook-operator&#34;&gt;éƒ¨ç½²Rook Operator&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;cd $HOME
git clone https://github.com/rook/rook.git

cd rook
cd cluster/examples/kubernetes/ceph
kubectl apply -f operator.yaml
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;http://lvelvis.github.io/post-images/1588233371696.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;æŸ¥çœ‹operatorçš„çŠ¶æ€&#34;&gt;æŸ¥çœ‹Operatorçš„çŠ¶æ€&lt;/h2&gt;
&lt;p&gt;æ‰§è¡Œapplyä¹‹åç¨ç­‰ä¸€ä¼š&lt;br&gt;
operatorä¼šåœ¨é›†ç¾¤å†…çš„æ¯ä¸ªä¸»æœºåˆ›å»ºä¸¤ä¸ªpod:rook-discover,rook-ceph-agent&lt;/p&gt;
&lt;p&gt;kubectl -n rook-ceph-system get pod -o wide&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588233523024.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;ç»™èŠ‚ç‚¹æ‰“æ ‡ç­¾&#34;&gt;ç»™èŠ‚ç‚¹æ‰“æ ‡ç­¾&lt;/h2&gt;
&lt;p&gt;è¿è¡Œceph-monçš„èŠ‚ç‚¹æ‰“ä¸Šï¼šceph-mon=enabled&lt;br&gt;
kubectl label nodes {kube-node1,kube-node2,kube-node3} ceph-mon=enabled&lt;br&gt;
è¿è¡Œceph-osdçš„èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯å­˜å‚¨èŠ‚ç‚¹ï¼Œæ‰“ä¸Šï¼šceph-osd=enabled&lt;br&gt;
kubectl label nodes {kube-node1,kube-node2,kube-node3} ceph-osd=enabled&lt;br&gt;
è¿è¡Œceph-mgrçš„èŠ‚ç‚¹ï¼Œæ‰“ä¸Šï¼šceph-mgr=enabled&lt;br&gt;
mgråªèƒ½æ”¯æŒä¸€ä¸ªèŠ‚ç‚¹è¿è¡Œï¼Œè¿™æ˜¯cephè·‘k8sé‡Œçš„å±€é™&lt;br&gt;
kubectl label nodes kube-node1 ceph-mgr=enabled&lt;/p&gt;
&lt;h2 id=&#34;é…ç½®clusteryamlæ–‡ä»¶&#34;&gt;é…ç½®cluster.yamlæ–‡ä»¶&lt;/h2&gt;
&lt;p&gt;å®˜æ–¹é…ç½®æ–‡ä»¶è¯¦è§£ï¼šhttps://rook.io/docs/rook/v0.8/ceph-cluster-crd.html&lt;br&gt;
æ–‡ä»¶ä¸­æœ‰å‡ ä¸ªåœ°æ–¹è¦æ³¨æ„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;dataDirHostPath: è¿™ä¸ªè·¯å¾„æ˜¯ä¼šåœ¨å®¿ä¸»æœºä¸Šç”Ÿæˆçš„ï¼Œä¿å­˜çš„æ˜¯cephçš„ç›¸å…³çš„é…ç½®æ–‡ä»¶ï¼Œå†é‡æ–°ç”Ÿæˆ*é›†ç¾¤çš„æ—¶å€™è¦ç¡®ä¿è¿™ä¸ªç›®å½•ä¸ºç©ºï¼Œå¦åˆ™monä¼šæ— æ³•å¯åŠ¨&lt;/li&gt;
&lt;li&gt;useAllDevices: ä½¿ç”¨æ‰€æœ‰çš„è®¾å¤‡ï¼Œå»ºè®®ä¸ºfalseï¼Œå¦åˆ™ä¼šæŠŠå®¿ä¸»æœºæ‰€æœ‰å¯ç”¨çš„ç£ç›˜éƒ½å¹²æ‰&lt;/li&gt;
&lt;li&gt;useAllNodesï¼šä½¿ç”¨æ‰€æœ‰çš„nodeèŠ‚ç‚¹ï¼Œå»ºè®®ä¸ºfalseï¼Œè‚¯å®šä¸ä¼šç”¨k8sé›†ç¾¤å†…çš„æ‰€æœ‰nodeæ¥æ­å»ºcephçš„&lt;/li&gt;
&lt;li&gt;databaseSizeMBå’ŒjournalSizeMBï¼šå½“ç£ç›˜å¤§äº100Gçš„æ—¶å€™ï¼Œå°±æ³¨é‡Šè¿™ä¿©é¡¹å°±è¡Œäº†&lt;br&gt;
æœ¬æ¬¡å®éªŒç”¨åˆ°çš„ cluster.yaml æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: v1
kind: Namespace
metadata:
  name: rook-ceph
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: rook-ceph-cluster
  namespace: rook-ceph
---
kind: Role
apiVersion: rbac.authorization.k8s.io/v1beta1
metadata:
  name: rook-ceph-cluster
  namespace: rook-ceph
rules:
- apiGroups: [&amp;quot;&amp;quot;]
  resources: [&amp;quot;configmaps&amp;quot;]
  verbs: [ &amp;quot;get&amp;quot;, &amp;quot;list&amp;quot;, &amp;quot;watch&amp;quot;, &amp;quot;create&amp;quot;, &amp;quot;update&amp;quot;, &amp;quot;delete&amp;quot; ]
---
# Allow the operator to create resources in this cluster&#39;s namespace
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1beta1
metadata:
  name: rook-ceph-cluster-mgmt
  namespace: rook-ceph
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: rook-ceph-cluster-mgmt
subjects:
- kind: ServiceAccount
  name: rook-ceph-system
  namespace: rook-ceph-system
---
# Allow the pods in this namespace to work with configmaps
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1beta1
metadata:
  name: rook-ceph-cluster
  namespace: rook-ceph
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: rook-ceph-cluster
subjects:
- kind: ServiceAccount
  name: rook-ceph-cluster
  namespace: rook-ceph
---
apiVersion: ceph.rook.io/v1beta1
kind: Cluster
metadata:
  name: rook-ceph
  namespace: rook-ceph
spec:
  cephVersion:
    # The container image used to launch the Ceph daemon pods (mon, mgr, osd, mds, rgw).
    # v12 is luminous, v13 is mimic, and v14 is nautilus.
    # RECOMMENDATION: In production, use a specific version tag instead of the general v13 flag, which pulls the latest release and could result in different
    # versions running within the cluster. See tags available at https://hub.docker.com/r/ceph/ceph/tags/.
    image: ceph/ceph:v13
    # Whether to allow unsupported versions of Ceph. Currently only luminous and mimic are supported.
    # After nautilus is released, Rook will be updated to support nautilus.
    # Do not set to true in production.
    allowUnsupported: false
  # The path on the host where configuration files will be persisted. If not specified, a kubernetes emptyDir will be created (not recommended).
  # Important: if you reinstall the cluster, make sure you delete this directory from each host or else the mons will fail to start on the new cluster.
  # In Minikube, the &#39;/data&#39; directory is configured to persist across reboots. Use &amp;quot;/data/rook&amp;quot; in Minikube environment.
  dataDirHostPath: /var/lib/rook
  # The service account under which to run the daemon pods in this cluster if the default account is not sufficient (OSDs)
  serviceAccount: rook-ceph-cluster
  # set the amount of mons to be started
  # countå¯ä»¥å®šä¹‰ceph-monè¿è¡Œçš„æ•°é‡ï¼Œè¿™é‡Œé»˜è®¤ä¸‰ä¸ªå°±è¡Œäº†
  mon:
    count: 3
    allowMultiplePerNode: true
  # enable the ceph dashboard for viewing cluster status
  # å¼€å¯cephèµ„æºé¢æ¿
  dashboard:
    enabled: true
    # serve the dashboard under a subpath (useful when you are accessing the dashboard via a reverse proxy)
    # urlPrefix: /ceph-dashboard
  network:
    # toggle to use hostNetwork
    # ä½¿ç”¨å®¿ä¸»æœºçš„ç½‘ç»œè¿›è¡Œé€šè®¯
    # ä½¿ç”¨å®¿ä¸»æœºçš„ç½‘ç»œè²Œä¼¼å¯ä»¥è®©é›†ç¾¤å¤–çš„ä¸»æœºæŒ‚è½½ceph
    # ä½†æ˜¯æˆ‘æ²¡è¯•è¿‡ï¼Œæœ‰å…´è¶£çš„å…„å¼Ÿå¯ä»¥è¯•è¯•æ”¹æˆtrue
    # åæ­£è¿™é‡Œåªæ˜¯é›†ç¾¤å†…ç”¨ï¼Œæˆ‘å°±ä¸æ”¹äº†
    hostNetwork: false
  # To control where various services will be scheduled by kubernetes, use the placement configuration sections below.
  # The example under &#39;all&#39; would have all services scheduled on kubernetes nodes labeled with &#39;role=storage-node&#39; and
  # tolerate taints with a key of &#39;storage-node&#39;.
  placement:
#    all:
#      nodeAffinity:
#        requiredDuringSchedulingIgnoredDuringExecution:
#          nodeSelectorTerms:
#          - matchExpressions:
#            - key: role
#              operator: In
#              values:
#              - storage-node
#      podAffinity:
#      podAntiAffinity:
#      tolerations:
#      - key: storage-node
#        operator: Exists
# The above placement information can also be specified for mon, osd, and mgr components
#    mon:
#    osd:
#    mgr:
# nodeAffinityï¼šé€šè¿‡é€‰æ‹©æ ‡ç­¾çš„æ–¹å¼ï¼Œå¯ä»¥é™åˆ¶podè¢«è°ƒåº¦åˆ°ç‰¹å®šçš„èŠ‚ç‚¹ä¸Š
# å»ºè®®é™åˆ¶ä¸€ä¸‹ï¼Œä¸ºäº†è®©è¿™å‡ ä¸ªpodä¸ä¹±è·‘
    mon:
      nodeAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
          nodeSelectorTerms:
          - matchExpressions:
            - key: ceph-mon
              operator: In
              values:
              - enabled
    osd:
      nodeAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
          nodeSelectorTerms:
          - matchExpressions:
            - key: ceph-osd
              operator: In
              values:
              - enabled
    mgr:
      nodeAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
          nodeSelectorTerms:
          - matchExpressions:
            - key: ceph-mgr
              operator: In
              values:
              - enabled
  resources:
# The requests and limits set here, allow the mgr pod to use half of one CPU core and 1 gigabyte of memory
#    mgr:
#      limits:
#        cpu: &amp;quot;500m&amp;quot;
#        memory: &amp;quot;1024Mi&amp;quot;
#      requests:
#        cpu: &amp;quot;500m&amp;quot;
#        memory: &amp;quot;1024Mi&amp;quot;
# The above example requests/limits can also be added to the mon and osd components
#    mon:
#    osd:
  storage: # cluster level storage configuration and selection
    useAllNodes: false
    useAllDevices: false
    deviceFilter:
    location:
    config:
      # The default and recommended storeType is dynamically set to bluestore for devices and filestore for directories.
      # Set the storeType explicitly only if it is required not to use the default.
      # storeType: bluestore
      # databaseSizeMB: &amp;quot;1024&amp;quot; # this value can be removed for environments with normal sized disks (100 GB or larger)
      # journalSizeMB: &amp;quot;1024&amp;quot;  # this value can be removed for environments with normal sized disks (20 GB or larger)
# Cluster level list of directories to use for storage. These values will be set for all nodes that have no `directories` set.
#    directories:
#    - path: /rook/storage-dir
# Individual nodes and their config can be specified as well, but &#39;useAllNodes&#39; above must be set to false. Then, only the named
# nodes below will be used as storage resources.  Each node&#39;s &#39;name&#39; field should match their &#39;kubernetes.io/hostname&#39; label.
#å»ºè®®ç£ç›˜é…ç½®æ–¹å¼å¦‚ä¸‹ï¼š
#name: é€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹åå­—ä¸ºkubernetes.io/hostnameçš„æ ‡ç­¾ï¼Œä¹Ÿå°±æ˜¯kubectl get nodesçœ‹åˆ°çš„åå­—
#devices: é€‰æ‹©ç£ç›˜è®¾ç½®ä¸ºOSD
# - name: &amp;quot;sdb&amp;quot;:å°†/dev/sdbè®¾ç½®ä¸ºosd
    nodes:
    - name: &amp;quot;kube-node1&amp;quot;
      devices:
      - name: &amp;quot;sdb&amp;quot;
    - name: &amp;quot;kube-node2&amp;quot;
      devices:
      - name: &amp;quot;sdb&amp;quot;
    - name: &amp;quot;kube-node3&amp;quot;
      devices:
      - name: &amp;quot;sdb&amp;quot;

#      directories: # specific directories to use for storage can be specified for each node
#      - path: &amp;quot;/rook/storage-dir&amp;quot;
#      resources:
#        limits:
#          cpu: &amp;quot;500m&amp;quot;
#          memory: &amp;quot;1024Mi&amp;quot;
#        requests:
#          cpu: &amp;quot;500m&amp;quot;
#          memory: &amp;quot;1024Mi&amp;quot;
#    - name: &amp;quot;172.17.4.201&amp;quot;
#      devices: # specific devices to use for storage can be specified for each node
#      - name: &amp;quot;sdb&amp;quot;
#      - name: &amp;quot;sdc&amp;quot;
#      config: # configuration can be specified at the node level which overrides the cluster level config
#        storeType: filestore
#    - name: &amp;quot;172.17.4.301&amp;quot;
#      deviceFilter: &amp;quot;^sd.&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;å¼€å§‹éƒ¨ç½²ceph&#34;&gt;å¼€å§‹éƒ¨ç½²ceph&lt;/h2&gt;
&lt;p&gt;éƒ¨ç½²ceph&lt;br&gt;
kubectl apply -f cluster.yaml&lt;br&gt;
clusterä¼šåœ¨rook-cephè¿™ä¸ªnamesapceåˆ›å»ºèµ„æº&lt;br&gt;
çœ‹åˆ°æ‰€æœ‰çš„podéƒ½Runningå°±è¡Œäº†&lt;br&gt;
æ³¨æ„çœ‹ä¸€ä¸‹podåˆ†å¸ƒçš„å®¿ä¸»æœºï¼Œè·Ÿæˆ‘ä»¬æ‰“æ ‡ç­¾çš„ä¸»æœºæ˜¯ä¸€è‡´çš„&lt;br&gt;
kubectl -n rook-ceph get pod -o wide&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588233756856.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;åˆ‡æ¢åˆ°å…¶ä»–ä¸»æœºçœ‹ä¸€ä¸‹ç£ç›˜&lt;/p&gt;
&lt;p&gt;åˆ‡æ¢åˆ°kube-node1&lt;br&gt;
lsblk&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588233803458.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;é…ç½®ceph-dashboard&#34;&gt;é…ç½®ceph dashboard&lt;/h2&gt;
&lt;p&gt;çœ‹ä¸€çœ¼dashboardåœ¨å“ªä¸ªserviceä¸Š&lt;br&gt;
kubectl -n rook-ceph get service&lt;br&gt;
å¯ä»¥çœ‹åˆ°dashboardç›‘å¬äº†8443ç«¯å£&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588233853544.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;åˆ›å»ºä¸ªnodeportç±»å‹çš„serviceä»¥ä¾¿é›†ç¾¤å¤–éƒ¨è®¿é—®&lt;br&gt;
kubectl apply -f dashboard-external-https.yaml&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹ä¸€ä¸‹nodeportåœ¨å“ªä¸ªç«¯å£&lt;br&gt;
kubectl -n rook-ceph get service&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588233909644.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ‰¾å‡ºDashboardçš„ç™»é™†è´¦å·å’Œå¯†ç &lt;br&gt;
MGR_POD=&lt;code&gt;kubectl get pod -n rook-ceph | grep mgr | awk &#39;{print $1}&#39;&lt;/code&gt;&lt;br&gt;
kubectl -n rook-ceph logs $MGR_POD | grep password&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588233955731.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ‰“å¼€æµè§ˆå™¨è¾“å…¥ä»»æ„ä¸€ä¸ªNodeçš„IP+nodeportç«¯å£&lt;br&gt;
è¿™é‡Œæˆ‘çš„å°±æ˜¯ï¼šhttps://192.168.1.2:30290&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588234024005.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588234065656.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;é…ç½®cephä¸ºstorageclass&#34;&gt;é…ç½®cephä¸ºstorageclass&lt;/h2&gt;
&lt;p&gt;å®˜æ–¹ç»™äº†ä¸€ä¸ªæ ·æœ¬æ–‡ä»¶ï¼šstorageclass.yaml&lt;br&gt;
è¿™ä¸ªæ–‡ä»¶ä½¿ç”¨çš„æ˜¯ RBD å—å­˜å‚¨&lt;br&gt;
poolåˆ›å»ºè¯¦è§£ï¼šhttps://rook.io/docs/rook/v0.8/ceph-pool-crd.html&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apiVersion: ceph.rook.io/v1beta1
kind: Pool
metadata:
  #è¿™ä¸ªnameå°±æ˜¯åˆ›å»ºæˆceph poolä¹‹åçš„poolåå­—
  name: replicapool
  namespace: rook-ceph
spec:
  replicated:
    size: 1
  # size æ± ä¸­æ•°æ®çš„å‰¯æœ¬æ•°,1å°±æ˜¯ä¸ä¿å­˜ä»»ä½•å‰¯æœ¬
  failureDomain: osd
  #  failureDomainï¼šæ•°æ®å—çš„æ•…éšœåŸŸï¼Œ
  #  å€¼ä¸ºhostæ—¶ï¼Œæ¯ä¸ªæ•°æ®å—å°†æ”¾ç½®åœ¨ä¸åŒçš„ä¸»æœºä¸Š
  #  å€¼ä¸ºosdæ—¶ï¼Œæ¯ä¸ªæ•°æ®å—å°†æ”¾ç½®åœ¨ä¸åŒçš„osdä¸Š
---
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
   name: ceph
   # StorageClassçš„åå­—ï¼Œpvcè°ƒç”¨æ—¶å¡«çš„åå­—
provisioner: ceph.rook.io/block
parameters:
  pool: replicapool
  # Specify the namespace of the rook cluster from which to create volumes.
  # If not specified, it will use `rook` as the default namespace of the cluster.
  # This is also the namespace where the cluster will be
  clusterNamespace: rook-ceph
  # Specify the filesystem type of the volume. If not specified, it will use `ext4`.
  fstype: xfs
# è®¾ç½®å›æ”¶ç­–ç•¥é»˜è®¤ä¸ºï¼šRetain
reclaimPolicy: Retain
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;åˆ›å»ºstorageclass&#34;&gt;åˆ›å»ºStorageClass&lt;/h2&gt;
&lt;p&gt;kubectl apply -f storageclass.yaml&lt;br&gt;
kubectl get storageclasses.storage.k8s.io  -n rook-ceph&lt;br&gt;
kubectl describe storageclasses.storage.k8s.io  -n rook-ceph&lt;br&gt;
kubernetesæ­å»ºrook-ceph&lt;/p&gt;
&lt;p&gt;åˆ›å»ºä¸ªnginx podå°è¯•æŒ‚è½½&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cat &amp;lt;&amp;lt; EOF &amp;gt; nginx.yaml
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: nginx-pvc
spec:
  accessModes:
    - ReadWriteMany
  resources:
    requests:
      storage: 1Gi
  storageClassName: ceph

---
apiVersion: v1
kind: Service
metadata:
  name: nginx
spec:
  selector:
    app: nginx
  ports: 
  - port: 80
    name: nginx-port
    targetPort: 80
    protocol: TCP

---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx
spec:
  replicas: 1
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      name: nginx
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx
        ports:
        - containerPort: 80
        volumeMounts:
        - mountPath: /html
          name: http-file
      volumes:
      - name: http-file
        persistentVolumeClaim:
          claimName: nginx-pvc
EOF
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;kubectl apply -f nginx.yaml&lt;br&gt;
æŸ¥çœ‹pv,pvcæ˜¯å¦åˆ›å»ºäº†&lt;br&gt;
kubectl get pv,pvc&lt;/p&gt;
&lt;p&gt;çœ‹ä¸€ä¸‹nginxè¿™ä¸ªpodä¹Ÿè¿è¡Œäº†&lt;br&gt;
kubectl get pod&lt;/p&gt;
&lt;p&gt;åˆ é™¤è¿™ä¸ªpod,çœ‹pvæ˜¯å¦è¿˜å­˜åœ¨&lt;br&gt;
kubectl delete -f nginx.yaml&lt;/p&gt;
&lt;p&gt;kubectl get pv,pvc&lt;br&gt;
å¯ä»¥çœ‹åˆ°ï¼Œpodå’Œpvcéƒ½å·²ç»è¢«åˆ é™¤äº†ï¼Œä½†æ˜¯pvè¿˜åœ¨ï¼ï¼ï¼&lt;/p&gt;
&lt;h2 id=&#34;æ·»åŠ æ–°èŠ‚ç‚¹è¿›å…¥é›†ç¾¤&#34;&gt;æ·»åŠ æ–°èŠ‚ç‚¹è¿›å…¥é›†ç¾¤&lt;/h2&gt;
&lt;p&gt;è¿™æ¬¡æˆ‘ä»¬è¦æŠŠnode4æ·»åŠ è¿›é›†ç¾¤ï¼Œå…ˆæ‰“æ ‡ç­¾&lt;br&gt;
kubectl label nodes kube-node4 ceph-osd=enabled&lt;br&gt;
é‡æ–°ç¼–è¾‘cluster.yamlæ–‡ä»¶&lt;br&gt;
åŸæ¥çš„åŸºç¡€ä¸Šæ·»åŠ node4çš„ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;cd $HOME/rook/cluster/examples/kubernetes/ceph/&lt;br&gt;
vi cluster.yam&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588234207475.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;applyä¸€ä¸‹cluster.yamlæ–‡ä»¶&lt;br&gt;
kubectl apply -f cluster.yaml&lt;/p&gt;
&lt;p&gt;ç›¯ç€rook-cephåç§°ç©ºé—´,é›†ç¾¤ä¼šè‡ªåŠ¨æ·»åŠ node4è¿›æ¥&lt;br&gt;
kubectl -n rook-ceph get pod -o wide -w&lt;br&gt;
kubectl -n rook-ceph get pod -o wide&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588234283568.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588234307875.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å»node4èŠ‚ç‚¹çœ‹ä¸€ä¸‹ç£ç›˜&lt;br&gt;
lsblk&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588234334204.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹&#34;&gt;åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹&lt;/h2&gt;
&lt;p&gt;å»æ‰node3çš„æ ‡ç­¾&lt;br&gt;
kubectl label nodes kube-node3 ceph-osd-&lt;br&gt;
é‡æ–°ç¼–è¾‘cluster.yamlæ–‡ä»¶&lt;br&gt;
åˆ é™¤node3çš„ä¿¡æ¯&lt;br&gt;
cd $HOME/rook/cluster/examples/kubernetes/ceph/&lt;br&gt;
vi cluster.yam&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588234380826.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;applyä¸€ä¸‹cluster.yamlæ–‡ä»¶&lt;br&gt;
kubectl apply -f cluster.yaml&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588234493936.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;kubectl -n rook-ceph get pod -o wide&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588234548709.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;http://lvelvis.github.io/post-images/1588234579591.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æœ€åè®°å¾—åˆ é™¤å®¿ä¸»æœºçš„/var/lib/rookæ–‡ä»¶å¤¹&lt;/p&gt;
">kubernetesæ­å»ºrook-ceph</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="http://lvelvis.github.io/post/about/"" data-c="
          &lt;blockquote&gt;
&lt;p&gt;æ¬¢è¿æ¥åˆ°æˆ‘çš„å°ç«™å‘€ï¼Œå¾ˆé«˜å…´é‡è§ä½ ï¼ğŸ¤&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;å…³äºæœ¬ç«™&#34;&gt;ğŸ  å…³äºæœ¬ç«™&lt;/h2&gt;
&lt;p&gt;è®°å½•å¹³æ—¶è¿ç»´ç›¸å…³çš„æŠ€æœ¯:&lt;br&gt;
1.ç½‘ç»œ&lt;br&gt;
2.ç³»ç»Ÿ&lt;br&gt;
3.è™šæ‹ŸåŒ–&lt;br&gt;
4.æ•°æ®åº“&lt;br&gt;
5.ä¸­é—´ä»¶&lt;br&gt;
...&lt;/p&gt;
&lt;h2 id=&#34;åšä¸»æ˜¯è°&#34;&gt;ğŸ‘¨â€ğŸ’» åšä¸»æ˜¯è°&lt;/h2&gt;
&lt;p&gt;ç›®å‰åœ¨èŒäºå·¨äººç½‘ç»œ&lt;/p&gt;
&lt;h2 id=&#34;å…´è¶£çˆ±å¥½&#34;&gt;â›¹ å…´è¶£çˆ±å¥½&lt;/h2&gt;
&lt;p&gt;ç•ªå‰§ FPSå°„å‡»æ¸¸æˆ dota&lt;/p&gt;
&lt;h2 id=&#34;è”ç³»æˆ‘å‘€&#34;&gt;ğŸ“¬ è”ç³»æˆ‘å‘€&lt;/h2&gt;
">å…³äº</a>
      </div>
      
    </div>
  </div>
</div>
<script>
  // var escape = "[{&#34;content&#34;:&#34;&lt;p&gt;åœ¨beegoä¸­ä½¿ç”¨zapç®¡ç†æ—¥å¿—ï¼Œå¾ˆæ–¹ä¾¿ğŸ‘&lt;br&gt;\néœ€è¦åœ¨conf/app.confå®šä¹‰å‡ ä¸ªå‚æ•°&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;appname = web-terminal\nhttpport = &amp;quot;9600&amp;quot;\n\nrunmode = &amp;quot;prod&amp;quot;\nLogLevel = &amp;quot;info&amp;quot;\nautorender = true\nrecoverpanic = false\ncopyrequestbody = true\nviewspath = &amp;quot;static&amp;quot;\nLogPath = &amp;quot;logs/k8s-websocket.log&amp;quot;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;logger.go&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;package controllers\n\nimport (\n\t&amp;quot;os&amp;quot;\n\n\t&amp;quot;github.com/astaxie/beego&amp;quot;\n\t&amp;quot;github.com/natefinch/lumberjack&amp;quot;\n\t&amp;quot;go.uber.org/zap&amp;quot;\n\t&amp;quot;go.uber.org/zap/zapcore&amp;quot;\n)\n\n//MyLoggeråˆå§‹åŒ–zaploggeræ—¥å¿—åº“\nvar MyLogger *zap.Logger\n\nfunc initLogger(logpath string, loglevel string) *zap.Logger {\n\n\t// è®¾ç½®æ—¥å¿—çº§åˆ«\n\tvar level zapcore.Level\n\tswitch loglevel {\n\tcase &amp;quot;debug&amp;quot;:\n\t\tlevel = zap.DebugLevel\n\tcase &amp;quot;info&amp;quot;:\n\t\tlevel = zap.InfoLevel\n\tcase &amp;quot;error&amp;quot;:\n\t\tlevel = zap.ErrorLevel\n\tdefault:\n\t\tlevel = zap.InfoLevel\n\t}\n\n\thook := lumberjack.Logger{\n\t\tFilename:   logpath, // æ—¥å¿—æ–‡ä»¶è·¯å¾„\n\t\tMaxSize:    20,      // æ¯ä¸ªæ—¥å¿—æ–‡ä»¶ä¿å­˜çš„æœ€å¤§å°ºå¯¸ å•ä½ï¼šM\n\t\tMaxBackups: 10,      // æ—¥å¿—æ–‡ä»¶æœ€å¤šä¿å­˜å¤šå°‘ä¸ªå¤‡ä»½\n\t\tMaxAge:     7,       // æ–‡ä»¶æœ€å¤šä¿å­˜å¤šå°‘å¤©\n\t\tCompress:   true,    // æ˜¯å¦å‹ç¼©\n\t}\n\n\tencoderConfig := zapcore.EncoderConfig{\n\t\tTimeKey:        &amp;quot;time&amp;quot;,\n\t\tLevelKey:       &amp;quot;level&amp;quot;,\n\t\tNameKey:        &amp;quot;logger&amp;quot;,\n\t\tCallerKey:      &amp;quot;linenum&amp;quot;,\n\t\tMessageKey:     &amp;quot;msg&amp;quot;,\n\t\tStacktraceKey:  &amp;quot;stacktrace&amp;quot;,\n\t\tLineEnding:     zapcore.DefaultLineEnding,\n\t\tEncodeLevel:    zapcore.LowercaseLevelEncoder,  // å°å†™ç¼–ç å™¨\n\t\tEncodeTime:     zapcore.ISO8601TimeEncoder,     // ISO8601 UTC æ—¶é—´æ ¼å¼\n\t\tEncodeDuration: zapcore.SecondsDurationEncoder, //\n\t\tEncodeCaller:   zapcore.ShortCallerEncoder,     // çŸ­è·¯å¾„ç¼–ç å™¨\n\t\tEncodeName:     zapcore.FullNameEncoder,\n\t}\n\n\tcore := zapcore.NewCore(\n\t\tzapcore.NewJSONEncoder(encoderConfig),                                           // ç¼–ç å™¨é…ç½®\n\t\tzapcore.NewMultiWriteSyncer(zapcore.AddSync(os.Stdout), zapcore.AddSync(&amp;amp;hook)), // æ‰“å°åˆ°æ§åˆ¶å°å’Œæ–‡ä»¶\n\t\tlevel, // æ—¥å¿—çº§åˆ«\n\t)\n\n\t// å¼€å¯å¼€å‘æ¨¡å¼ï¼Œå †æ ˆè·Ÿè¸ª\n\tcaller := zap.AddCaller()\n\t// å¼€å¯æ–‡ä»¶åŠè¡Œå·\n\tdevelopment := zap.Development()\n\n\t// è®¾ç½®åˆå§‹åŒ–å­—æ®µ\n\tfiled := zap.Fields(zap.String(&amp;quot;serviceName&amp;quot;, &amp;quot;k8s-websocket-dashboard&amp;quot;))\n\t// æ„é€ æ—¥å¿—\n\tlogger := zap.New(core, caller, development, filed)\n\n\tlogger.Info(&amp;quot;initlog åˆå§‹åŒ–æˆåŠŸ&amp;quot;)\n\treturn logger\n}\n\n// åˆå§‹åŒ–æ—¥å¿—\nfunc init() {\n\tlogPath := beego.AppConfig.String(&amp;quot;LogPath&amp;quot;)\n\tloglevel := beego.AppConfig.String(&amp;quot;LogLevel&amp;quot;)\n\tMyLogger = initLogger(logPath, loglevel)\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;æ—¥å¿—è¾“å‡ºï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;{&amp;quot;level&amp;quot;:&amp;quot;info&amp;quot;,&amp;quot;time&amp;quot;:&amp;quot;2020-06-02T19:41:37.799+0800&amp;quot;,&amp;quot;linenum&amp;quot;:&amp;quot;controllers/logger.go:59&amp;quot;,&amp;quot;msg&amp;quot;:&amp;quot;log åˆå§‹åŒ–æˆåŠŸ&amp;quot;,&amp;quot;serviceName&amp;quot;:&amp;quot;k8s-websocket-dashboard&amp;quot;}\n&lt;/code&gt;&lt;/pre&gt;\n&#34;,&#34;fileName&#34;:&#34;golang-bi-ji-zip-ri-zhi-shi-yong&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;golangç¬”è®°-zipæ—¥å¿—ä½¿ç”¨&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;zap&#34;,&#34;slug&#34;:&#34;t0_qVBCTZ&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/t0_qVBCTZ/&#34;},{&#34;index&#34;:-1,&#34;name&#34;:&#34;golang&#34;,&#34;slug&#34;:&#34;oHQV9cP9p&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/oHQV9cP9p/&#34;},{&#34;name&#34;:&#34;beego&#34;,&#34;slug&#34;:&#34;WCSltmB8m&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/WCSltmB8m/&#34;}],&#34;date&#34;:&#34;2020-06-03 14:17:23&#34;,&#34;dateFormat&#34;:&#34;2020-06-03&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;http://lvelvis.github.io/post/golang-bi-ji-zip-ri-zhi-shi-yong/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;3 min read&#34;,&#34;time&#34;:138000,&#34;words&#34;:444,&#34;minutes&#34;:3},&#34;description&#34;:&#34;åœ¨beegoä¸­ä½¿ç”¨zapç®¡ç†æ—¥å¿—ï¼Œå¾ˆæ–¹ä¾¿ğŸ‘\néœ€è¦åœ¨conf/app.confå®šä¹‰å‡ ä¸ªå‚æ•°\nappname = web-terminal\nhttpport = &amp;quot;9600&amp;quot;\n\nrunmode = &amp;quot;prod&amp;q...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;h1 id=\&#34;è·å–å‚æ•°\&#34;&gt;è·å–å‚æ•°&lt;/h1&gt;\n&lt;p&gt;æˆ‘ä»¬ç»å¸¸éœ€è¦è·å–ç”¨æˆ·ä¼ é€’çš„æ•°æ®ï¼ŒåŒ…æ‹¬Getã€POSTç­‰æ–¹å¼çš„è¯·æ±‚ï¼Œbeegoé‡Œé¢ä¼šè‡ªåŠ¨è§£æè¿™äº›æ•°æ®ï¼Œä½ å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è·å–æ•°æ®ï¼š&lt;/p&gt;\n&lt;p&gt;GetString(key string) string&lt;br&gt;\nGetStrings(key string) []string&lt;br&gt;\nGetInt(key string) (int64, error)&lt;br&gt;\nGetBool(key string) (bool, error)&lt;br&gt;\nGetFloat(key string) (float64, error)&lt;br&gt;\nç¤ºä¾‹1ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;func (this *MainController) Post() {\n    jsoninfo := &amp;lt;strong&amp;gt;this.GetString&amp;lt;/strong&amp;gt;(&amp;quot;jsoninfo&amp;quot;)\n    if jsoninfo == &amp;quot;&amp;quot; {\n        this.Ctx.WriteString(&amp;quot;jsoninfo is empty&amp;quot;)\n        return\n    }\n}```\nå¦‚æœä½ éœ€è¦çš„æ•°æ®å¯èƒ½æ˜¯å…¶å®ƒç±»å‹ï¼Œä¾‹å¦‚æ˜¯intç±»å‹è€Œä¸æ˜¯int64ï¼Œé‚£ä¹ˆä½ éœ€è¦è¿™æ ·å¤„ç†ï¼š\n\nç¤ºä¾‹2ï¼š\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;func (this *MainController) Post() {&lt;br&gt;\nid := &lt;strong&gt;this.Input().Get&lt;/strong&gt;(&amp;quot;id&amp;quot;)&lt;br&gt;\nintid, err := &lt;strong&gt;strconv.Atoi&lt;/strong&gt;(id)&lt;br&gt;\n}```&lt;br&gt;\næ›´å¤šå…¶ä»–çš„requestçš„ä¿¡æ¯ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡this.Ctx.Requestè·å–ä¿¡æ¯ã€‚&lt;/p&gt;\n&lt;p&gt;å…³äºè¯¥å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•å¯å‚è€ƒrequestå®˜æ–¹æ‰‹å†Œhttps://gowalker.org/net/http#Request&lt;/p&gt;\n&lt;h1 id=\&#34;ç›´æ¥è§£æåˆ°struct\&#34;&gt;ç›´æ¥è§£æåˆ°struct&lt;/h1&gt;\n&lt;p&gt;å¦‚æœè¦æŠŠè¡¨å•é‡Œçš„å†…å®¹èµ‹å€¼åˆ°ä¸€ä¸ªstructé‡Œï¼Œé™¤äº†ç”¨ä¸Šé¢çš„æ–¹æ³•ä¸€ä¸ªä¸€ä¸ªè·å–å†èµ‹å€¼ä¹‹å¤–ï¼Œ&lt;br&gt;\nbeegoæä¾›äº†é€šè¿‡å¦å¤–ä¸€ä¸ªæ›´ä¾¿æ·çš„æ–¹å¼ï¼Œå°±æ˜¯é€šè¿‡structçš„å­—æ®µåæˆ–tagä¸è¡¨å•å­—æ®µå¯¹åº”ç›´æ¥è§£æåˆ°structã€‚&lt;/p&gt;\n&lt;p&gt;ç¤ºä¾‹3ï¼š&lt;/p&gt;\n&lt;p&gt;å®šä¹‰struct&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;type user struct {\n    Id    int         `form:&amp;quot;-&amp;quot;`\n    Name  interface{} `form:&amp;quot;&amp;lt;strong&amp;gt;username&amp;lt;/strong&amp;gt;&amp;quot;`\n    Age   int         `form:&amp;quot;&amp;lt;strong&amp;gt;age&amp;lt;/strong&amp;gt;&amp;quot;`\n    Email string\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;è¡¨å•&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;&amp;lt;form id=&amp;quot;&amp;lt;strong&amp;gt;user&amp;lt;/strong&amp;gt;&amp;quot;&amp;gt;\n    åå­—ï¼š&amp;lt;input name=&amp;quot;&amp;lt;strong&amp;gt;username&amp;lt;/strong&amp;gt;&amp;quot; type=&amp;quot;text&amp;quot; /&amp;gt;\n    å¹´é¾„ï¼š&amp;lt;input name=&amp;quot;&amp;lt;strong&amp;gt;age&amp;lt;/strong&amp;gt;&amp;quot; type=&amp;quot;text&amp;quot; /&amp;gt;\n    é‚®ç®±ï¼š&amp;lt;input name=&amp;quot;Email&amp;quot; type=&amp;quot;text&amp;quot; /&amp;gt;\n    &amp;lt;input type=&amp;quot;submit&amp;quot; value=&amp;quot;æäº¤&amp;quot; /&amp;gt;\n&amp;lt;/form&amp;gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;controlleré‡Œè§£æ&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;func (this *MainController) Post() {\n    u := &amp;lt;strong&amp;gt;user{}&amp;lt;/strong&amp;gt;\n    if err := this.ParseForm(&amp;lt;strong&amp;gt;&amp;amp;u&amp;lt;/strong&amp;gt;); err != nil {\n        //handle error\n    }\n}ã€€ã€€\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;éœ€è¦è¯´æ˜çš„æ˜¯ï¼š&lt;/p&gt;\n&lt;p&gt;ï¼ˆ1ï¼‰structTag formçš„å®šä¹‰å’Œrenderformæ–¹æ³•å…±ç”¨ä¸€ä¸ªæ ‡ç­¾ã€‚&lt;/p&gt;\n&lt;p&gt;ï¼ˆ2ï¼‰å®šä¹‰structæ—¶ï¼Œå­—æ®µååå¦‚æœæœ‰formè¿™ä¸ªtagï¼Œåˆ™ä¼šæŠŠformè¡¨å•é‡Œçš„nameå’Œtagçš„åå­—ä¸€æ ·çš„å­—æ®µèµ‹å€¼ç»™è¿™ä¸ªå­—æ®µï¼Œ&lt;/p&gt;\n&lt;p&gt;å¦åˆ™å°±ä¼šæŠŠformè¡¨å•é‡Œä¸å­—æ®µåä¸€æ ·çš„è¡¨å•å†…å®¹èµ‹å€¼ç»™è¿™ä¸ªå­—æ®µã€‚&lt;/p&gt;\n&lt;p&gt;ä¾‹å¦‚ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œä¼šæŠŠè¡¨å•ä¸­çš„usernameå’Œageåˆ†åˆ«èµ‹å€¼ç»™useré‡Œçš„Nameå’ŒAgeå­—æ®µï¼Œè€ŒEmailé‡Œçš„å†…å®¹åˆ™ä¼šèµ‹å€¼ç»™Emailè¿™ä¸ªå­—æ®µã€‚&lt;/p&gt;\n&lt;p&gt;ï¼ˆ3ï¼‰è°ƒç”¨Controller PraseFormè¿™ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œä¼ å…¥çš„å‚æ•°å¿…é¡»ä¸ºä¸€ä¸ªstructçš„æŒ‡é’ˆï¼Œå¦åˆ™å¯¹structçš„èµ‹å€¼ä¸ä¼šæˆåŠŸå¹¶è¿”å›xx must be a struct pointerçš„é”™è¯¯ã€‚&lt;/p&gt;\n&lt;p&gt;ï¼ˆ4ï¼‰å¦‚æœè¦å¿½ç•¥ä¸€ä¸ªå­—æ®µï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€æ˜¯ï¼šå­—æ®µåå°å†™å¼€å¤´ï¼ŒäºŒæ˜¯ï¼šformæ ‡ç­¾è®¾ç½®ä¸º_&lt;/p&gt;\n&lt;h1 id=\&#34;è·å–request-bodyé‡Œçš„å†…å®¹\&#34;&gt;è·å–Request Bodyé‡Œçš„å†…å®¹&lt;/h1&gt;\n&lt;p&gt;åœ¨APIçš„å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šç”¨åˆ°JSONæˆ–XMLæ¥ä½œä¸ºæ•°æ®äº¤äº’çš„æ ¼å¼ï¼Œå¦‚ä½•åœ¨beegoä¸­è·å–Request Bodyé‡Œçš„JSONæˆ–XMLçš„æ•°æ®å‘¢ï¼Ÿ&lt;/p&gt;\n&lt;p&gt;é¦–å…ˆï¼Œåœ¨é…ç½®æ–‡ä»¶é‡Œè®¾ç½®copyrequestbody = true&lt;/p&gt;\n&lt;p&gt;å…¶æ¬¡ï¼Œåœ¨Controllerä¸­ï¼š&lt;/p&gt;\n&lt;p&gt;ç¤ºä¾‹4ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;func (this *ObjectController) Post() {\n    var ob models.Object\n    var err error\n    if err = json.Unmarshal(this.Ctx.Input.RequestBody, &amp;amp;ob); err == nil {\n        objectid := models.AddOne(ob)\n        this.Data[&amp;quot;json&amp;quot;] = &amp;quot;{\\&amp;quot;ObjectId\\&amp;quot;:\\&amp;quot;&amp;quot; + objectid + &amp;quot;\\&amp;quot;}&amp;quot;\n    } else {\n        this.Data[&amp;quot;json&amp;quot;] = err.Error()\n    }\n    this.ServeJSON()\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;\n&lt;h1 id=\&#34;æ–‡ä»¶ä¸Šä¼ \&#34;&gt;æ–‡ä»¶ä¸Šä¼ &lt;/h1&gt;\n&lt;p&gt;åœ¨beegoä¸­ä½ å¯ä»¥å¾ˆå®¹æ˜“çš„å¤„ç†æ–‡ä»¶ä¸Šä¼ ï¼Œå°±æ˜¯åˆ«å¿˜è®°åœ¨ä½ çš„formè¡¨å•ä¸­å¢åŠ â€œenctype=&amp;quot;multipart/form-dataâ€ï¼Œå¦åˆ™ä½ çš„æµè§ˆå™¨ä¸ä¼šä¼ è¾“ä½ çš„ä¸Šä¼ æ–‡ä»¶ã€‚&lt;/p&gt;\n&lt;p&gt;æ–‡ä»¶ä¸Šä¼ ä¹‹åä¸€èˆ¬æ˜¯æ”¾åœ¨ç³»ç»Ÿçš„å†…å­˜é‡Œé¢ï¼Œå¦‚æœæ–‡ä»¶çš„sizeå¤§äºè®¾ç½®çš„ç¼“å­˜å¤§å°ï¼Œé‚£ä¹ˆå°±æ”¾åœ¨ä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œ&lt;/p&gt;\n&lt;p&gt;é»˜è®¤çš„ç¼“å­˜å†…å­˜æ˜¯64Mï¼Œä½ å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼æ¥è°ƒæ•´è¿™ä¸ªç¼“å­˜å†…å­˜çš„å¤§å°ã€‚&lt;/p&gt;\n&lt;p&gt;beego.MaxMemory = 1&amp;lt;&amp;lt;22&lt;br&gt;\næˆ–è€…åœ¨é…ç½®æ–‡ä»¶ä¸­é€šè¿‡å¦‚ä¸‹è®¾ç½®ï¼š&lt;/p&gt;\n&lt;p&gt;maxmemory = 1&amp;lt;&amp;lt;22&lt;br&gt;\nBeegoæä¾›äº†ä¸¤ä¸ªå¾ˆæ–¹ä¾¿çš„æ–¹æ³•æ¥å¤„ç†æ–‡ä»¶ä¸Šä¼ ï¼š&lt;/p&gt;\n&lt;p&gt;ï¼ˆ1ï¼‰GetFile(key string) (multipart.File, *multipart.FileHeader, error)&lt;/p&gt;\n&lt;p&gt;è¯¥æ–¹æ³•ä¸»è¦ç”¨äºç”¨æˆ·è¯»å–è¡¨å•ä¸­çš„æ–‡ä»¶åthe_fileï¼Œç„¶åè¿”å›ç›¸åº”çš„ä¿¡æ¯ï¼Œç”¨æˆ·æ ¹æ®è¿™äº›å˜é‡æ¥å¤„ç†æ–‡ä»¶ä¸Šä¼ ï¼šè¿‡æ»¤ã€ä¿å­˜æ–‡ä»¶ç­‰ã€‚&lt;/p&gt;\n&lt;p&gt;ï¼ˆ2ï¼‰SaveToFile(fromfile, tofile string) error&lt;/p&gt;\n&lt;p&gt;è¯¥æ–¹æ³•æ˜¯åœ¨GetFileçš„åŸºç¡€ä¸Šå®ç°äº†å¿«é€Ÿä¿å­˜çš„åŠŸèƒ½ï¼Œfromfileæ˜¯æäº¤çš„æ—¶å€™htmlè¡¨å•ä¸­çš„nameã€‚&lt;/p&gt;\n&lt;p&gt;ç¤ºä¾‹5&lt;/p&gt;\n&lt;p&gt;è¡¨å•ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;&amp;lt;form enctype=&amp;quot;multipart/form-data&amp;quot; method=&amp;quot;post&amp;quot;&amp;gt;\n    &amp;lt;input type=&amp;quot;file&amp;quot; name=&amp;quot;uploadname&amp;quot; /&amp;gt;\n    &amp;lt;input type=&amp;quot;submit&amp;quot;&amp;gt;\n&amp;lt;/form&amp;gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Controllerä¸­ä»£ç ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;func (c *FormController) Post() {\n    f, h, err := c.GetFile(&amp;quot;uploadname&amp;quot;)\n    if err != nil {\n        log.Fatal(&amp;quot;getfile err &amp;quot;, err)\n    }\n    defer f.Close()\n    c.SaveToFile(&amp;quot;uploadname&amp;quot;, &amp;quot;static/upload/&amp;quot; + h.Filename) // ä¿å­˜ä½ç½®åœ¨ static/upload, æ²¡æœ‰æ–‡ä»¶å¤¹è¦å…ˆåˆ›å»º\n     \n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;æ•°æ®ç»‘å®š\&#34;&gt;æ•°æ®ç»‘å®š&lt;/h1&gt;\n&lt;p&gt;æ”¯æŒä»ç”¨æˆ·è¯·æ±‚ä¸­ç›´æ¥æ•°æ®bindåˆ°æŒ‡å®šçš„å¯¹è±¡ã€‚&lt;/p&gt;\n&lt;p&gt;ç¤ºä¾‹6ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;var id int\nthis.Ctx.Input.Bind(&amp;amp;id, &amp;quot;id&amp;quot;)  //id ==123\n \nvar isok bool\nthis.Ctx.Input.Bind(&amp;amp;isok, &amp;quot;isok&amp;quot;)  //isok ==true\n \nvar ft float64\nthis.Ctx.Input.Bind(&amp;amp;ft, &amp;quot;ft&amp;quot;)  //ft ==1.2\n \nol := make([]int, 0, 2)\nthis.Ctx.Input.Bind(&amp;amp;ol, &amp;quot;ol&amp;quot;)  //ol ==[1 2]\n \nul := make([]string, 0, 2)\nthis.Ctx.Input.Bind(&amp;amp;ul, &amp;quot;ul&amp;quot;)  //ul ==[str array]\n \nuser struct{Name}\nthis.Ctx.Input.Bind(&amp;amp;user, &amp;quot;user&amp;quot;)  //user =={Name:&amp;quot;astaxie&amp;quot;}\n&lt;/code&gt;&lt;/pre&gt;\n&#34;,&#34;fileName&#34;:&#34;golang-bi-ji-beego-huo-qu-url-qing-qiu-de-can-shu&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;golangç¬”è®°-beegoè·å–urlè¯·æ±‚çš„å‚æ•°&#34;,&#34;tags&#34;:[{&#34;index&#34;:-1,&#34;name&#34;:&#34;golang&#34;,&#34;slug&#34;:&#34;oHQV9cP9p&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/oHQV9cP9p/&#34;},{&#34;name&#34;:&#34;beego&#34;,&#34;slug&#34;:&#34;WCSltmB8m&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/WCSltmB8m/&#34;}],&#34;date&#34;:&#34;2020-06-02 12:00:50&#34;,&#34;dateFormat&#34;:&#34;2020-06-02&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;http://lvelvis.github.io/post/golang-bi-ji-beego-huo-qu-url-qing-qiu-de-can-shu/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;6 min read&#34;,&#34;time&#34;:340000,&#34;words&#34;:1252,&#34;minutes&#34;:6},&#34;description&#34;:&#34;è·å–å‚æ•°\næˆ‘ä»¬ç»å¸¸éœ€è¦è·å–ç”¨æˆ·ä¼ é€’çš„æ•°æ®ï¼ŒåŒ…æ‹¬Getã€POSTç­‰æ–¹å¼çš„è¯·æ±‚ï¼Œbeegoé‡Œé¢ä¼šè‡ªåŠ¨è§£æè¿™äº›æ•°æ®ï¼Œä½ å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è·å–æ•°æ®ï¼š\nGetString(key string) string\nGetStrings(key string...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%8E%B7%E5%8F%96%E5%8F%82%E6%95%B0\&#34;&gt;è·å–å‚æ•°&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%9B%B4%E6%8E%A5%E8%A7%A3%E6%9E%90%E5%88%B0struct\&#34;&gt;ç›´æ¥è§£æåˆ°struct&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%8E%B7%E5%8F%96request-body%E9%87%8C%E7%9A%84%E5%86%85%E5%AE%B9\&#34;&gt;è·å–Request Bodyé‡Œçš„å†…å®¹&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0\&#34;&gt;æ–‡ä»¶ä¸Šä¼ &lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A\&#34;&gt;æ•°æ®ç»‘å®š&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;h1 id=\&#34;ç®€ä»‹\&#34;&gt;ç®€ä»‹&lt;/h1&gt;\n&lt;p&gt;Json(Javascript Object Nanotation)æ˜¯ä¸€ç§æ•°æ®äº¤æ¢æ ¼å¼ï¼Œå¸¸ç”¨äºå‰åç«¯æ•°æ®ä¼ è¾“ã€‚ä»»æ„ä¸€ç«¯å°†æ•°æ®è½¬æ¢æˆjson å­—ç¬¦ä¸²ï¼Œå¦ä¸€ç«¯å†å°†è¯¥å­—ç¬¦ä¸²è§£ææˆç›¸åº”çš„æ•°æ®ç»“æ„ï¼Œå¦‚stringç±»å‹ï¼Œstrcutå¯¹è±¡ç­‰ã€‚&lt;/p&gt;\n&lt;p&gt;goè¯­è¨€æœ¬èº«ä¸ºæˆ‘ä»¬æä¾›äº†jsonçš„å·¥å…·åŒ…â€encoding/jsonâ€ã€‚&lt;br&gt;\næ›´å¤šçš„ä½¿ç”¨æ–¹å¼ï¼Œå¯ä»¥å‚è€ƒï¼šhttps://studygolang.com/articles/6742&lt;/p&gt;\n&lt;h1 id=\&#34;å®ç°\&#34;&gt;å®ç°&lt;/h1&gt;\n&lt;p&gt;Json Marshalï¼šå°†æ•°æ®ç¼–ç æˆjsonå­—ç¬¦ä¸²&lt;br&gt;\nçœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;type Stu struct {\n    Name  string `json:&amp;quot;name&amp;quot;`\n    Age   int\n    HIgh  bool\n    sex   string\n    Class *Class `json:&amp;quot;class&amp;quot;`\n}\n\ntype Class struct {\n    Name  string\n    Grade int\n}\n\nfunc main() {\n    //å®ä¾‹åŒ–ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œç”¨äºç”Ÿæˆjsonå­—ç¬¦ä¸²\n    stu := Stu{\n        Name: &amp;quot;å¼ ä¸‰&amp;quot;,\n        Age:  18,\n        HIgh: true,\n        sex:  &amp;quot;ç”·&amp;quot;,\n    }\n\n    //æŒ‡é’ˆå˜é‡\n    cla := new(Class)\n    cla.Name = &amp;quot;1ç­&amp;quot;\n    cla.Grade = 3\n    stu.Class=cla\n\n    //Marshalå¤±è´¥æ—¶err!=nil\n    jsonStu, err := json.Marshal(stu)\n    if err != nil {\n        fmt.Println(&amp;quot;ç”Ÿæˆjsonå­—ç¬¦ä¸²é”™è¯¯&amp;quot;)\n    }\n\n    //jsonStuæ˜¯[]byteç±»å‹ï¼Œè½¬åŒ–æˆstringç±»å‹ä¾¿äºæŸ¥çœ‹\n    fmt.Println(string(jsonStu))\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;ç»“æœï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;{&amp;quot;name&amp;quot;:&amp;quot;å¼ ä¸‰&amp;quot;,&amp;quot;Age&amp;quot;:18,&amp;quot;HIgh&amp;quot;:true,&amp;quot;class&amp;quot;:{&amp;quot;Name&amp;quot;:&amp;quot;1ç­&amp;quot;,&amp;quot;Grade&amp;quot;:3}}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;ä»ç»“æœä¸­å¯ä»¥çœ‹å‡º&lt;/p&gt;\n&lt;p&gt;åªè¦æ˜¯å¯å¯¼å‡ºæˆå‘˜ï¼ˆå˜é‡é¦–å­—æ¯å¤§å†™ï¼‰ï¼Œéƒ½å¯ä»¥è½¬æˆjsonã€‚å› æˆå‘˜å˜é‡sexæ˜¯ä¸å¯å¯¼å‡ºçš„ï¼Œæ•…æ— æ³•è½¬æˆjsonã€‚&lt;/p&gt;\n&lt;p&gt;å¦‚æœå˜é‡æ‰“ä¸Šäº†jsonæ ‡ç­¾ï¼Œå¦‚Nameæ—è¾¹çš„ &lt;code&gt;json:&amp;quot;name&amp;quot;&lt;/code&gt; ï¼Œé‚£ä¹ˆè½¬åŒ–æˆçš„json keyå°±ç”¨è¯¥æ ‡ç­¾â€œnameâ€ï¼Œå¦åˆ™å–å˜é‡åä½œä¸ºkeyï¼Œå¦‚â€œAgeâ€ï¼Œâ€œHIghâ€ã€‚&lt;/p&gt;\n&lt;p&gt;boolç±»å‹ä¹Ÿæ˜¯å¯ä»¥ç›´æ¥è½¬æ¢ä¸ºjsonçš„valueå€¼ã€‚Channelï¼Œ complex ä»¥åŠå‡½æ•°ä¸èƒ½è¢«ç¼–ç jsonå­—ç¬¦ä¸²ã€‚å½“ç„¶ï¼Œå¾ªç¯çš„æ•°æ®ç»“æ„ä¹Ÿä¸è¡Œï¼Œå®ƒä¼šå¯¼è‡´marshalé™·å…¥æ­»å¾ªç¯ã€‚&lt;/p&gt;\n&lt;p&gt;æŒ‡é’ˆå˜é‡ï¼Œç¼–ç æ—¶è‡ªåŠ¨è½¬æ¢ä¸ºå®ƒæ‰€æŒ‡å‘çš„å€¼ï¼Œå¦‚claå˜é‡ã€‚&lt;br&gt;\nï¼ˆå½“ç„¶ï¼Œä¸ä¼ æŒ‡é’ˆï¼ŒStu structçš„æˆå‘˜Classå¦‚æœæ¢æˆClass structç±»å‹ï¼Œæ•ˆæœä¹Ÿæ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚åªä¸è¿‡æŒ‡é’ˆæ›´å¿«ï¼Œä¸”èƒ½èŠ‚çœå†…å­˜ç©ºé—´ã€‚ï¼‰&lt;/p&gt;\n&lt;p&gt;æœ€åï¼Œå¼ºè°ƒä¸€å¥ï¼šjsonç¼–ç æˆå­—ç¬¦ä¸²åå°±æ˜¯çº¯ç²¹çš„å­—ç¬¦ä¸²äº†ã€‚&lt;/p&gt;\n&lt;p&gt;ä¸Šé¢çš„æˆå‘˜å˜é‡éƒ½æ˜¯å·²çŸ¥çš„ç±»å‹ï¼Œåªèƒ½æ¥æ”¶æŒ‡å®šçš„ç±»å‹ï¼Œæ¯”å¦‚stringç±»å‹çš„Nameåªèƒ½èµ‹å€¼stringç±»å‹çš„æ•°æ®ã€‚&lt;br&gt;\nä½†æœ‰æ—¶ä¸ºäº†é€šç”¨æ€§ï¼Œæˆ–ä½¿ä»£ç ç®€æ´ï¼Œæˆ‘ä»¬å¸Œæœ›æœ‰ä¸€ç§ç±»å‹å¯ä»¥æ¥å—å„ç§ç±»å‹çš„æ•°æ®ï¼Œå¹¶è¿›è¡Œjsonç¼–ç ã€‚è¿™å°±ç”¨åˆ°äº†interface{}ç±»å‹ã€‚&lt;/p&gt;\n&lt;p&gt;å‰è¨€ï¼š&lt;br&gt;\ninterface{}ç±»å‹å…¶å®æ˜¯ä¸ªç©ºæ¥å£ï¼Œå³æ²¡æœ‰æ–¹æ³•çš„æ¥å£ã€‚goçš„æ¯ä¸€ç§ç±»å‹éƒ½å®ç°äº†è¯¥æ¥å£ã€‚å› æ­¤ï¼Œä»»ä½•å…¶ä»–ç±»å‹çš„æ•°æ®éƒ½å¯ä»¥èµ‹å€¼ç»™interface{}ç±»å‹ã€‚&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;type Stu struct {\n    Name  interface{} `json:&amp;quot;name&amp;quot;`\n    Age   interface{}\n    HIgh  interface{}\n    sex   interface{}\n    Class interface{} `json:&amp;quot;class&amp;quot;`\n}\n\ntype Class struct {\n    Name  string\n    Grade int\n}\n\nfunc main() {\n    //ä¸å‰é¢çš„ä¾‹å­ä¸€æ ·\n    ......\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;ç»“æœï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;{&amp;quot;name&amp;quot;:&amp;quot;å¼ ä¸‰&amp;quot;,&amp;quot;Age&amp;quot;:18,&amp;quot;HIgh&amp;quot;:true,&amp;quot;class&amp;quot;:{&amp;quot;Name&amp;quot;:&amp;quot;1ç­&amp;quot;,&amp;quot;Grade&amp;quot;:3}}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;ä»ç»“æœä¸­å¯ä»¥çœ‹å‡ºï¼Œæ— è®ºæ˜¯stringï¼Œintï¼Œboolï¼Œè¿˜æ˜¯æŒ‡é’ˆç±»å‹ç­‰ï¼Œéƒ½å¯èµ‹å€¼ç»™interface{}ç±»å‹ï¼Œä¸”æ­£å¸¸ç¼–ç ï¼Œæ•ˆæœä¸å‰é¢çš„ä¾‹å­ä¸€æ ·ã€‚&lt;/p&gt;\n&lt;p&gt;è¡¥å……ï¼š&lt;br&gt;\nåœ¨å®é™…é¡¹ç›®ä¸­ï¼Œç¼–ç æˆjsonä¸²çš„æ•°æ®ç»“æ„ï¼Œå¾€å¾€æ˜¯åˆ‡ç‰‡ç±»å‹ã€‚å¦‚ä¸‹å®šä¹‰äº†ä¸€ä¸ª[]StuReadç±»å‹çš„åˆ‡ç‰‡&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;//æ­£ç¡®ç¤ºèŒƒ\n\n//æ–¹å¼1ï¼šåªå£°æ˜ï¼Œä¸åˆ†é…å†…å­˜\nvar stus1 []*StuRead\n\n//æ–¹å¼2ï¼šåˆ†é…åˆå§‹å€¼ä¸º0çš„å†…å­˜\nstus2 := make([]*StuRead,0)\n\n//é”™è¯¯ç¤ºèŒƒ\n//new()åªèƒ½å®ä¾‹åŒ–ä¸€ä¸ªstructå¯¹è±¡ï¼Œè€Œ[]StuReadæ˜¯åˆ‡ç‰‡ï¼Œä¸æ˜¯å¯¹è±¡\nstus := new([]StuRead)\n\nstu1 := StuRead{æˆå‘˜èµ‹å€¼...}\nstu2 := StuRead{æˆå‘˜èµ‹å€¼...}\n\n//ç”±æ–¹å¼1å’Œ2åˆ›å»ºçš„åˆ‡ç‰‡ï¼Œéƒ½èƒ½æˆåŠŸè¿½åŠ æ•°æ®\n//æ–¹å¼2æœ€å¥½åˆ†é…0é•¿åº¦ï¼Œappendæ—¶ä¼šè‡ªåŠ¨å¢é•¿ã€‚åä¹‹æŒ‡å®šåˆå§‹é•¿åº¦ï¼Œé•¿åº¦ä¸å¤Ÿæ—¶ä¸ä¼šè‡ªåŠ¨å¢é•¿ï¼Œå¯¼è‡´æ•°æ®ä¸¢å¤±\nstus1 := appen(stus1,stu1,stu2)\nstus2 := appen(stus2,stu1,stu2)\n\n//æˆåŠŸç¼–ç \njson1,_ := json.Marshal(stus1)\njson2,_ := json.Marshal(stus2)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;è§£ç æ—¶å®šä¹‰å¯¹åº”çš„åˆ‡ç‰‡æ¥å—å³å¯&lt;/p&gt;\n&lt;p&gt;Json Unmarshalï¼šå°†jsonå­—ç¬¦ä¸²è§£ç åˆ°ç›¸åº”çš„æ•°æ®ç»“æ„&lt;br&gt;\næˆ‘ä»¬å°†ä¸Šé¢çš„ä¾‹å­è¿›è¡Œè§£ç &lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;type StuRead struct {\n    Name  interface{} `json:&amp;quot;name&amp;quot;`\n    Age   interface{}\n    HIgh  interface{}\n    sex   interface{}\n    Class interface{} `json:&amp;quot;class&amp;quot;`\n    Test  interface{}\n}\n\ntype Class struct {\n    Name  string\n    Grade int\n}\n\nfunc main() {\n    //jsonå­—ç¬¦ä¸­çš„&amp;quot;å¼•å·ï¼Œéœ€ç”¨\\è¿›è¡Œè½¬ä¹‰ï¼Œå¦åˆ™ç¼–è¯‘å‡ºé”™\n    //jsonå­—ç¬¦ä¸²æ²¿ç”¨ä¸Šé¢çš„ç»“æœï¼Œä½†å¯¹keyè¿›è¡Œäº†å¤§å°çš„ä¿®æ”¹ï¼Œå¹¶æ·»åŠ äº†sexæ•°æ®\n    data:=&amp;quot;{\\&amp;quot;name\\&amp;quot;:\\&amp;quot;å¼ ä¸‰\\&amp;quot;,\\&amp;quot;Age\\&amp;quot;:18,\\&amp;quot;high\\&amp;quot;:true,\\&amp;quot;sex\\&amp;quot;:\\&amp;quot;ç”·\\&amp;quot;,\\&amp;quot;CLASS\\&amp;quot;:{\\&amp;quot;naME\\&amp;quot;:\\&amp;quot;1ç­\\&amp;quot;,\\&amp;quot;GradE\\&amp;quot;:3}}&amp;quot;\n    str:=[]byte(data)\n\n    //1.Unmarshalçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯jsonå­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ¥å—jsonè§£æçš„æ•°æ®ç»“æ„ã€‚\n    //ç¬¬äºŒä¸ªå‚æ•°å¿…é¡»æ˜¯æŒ‡é’ˆï¼Œå¦åˆ™æ— æ³•æ¥æ”¶è§£æçš„æ•°æ®ï¼Œå¦‚stuä»ä¸ºç©ºå¯¹è±¡StuRead{}\n    //2.å¯ä»¥ç›´æ¥stu:=new(StuRead),æ­¤æ—¶çš„stuè‡ªèº«å°±æ˜¯æŒ‡é’ˆ\n    stu:=StuRead{}\n    err:=json.Unmarshal(str,&amp;amp;stu)\n\n    //è§£æå¤±è´¥ä¼šæŠ¥é”™ï¼Œå¦‚jsonå­—ç¬¦ä¸²æ ¼å¼ä¸å¯¹ï¼Œç¼º&amp;quot;å·ï¼Œç¼º}ç­‰ã€‚\n    if err!=nil{\n        fmt.Println(err)\n    }\n\n    fmt.Println(stu)\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;ç»“æœï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;{å¼ ä¸‰ 18 true &amp;lt;nil&amp;gt; map[naME:1ç­ GradE:3] &amp;lt;nil&amp;gt;}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;æ€»ç»“ï¼š&lt;/p&gt;\n&lt;p&gt;jsonå­—ç¬¦ä¸²è§£ææ—¶ï¼Œéœ€è¦ä¸€ä¸ªâ€œæ¥æ”¶ä½“â€æ¥å—è§£æåçš„æ•°æ®ï¼Œä¸”Unmarshalæ—¶æ¥æ”¶ä½“å¿…é¡»ä¼ é€’æŒ‡é’ˆã€‚å¦åˆ™è§£æè™½ä¸æŠ¥é”™ï¼Œä½†æ•°æ®æ— æ³•èµ‹å€¼åˆ°æ¥å—ä½“ä¸­ã€‚å¦‚è¿™é‡Œç”¨çš„æ˜¯StuRead{}æ¥æ”¶ã€‚&lt;/p&gt;\n&lt;p&gt;è§£ææ—¶ï¼Œæ¥æ”¶ä½“å¯è‡ªè¡Œå®šä¹‰ã€‚jsonä¸²ä¸­çš„keyè‡ªåŠ¨åœ¨æ¥æ”¶ä½“ä¸­å¯»æ‰¾åŒ¹é…çš„é¡¹è¿›è¡Œèµ‹å€¼ã€‚åŒ¹é…è§„åˆ™æ˜¯ï¼š&lt;/p&gt;\n&lt;p&gt;å…ˆæŸ¥æ‰¾ä¸keyä¸€æ ·çš„jsonæ ‡ç­¾ï¼Œæ‰¾åˆ°åˆ™èµ‹å€¼ç»™è¯¥æ ‡ç­¾å¯¹åº”çš„å˜é‡(å¦‚Name)ã€‚&lt;br&gt;\næ²¡æœ‰jsonæ ‡ç­¾çš„ï¼Œå°±ä»ä¸Šå¾€ä¸‹ä¾æ¬¡æŸ¥æ‰¾å˜é‡åä¸keyä¸€æ ·çš„å˜é‡ï¼Œå¦‚Ageã€‚æˆ–è€…å˜é‡åå¿½ç•¥å¤§å°å†™åä¸keyä¸€æ ·çš„å˜é‡ã€‚å¦‚HIghï¼ŒClassã€‚ç¬¬ä¸€ä¸ªåŒ¹é…çš„å°±èµ‹å€¼ï¼Œåé¢å°±ç®—æœ‰åŒ¹é…çš„ä¹Ÿå¿½ç•¥ã€‚&lt;br&gt;\n(å‰ææ˜¯è¯¥å˜é‡å¿…éœ€æ˜¯å¯å¯¼å‡ºçš„ï¼Œå³é¦–å­—æ¯å¤§å†™)ã€‚&lt;br&gt;\nä¸å¯å¯¼å‡ºçš„å˜é‡æ— æ³•è¢«è§£æï¼ˆå¦‚sexå˜é‡ï¼Œè™½ç„¶jsonä¸²ä¸­æœ‰keyä¸ºsexçš„k-vï¼Œè§£æåå…¶å€¼ä»ä¸ºnil,å³ç©ºå€¼ï¼‰&lt;/p&gt;\n&lt;p&gt;å½“æ¥æ”¶ä½“ä¸­å­˜åœ¨jsonä¸²ä¸­åŒ¹é…ä¸äº†çš„é¡¹æ—¶ï¼Œè§£æä¼šè‡ªåŠ¨å¿½ç•¥è¯¥é¡¹ï¼Œè¯¥é¡¹ä»ä¿ç•™åŸå€¼ã€‚å¦‚å˜é‡Testï¼Œä¿ç•™ç©ºå€¼nilã€‚&lt;/p&gt;\n&lt;p&gt;ä½ ä¸€å®šä¼šå‘ç°ï¼Œå˜é‡Classè²Œä¼¼æ²¡æœ‰è§£æä¸ºæˆ‘ä»¬æœŸå¾…æ ·å­ã€‚å› ä¸ºæ­¤æ—¶çš„Classæ˜¯ä¸ªinterface{}ç±»å‹çš„å˜é‡ï¼Œè€Œjsonä¸²ä¸­keyä¸ºCLASSçš„valueæ˜¯ä¸ªå¤åˆç»“æ„ï¼Œä¸æ˜¯å¯ä»¥ç›´æ¥è§£æçš„ç®€å•ç±»å‹æ•°æ®ï¼ˆå¦‚â€œå¼ ä¸‰â€ï¼Œ18ï¼Œtrueç­‰ï¼‰ã€‚æ‰€ä»¥è§£ææ—¶ï¼Œç”±äºæ²¡æœ‰æŒ‡å®šå˜é‡Classçš„å…·ä½“ç±»å‹ï¼Œjsonè‡ªåŠ¨å°†valueä¸ºå¤åˆç»“æ„çš„æ•°æ®è§£æä¸ºmap[string]interface{}ç±»å‹çš„é¡¹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ­¤æ—¶çš„struct Classå¯¹è±¡ä¸StuReadä¸­çš„Classå˜é‡æ²¡æœ‰åŠæ¯›é’±å…³ç³»ï¼Œæ•…ä¸è¿™æ¬¡çš„jsonè§£ææ²¡æœ‰åŠæ¯›é’±å…³ç³»ã€‚&lt;/p&gt;\n&lt;p&gt;è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™å‡ ä¸ªinterface{}å˜é‡è§£æåçš„ç±»å‹&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;func main() {\n    //ä¸å‰è¾¹jsonè§£æçš„ä»£ç ä¸€è‡´\n    ...\n    fmt.Println(stu) //æ‰“å°jsonè§£æå‰å˜é‡ç±»å‹\n    err:=json.Unmarshal(str,&amp;amp;stu)\n    fmt.Println(&amp;quot;--------------json è§£æå-----------&amp;quot;)\n    ... \n    fmt.Println(stu) //æ‰“å°jsonè§£æåå˜é‡ç±»å‹    \n}\n\n//åˆ©ç”¨åå°„ï¼Œæ‰“å°å˜é‡ç±»å‹\nfunc printType(stu *StuRead){\n    nameType:=reflect.TypeOf(stu.Name)\n    ageType:=reflect.TypeOf(stu.Age)\n    highType:=reflect.TypeOf(stu.HIgh)\n    sexType:=reflect.TypeOf(stu.sex)\n    classType:=reflect.TypeOf(stu.Class)\n    testType:=reflect.TypeOf(stu.Test)\n\n    fmt.Println(&amp;quot;nameType:&amp;quot;,nameType)\n    fmt.Println(&amp;quot;ageType:&amp;quot;,ageType)\n    fmt.Println(&amp;quot;highType:&amp;quot;,highType)\n    fmt.Println(&amp;quot;sexType:&amp;quot;,sexType)\n    fmt.Println(&amp;quot;classType:&amp;quot;,classType)\n    fmt.Println(&amp;quot;testType:&amp;quot;,testType)\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;ç»“æœï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;nameType: &amp;lt;nil&amp;gt;\nageType: &amp;lt;nil&amp;gt;\nhighType: &amp;lt;nil&amp;gt;\nsexType: &amp;lt;nil&amp;gt;\nclassType: &amp;lt;nil&amp;gt;\ntestType: &amp;lt;nil&amp;gt;\n--------------json è§£æå-----------\nnameType: string\nageType: float64\nhighType: bool\nsexType: &amp;lt;nil&amp;gt;\nclassType: map[string]interface {}\ntestType: &amp;lt;nil&amp;gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;ä»ç»“æœä¸­å¯è§&lt;/p&gt;\n&lt;p&gt;interface{}ç±»å‹å˜é‡åœ¨jsonè§£æå‰ï¼Œæ‰“å°å‡ºçš„ç±»å‹éƒ½ä¸ºnilï¼Œå°±æ˜¯æ²¡æœ‰å…·ä½“ç±»å‹ï¼Œè¿™æ˜¯ç©ºæ¥å£ï¼ˆinterface{}ç±»å‹ï¼‰çš„ç‰¹ç‚¹ã€‚&lt;/p&gt;\n&lt;p&gt;jsonè§£æåï¼Œjsonä¸²ä¸­valueï¼Œåªè¦æ˜¯â€ç®€å•æ•°æ®â€ï¼Œéƒ½ä¼šæŒ‰ç…§é»˜è®¤çš„ç±»å‹èµ‹å€¼ï¼Œå¦‚â€å¼ ä¸‰â€è¢«èµ‹å€¼æˆstringç±»å‹åˆ°Nameå˜é‡ä¸­ï¼Œæ•°å­—18å¯¹åº”float64ï¼Œtrueå¯¹åº”boolç±»å‹ã€‚&lt;/p&gt;\n&lt;p&gt;â€œç®€å•æ•°æ®â€ï¼šæ˜¯æŒ‡ä¸èƒ½å†è¿›è¡ŒäºŒæ¬¡jsonè§£æçš„æ•°æ®ï¼Œå¦‚â€nameâ€:â€å¼ ä¸‰â€åªèƒ½è¿›è¡Œä¸€æ¬¡jsonè§£æã€‚&lt;br&gt;\nâ€œå¤åˆæ•°æ®â€ï¼šç±»ä¼¼â€CLASS\\â€:{\\â€naME\\â€:\\â€1ç­\\â€,\\â€GradE\\â€:3}è¿™æ ·çš„æ•°æ®ï¼Œæ˜¯å¯è¿›è¡ŒäºŒæ¬¡ç”šè‡³å¤šæ¬¡jsonè§£æçš„ï¼Œå› ä¸ºå®ƒçš„valueä¹Ÿæ˜¯ä¸ªå¯è¢«è§£æçš„ç‹¬ç«‹jsonã€‚å³ç¬¬ä¸€æ¬¡è§£ækeyä¸ºCLASSçš„valueï¼Œç¬¬äºŒæ¬¡è§£ævalueä¸­çš„keyä¸ºnaMEå’ŒGradEçš„value&lt;/p&gt;\n&lt;p&gt;å¯¹äºâ€å¤åˆæ•°æ®â€ï¼Œå¦‚æœæ¥æ”¶ä½“ä¸­é…çš„é¡¹è¢«å£°æ˜ä¸ºinterface{}ç±»å‹ï¼Œgoéƒ½ä¼šé»˜è®¤è§£ææˆmap[string]interface{}ç±»å‹ã€‚å¦‚æœæˆ‘ä»¬æƒ³ç›´æ¥è§£æåˆ°struct Classå¯¹è±¡ä¸­ï¼Œå¯ä»¥å°†æ¥å—ä½“å¯¹åº”çš„é¡¹å®šä¹‰ä¸ºè¯¥structç±»å‹ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;\n&lt;p&gt;type StuRead struct {&lt;br&gt;\n...&lt;br&gt;\n//æ™®é€šstructç±»å‹&lt;br&gt;\nClass Class &lt;code&gt;json:&amp;quot;class&amp;quot;&lt;/code&gt;&lt;br&gt;\n//æŒ‡é’ˆç±»å‹&lt;br&gt;\nClass *Class &lt;code&gt;json:&amp;quot;class&amp;quot;&lt;/code&gt;&lt;br&gt;\n}&lt;/p&gt;\n&lt;p&gt;stuæ‰“å°ç»“æœ&lt;/p&gt;\n&lt;p&gt;Classç±»å‹ï¼š{å¼ ä¸‰ 18 true &lt;nil&gt; {1ç­ 3} &lt;nil&gt;}&lt;br&gt;\n*Classç±»å‹ï¼š{å¼ ä¸‰ 18 true &lt;nil&gt; 0xc42008a0c0 &lt;nil&gt;}&lt;/p&gt;\n&lt;p&gt;å¯ä»¥çœ‹å‡ºï¼Œä¼ é€’Classç±»å‹çš„æŒ‡é’ˆæ—¶ï¼Œstuä¸­çš„Classå˜é‡å­˜çš„æ˜¯æŒ‡é’ˆï¼Œæˆ‘ä»¬å¯é€šè¿‡è¯¥æŒ‡é’ˆç›´æ¥è®¿é—®æ‰€å±çš„æ•°æ®ï¼Œå¦‚stu.Class.Name/stu.Class.Grade&lt;/p&gt;\n&lt;p&gt;Classå˜é‡è§£æåç±»å‹&lt;/p&gt;\n&lt;p&gt;classType: main.Class&lt;br&gt;\nclassType: *main.Class&lt;br&gt;\nè§£ææ—¶ï¼Œå¦‚æœæ¥å—ä½“ä¸­åŒæ—¶å­˜åœ¨2ä¸ªåŒ¹é…çš„é¡¹ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ&lt;br&gt;\næµ‹è¯•1&lt;/p&gt;\n&lt;p&gt;type StuRead struct {&lt;br&gt;\nNAme interface{}&lt;br&gt;\nName  interface{}&lt;br&gt;\nNAMe interface{}    &lt;code&gt;json:&amp;quot;name&amp;quot;&lt;/code&gt;&lt;br&gt;\n}&lt;br&gt;\nç»“æœ1:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;//å½“å­˜åœ¨åŒ¹é…çš„jsonæ ‡ç­¾æ—¶ï¼Œå…¶å¯¹åº”çš„é¡¹è¢«èµ‹å€¼ã€‚\n//åˆ‡è®°ï¼šåŒ¹é…çš„æ ‡ç­¾å¯ä»¥æ²¡æœ‰ï¼Œä½†æœ‰æ—¶æœ€å¥½åªæœ‰ä¸€ä¸ªå“¦\n{&amp;lt;nil&amp;gt; &amp;lt;nil&amp;gt; å¼ ä¸‰}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;æµ‹è¯•2&lt;/p&gt;\n&lt;p&gt;type StuRead struct {&lt;br&gt;\nNAme interface{}&lt;br&gt;\nName  interface{}&lt;br&gt;\nNAMe interface{}    &lt;code&gt;json:&amp;quot;name&amp;quot;&lt;/code&gt;&lt;br&gt;\nNamE interface{}    &lt;code&gt;json:&amp;quot;name&amp;quot;&lt;/code&gt;&lt;br&gt;\n}&lt;br&gt;\nç»“æœ2&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;//å½“åŒ¹é…çš„jsonæ ‡ç­¾æœ‰å¤šä¸ªæ—¶ï¼Œæ ‡ç­¾å¯¹åº”çš„é¡¹éƒ½ä¸ä¼šè¢«èµ‹å€¼ã€‚\n//å¿½ç•¥æ ‡ç­¾é¡¹ï¼Œä»ä¸Šå¾€ä¸‹å¯»æ‰¾ç¬¬ä¸€ä¸ªæ²¡æœ‰æ ‡ç­¾ä¸”åŒ¹é…çš„é¡¹èµ‹å€¼\n{å¼ ä¸‰ &amp;lt;nil&amp;gt; &amp;lt;nil&amp;gt; &amp;lt;nil&amp;gt;}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;æµ‹è¯•3&lt;/p&gt;\n&lt;p&gt;type StuRead struct {&lt;br&gt;\nNAme interface{}&lt;br&gt;\nName  interface{}&lt;br&gt;\n}&lt;br&gt;\nç»“æœ3&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;//æ²¡æœ‰jsonæ ‡ç­¾æ—¶ï¼Œä»ä¸Šå¾€ä¸‹ï¼Œç¬¬ä¸€ä¸ªåŒ¹é…çš„é¡¹ä¼šè¢«èµ‹å€¼å“¦\n{å¼ ä¸‰ &amp;lt;nil&amp;gt;}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;æµ‹è¯•4&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;type StuRead struct {\n    NAMe interface{}    `json:&amp;quot;name&amp;quot;`\n    NamE interface{}    `json:&amp;quot;name&amp;quot;`\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;ç»“æœ4&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;//å½“ç›¸åŒçš„jsonæ ‡ç­¾æœ‰å¤šä¸ªï¼Œä¸”æ²¡æœ‰ä¸å¸¦æ ‡ç­¾çš„åŒ¹é…é¡¹æ—¶ï¼ŒæŠ¥é”™äº†å“¦\n# command-line-arguments\nsrc/test/b.go:48: stu.Name undefined (type *StuRead has no field or method Name, but does have NAMe)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;å¯è§ï¼Œä¸å‰è¾¹è¯´è¿‡çš„åŒ¹é…è§„åˆ™æ˜¯ä¸€è‡´çš„ã€‚&lt;/p&gt;\n&lt;p&gt;å¦‚æœä¸æƒ³æŒ‡å®šClasså˜é‡ä¸ºå…·ä½“çš„ç±»å‹ï¼Œä»æƒ³ä¿ç•™interface{}ç±»å‹ï¼Œä½†åˆå¸Œæœ›è¯¥å˜é‡å¯ä»¥è§£æåˆ°struct Classå¯¹è±¡ä¸­ï¼Œè¿™æ—¶å€™è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ&lt;/p&gt;\n&lt;p&gt;è¿™ç§éœ€æ±‚æ˜¯å¾ˆå¯èƒ½å­˜åœ¨çš„ï¼Œä¾‹å¦‚ç¬”è€…æˆ‘å°±ç¢°åˆ°äº†&lt;/p&gt;\n&lt;p&gt;åŠæ³•è¿˜æ˜¯æœ‰çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¯¥å˜é‡å®šä¹‰ä¸ºjson.RawMessageç±»å‹&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;type StuRead struct {\n    Name  interface{}\n    Age   interface{}\n    HIgh  interface{}\n    Class json.RawMessage `json:&amp;quot;class&amp;quot;` //æ³¨æ„è¿™é‡Œ\n}\n\ntype Class struct {\n    Name  string\n    Grade int\n}\n\nfunc main() {\n    data:=&amp;quot;{\\&amp;quot;name\\&amp;quot;:\\&amp;quot;å¼ ä¸‰\\&amp;quot;,\\&amp;quot;Age\\&amp;quot;:18,\\&amp;quot;high\\&amp;quot;:true,\\&amp;quot;sex\\&amp;quot;:\\&amp;quot;ç”·\\&amp;quot;,\\&amp;quot;CLASS\\&amp;quot;:{\\&amp;quot;naME\\&amp;quot;:\\&amp;quot;1ç­\\&amp;quot;,\\&amp;quot;GradE\\&amp;quot;:3}}&amp;quot;\n    str:=[]byte(data)\n    stu:=StuRead{}\n    _:=json.Unmarshal(str,&amp;amp;stu)\n\n    //æ³¨æ„è¿™é‡Œï¼šäºŒæ¬¡è§£æï¼\n    cla:=new(Class)\n    json.Unmarshal(stu.Class,cla)\n\n    fmt.Println(&amp;quot;stu:&amp;quot;,stu)\n    fmt.Println(&amp;quot;string(stu.Class):&amp;quot;,string(stu.Class))\n    fmt.Println(&amp;quot;class:&amp;quot;,cla)\n    printType(&amp;amp;stu) //å‡½æ•°å®ç°å‰é¢ä¾‹å­æœ‰\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;ç»“æœ&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;stu: {å¼ ä¸‰ 18 true [123 34 110 97 77 69 34 58 34 49 231 143 173 34 44 34 71 114 97 100 69 34 58 51 125]}\nstring(stu.Class): {&amp;quot;naME&amp;quot;:&amp;quot;1ç­&amp;quot;,&amp;quot;GradE&amp;quot;:3}\nclass: &amp;amp;{1ç­ 3}\nnameType: string\nageType: float64\nhighType: bool\nclassType: json.RawMessage\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;ä»ç»“æœä¸­å¯è§&lt;/p&gt;\n&lt;p&gt;æ¥æ”¶ä½“ä¸­ï¼Œè¢«å£°æ˜ä¸ºjson.RawMessageç±»å‹çš„å˜é‡åœ¨jsonè§£ææ—¶ï¼Œå˜é‡å€¼ä»ä¿ç•™jsonçš„åŸå€¼ï¼Œå³æœªè¢«è‡ªåŠ¨è§£æä¸ºmap[string]interface{}ç±»å‹ã€‚å¦‚å˜é‡Classè§£æåçš„å€¼ä¸ºï¼š{â€œnaMEâ€:â€1ç­â€,â€GradEâ€:3}&lt;/p&gt;\n&lt;p&gt;ä»æ‰“å°çš„ç±»å‹ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œåœ¨ç¬¬ä¸€æ¬¡jsonè§£ææ—¶ï¼Œå˜é‡Classçš„ç±»å‹æ˜¯json.RawMessageã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹è¯¥å˜é‡è¿›è¡ŒäºŒæ¬¡jsonè§£æï¼Œå› ä¸ºå…¶å€¼ä»æ˜¯ä¸ªç‹¬ç«‹ä¸”å¯è§£æçš„å®Œæ•´jsonä¸²ã€‚æˆ‘ä»¬åªéœ€å†å®šä¹‰ä¸€ä¸ªæ–°çš„æ¥å—ä½“å³å¯ï¼Œå¦‚json.Unmarshal(stu.Class,cla)&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;golang-bi-ji-json-shu-ju-jie-xi-marshal-yu-unmarshal&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;golangç¬”è®°-jsonæ•°æ®è§£æï¼šMarshalä¸Unmarshal&#34;,&#34;tags&#34;:[{&#34;index&#34;:-1,&#34;name&#34;:&#34;golang&#34;,&#34;slug&#34;:&#34;oHQV9cP9p&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/oHQV9cP9p/&#34;}],&#34;date&#34;:&#34;2020-05-28 18:15:31&#34;,&#34;dateFormat&#34;:&#34;2020-05-28&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;http://lvelvis.github.io/post/golang-bi-ji-json-shu-ju-jie-xi-marshal-yu-unmarshal/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;13 min read&#34;,&#34;time&#34;:754000,&#34;words&#34;:2981,&#34;minutes&#34;:13},&#34;description&#34;:&#34;ç®€ä»‹\nJson(Javascript Object Nanotation)æ˜¯ä¸€ç§æ•°æ®äº¤æ¢æ ¼å¼ï¼Œå¸¸ç”¨äºå‰åç«¯æ•°æ®ä¼ è¾“ã€‚ä»»æ„ä¸€ç«¯å°†æ•°æ®è½¬æ¢æˆjson å­—ç¬¦ä¸²ï¼Œå¦ä¸€ç«¯å†å°†è¯¥å­—ç¬¦ä¸²è§£ææˆç›¸åº”çš„æ•°æ®ç»“æ„ï¼Œå¦‚stringç±»å‹ï¼Œstrcutå¯¹è±¡ç­‰ã€‚\ngo...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%AE%80%E4%BB%8B\&#34;&gt;ç®€ä»‹&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%AE%9E%E7%8E%B0\&#34;&gt;å®ç°&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;h1 id=\&#34;æ•°ç»„\&#34;&gt;æ•°ç»„&lt;/h1&gt;\n&lt;p&gt;æ•°ç»„çš„é•¿åº¦ä¸€æ—¦å®šä¹‰äº†å°±ä¸èƒ½åŠ¨æ€å¢é•¿ï¼Œå¹¶ä¸”å­˜å‚¨çš„æ•°æ®ç±»å‹å¿…é¡»ç›¸åŒã€‚&lt;/p&gt;\n&lt;h2 id=\&#34;åˆ›å»ºæ–¹æ³•\&#34;&gt;åˆ›å»ºæ–¹æ³•ï¼š&lt;/h2&gt;\n&lt;p&gt;var æ•°ç»„å [é•¿åº¦]æ•°æ®ç±»å‹&lt;br&gt;\nä¾‹å¦‚ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;package main\nimport &amp;quot;fmt&amp;quot;\n \nfunc main(){\n    var test [5]int //å®šä¹‰æ•°ç»„åå­—testï¼Œé•¿åº¦ä¸º5ï¼Œæ•°æ®ç±»å‹ä¸ºintçš„æ•°ç»„\n    test[0] = 1    //èµ‹å€¼\n    test[1] = 2   \n    test[2] = 3\n    test[3] = 4\n    fmt.Println(test) \n    fmt.Println(test[2])\n    fmt.Println(test[1:3]) //è¾“å‡º1åˆ°3çš„æ•°ç»„\n    fmt.Println(test[0:]) //0åˆ°ç»“å°¾\n    fmt.Println(test[:3])  //0åˆ°3\n \n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;pre&gt;&lt;code&gt;##ç»“æœ##\n[1 2 3 4 0]\n3\n[2 3]\n[1 2 3 4 0]\n[1 2 3]\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;æ•°ç»„çš„å››ç§åˆå§‹åŒ–æ–¹å¼\&#34;&gt;æ•°ç»„çš„å››ç§åˆå§‹åŒ–æ–¹å¼&lt;/h2&gt;\n&lt;p&gt;ä¾‹å¦‚ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;var s1 [3]int = [3]int{1,2,3}\nfmt.Println(&amp;quot;s1&amp;quot;,s1)\nvar s2 [4]int = [...]int{5,6,7,8} //[...]æ˜¯å›ºå®šå†™æ³•\nfmt.Println(&amp;quot;s2&amp;quot;,s2)\nvar s3 = [2]int{9,10} //ç¬¬ä¸€ç§çš„ç®€åŒ–\nfmt.Println(&amp;quot;s3&amp;quot;,s3)\nvar s4 = [...]int{3:43,1:41,0:40,2:42} //ç±»ä¼¼é”®å€¼å¯¹\nfmt.Println(&amp;quot;s4&amp;quot;,s4)\nvar s5 = new([5]int)\ns5[4] =12\nfmt.Println(&amp;quot;s5&amp;quot;,s5)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;pre&gt;&lt;code&gt;##ç»“æœ##\ns1 [1 2 3]\ns2 [5 6 7 8]\ns3 [9 10]\ns4 [40 41 42 43]\ns5 [0 0 0 0 5]\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;æ•°ç»„çš„éå†\&#34;&gt;æ•°ç»„çš„éå†&lt;/h2&gt;\n&lt;p&gt;ä¾‹å¦‚ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;var s4 = [...]int{3:43,1:41,0:40,2:42} //ç±»ä¼¼é”®å€¼å¯¹\nfmt.Println(&amp;quot;s4&amp;quot;,s4)\n     \nfor index,value := range s4{\nfmt.Println(index,value)\n}\n \n#ç»“æœ##\n0 40\n1 41\n2 42\n3 43\n&lt;/code&gt;&lt;/pre&gt;\n&lt;pre&gt;&lt;code&gt;var s4 = [...]int{3:43,1:41,0:40,2:42} //ç±»ä¼¼é”®å€¼å¯¹\nfor i := 0;i &amp;lt;len(s4);i++{\nfmt.Println(i,s4[i])\n}\n \n#ç»“æœ##\n0 40\n1 41\n2 42\n3 43\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;sliceåˆ‡ç‰‡\&#34;&gt;sliceåˆ‡ç‰‡&lt;/h1&gt;\n&lt;p&gt;1ã€åˆ‡ç‰‡æ˜¯æ•°ç»„çš„å¼•ç”¨(åˆ‡ç‰‡æ˜¯æ•°ç»„çš„ä¸€éƒ¨åˆ†)&lt;br&gt;\n2ã€åˆ‡ç‰‡çš„ä½¿ç”¨ç±»ä¼¼æ•°ç»„ï¼Œå¦‚éå†&lt;br&gt;\n3ã€åˆ‡ç‰‡çš„é•¿åº¦æ˜¯å¯å˜çš„&lt;/p&gt;\n&lt;h2 id=\&#34;åˆ›å»ºè¯­æ³•\&#34;&gt;åˆ›å»ºè¯­æ³•&lt;/h2&gt;\n&lt;p&gt;var åˆ‡ç‰‡å []ç±»å‹&lt;br&gt;\nå¦‚ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;var qiepian []int\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;åˆ‡ç‰‡ç¤ºä¾‹\&#34;&gt;åˆ‡ç‰‡ç¤ºä¾‹:&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;###ä¾‹å­ä¸€&amp;lt;br&amp;gt;var suzhu [4]int = [...]int{5,6,7,8}\nslice := suzhu[1:4] //1åˆ°4çš„å€¼ï¼Œä¸åŒ…å«4\nfmt.Println(suzhu)\nfmt.Println(slice)\nfmt.Println(&amp;quot;åˆ‡ç‰‡çš„å®¹é‡&amp;quot;,cap(slice))\n \n##ç»“æœ\n[5 6 7 8]\n[6 7 8]\nåˆ‡ç‰‡çš„å®¹é‡ 3&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;\n###ä¾‹å­äºŒã€ä½¿ç”¨makeåˆ›å»ºåˆ‡ç‰‡\nvar slice []int = make([]int,4,10) //ç±»å‹ï¼Œå¤§å°(é•¿åº¦),å®¹é‡ï¼ˆå¯é€‰ï¼‰ï¼Œå®¹é‡å¿…é¡»å¤§äºé•¿åº¦\nslice[0] = 10\nslice[1] = 11\nfmt.Println(slice)\n \n##ç»“æœ##\n[10 11 0 0]\n \n \n###ä¾‹å­ä¸‰\nvar slice []int = []int {2,4,6}\nfmt.Println(slice)\n \n##ç»“æœ##\n2 4 6\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;åˆ‡ç‰‡çš„appendè¿½åŠ \&#34;&gt;åˆ‡ç‰‡çš„appendè¿½åŠ &lt;/h2&gt;\n&lt;p&gt;ä¾‹å¦‚ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;var slice []int = []int {2,4,6}\nfmt.Println(slice)\n//ä½¿ç”¨appendç›´æ¥è¿½åŠ åˆ‡ç‰‡å†…å®¹ï¼ˆç±»ä¼¼python listçš„appendï¼‰\nslice = append(slice,8,10)\nfmt.Println(slice)\nslice = append(slice,slice...) //è¿½åŠ åˆ‡ç‰‡ï¼Œ...æ˜¯å›ºå®šå†™æ³•\nfmt.Println(slice)\n \n###ç»“æœ###\n[2 4 6]\n[2 4 6 8 10]\n[2 4 6 8 10 2 4 6 8 10]\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;åˆ‡ç‰‡çš„copyæ“ä½œ\&#34;&gt;åˆ‡ç‰‡çš„copyæ“ä½œ&lt;/h2&gt;\n&lt;p&gt;ä½¿ç”¨copyå†…ç½®å‡½æ•°&lt;br&gt;\nä¾‹å¦‚:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;var slice []int = []int {2,4,6}\nfmt.Println(slice)\nvar slice2 []int = make([]int,5)\nfmt.Println(slice2)\ncopy(slice2,slice) //å°†sliceå¤åˆ¶ç»™slice2\nfmt.Println(slice)\nfmt.Println(slice2)\n \n##ç»“æœ##\n[2 4 6]\n[0 0 0 0 0]\n[2 4 6]\n[2 4 6 0 0]\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;ä½¿ç”¨åˆ‡ç‰‡æ”¹å˜å­—ç¬¦ä¸²çš„å†…å®¹\&#34;&gt;ä½¿ç”¨åˆ‡ç‰‡æ”¹å˜å­—ç¬¦ä¸²çš„å†…å®¹&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;var str string = &amp;quot;hello&amp;quot;\nfmt.Println(str)\narr := []byte(str)\narr[1] = &#39;a&#39; //è½¬æˆå­—ç¬¦ä¸²\narr1 := []rune(str) //ä¸­æ–‡è½¬æ¢\narr1[0] = &#39;ç‹—&#39;\nfmt.Println(arr)\nstr = string(arr)\nfmt.Println(str)\nstr = string(arr1)\nfmt.Println(str)\n \n##ç»“æœ##\nhello\n[104 97 108 108 111]\nhello\nç‹—hello\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;map\&#34;&gt;map&lt;/h1&gt;\n&lt;p&gt;mapæ˜¯key-valueæ•°æ®ç»“æ„(ç±»ä¼¼pythonçš„dict)&lt;br&gt;\nmapæ˜¯æ— åºå­˜å‚¨çš„&lt;/p&gt;\n&lt;p&gt;åˆ›å»ºmapè¯­æ³•&lt;br&gt;\nvar map å˜é‡å map[keytype]valuetype&lt;/p&gt;\n&lt;p&gt;å¦‚ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;var m1 map[string]string\nvar m2 map[string]int\nvar m3 map[int]string\nvar m4 map[string]map[string]string\n```ã€€ã€€\n\nä½¿ç”¨ä¾‹å­ï¼š\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;package main&lt;br&gt;\nimport &amp;quot;fmt&amp;quot;&lt;/p&gt;\n&lt;p&gt;func main(){&lt;br&gt;\nvar m1 map[string]string&lt;br&gt;\n//åœ¨ä½¿ç”¨mapå‰,éœ€è¦å…ˆmakeï¼Œmakeçš„ä½œç”¨æŠ€æœ¯ç»™mapåˆ†é…æ•°æ®ç©ºé—´&lt;br&gt;\nm1 = make(map[string]string)&lt;br&gt;\nm2 := map[string]string{  //ä½¿ç”¨æ–¹å¼äºŒ&lt;br&gt;\n&amp;quot;a1&amp;quot; : &amp;quot;q1&amp;quot;,&lt;br&gt;\n&amp;quot;a2&amp;quot; : &amp;quot;a2&amp;quot;,&lt;br&gt;\n}&lt;br&gt;\nm1[&amp;quot;s1&amp;quot;] = &amp;quot;äºšç´¢&amp;quot;&lt;br&gt;\nm1[&amp;quot;s2&amp;quot;] = &amp;quot;ç›–ä¼¦&amp;quot;&lt;br&gt;\nfmt.Println(m1)&lt;br&gt;\nfmt.Println(m1[&amp;quot;s1&amp;quot;])&lt;br&gt;\nfmt.Println(m2)&lt;br&gt;\n}&lt;/p&gt;\n&lt;p&gt;###ç»“æœ###&lt;br&gt;\nmap[s1:äºšç´¢ s2:ç›–ä¼¦]&lt;br&gt;\näºšç´¢&lt;br&gt;\nmap[a1:q1 a2:a2]&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;\n \n\nmapçš„å¢åˆ æ”¹æŸ¥\nå¢ã€æ”¹\nmap[key] = value //æ²¡æœ‰å°±å¢åŠ ï¼Œå­˜åœ¨å°±ä¿®æ”¹\n\nåˆ \ndelete(map,key)\n\næŸ¥\nmap[key]   //å¯¹åº”çš„valueï¼Œå’Œpythonçš„dictä¸€æ ·&lt;/code&gt;&lt;/pre&gt;\n&#34;,&#34;fileName&#34;:&#34;golang-bi-ji-shu-zu-qie-pian-map&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;golangç¬”è®°-æ•°ç»„ã€åˆ‡ç‰‡ã€map&#34;,&#34;tags&#34;:[{&#34;index&#34;:-1,&#34;name&#34;:&#34;golang&#34;,&#34;slug&#34;:&#34;oHQV9cP9p&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/oHQV9cP9p/&#34;}],&#34;date&#34;:&#34;2020-05-26 13:29:04&#34;,&#34;dateFormat&#34;:&#34;2020-05-26&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;http://lvelvis.github.io/post/golang-bi-ji-shu-zu-qie-pian-map/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;5 min read&#34;,&#34;time&#34;:292000,&#34;words&#34;:966,&#34;minutes&#34;:5},&#34;description&#34;:&#34;æ•°ç»„\næ•°ç»„çš„é•¿åº¦ä¸€æ—¦å®šä¹‰äº†å°±ä¸èƒ½åŠ¨æ€å¢é•¿ï¼Œå¹¶ä¸”å­˜å‚¨çš„æ•°æ®ç±»å‹å¿…é¡»ç›¸åŒã€‚\nåˆ›å»ºæ–¹æ³•ï¼š\nvar æ•°ç»„å [é•¿åº¦]æ•°æ®ç±»å‹\nä¾‹å¦‚ï¼š\npackage main\nimport &amp;quot;fmt&amp;quot;\n \nfunc main(){\n    va...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%95%B0%E7%BB%84\&#34;&gt;æ•°ç»„&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%88%9B%E5%BB%BA%E6%96%B9%E6%B3%95\&#34;&gt;åˆ›å»ºæ–¹æ³•ï¼š&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%95%B0%E7%BB%84%E7%9A%84%E5%9B%9B%E7%A7%8D%E5%88%9D%E5%A7%8B%E5%8C%96%E6%96%B9%E5%BC%8F\&#34;&gt;æ•°ç»„çš„å››ç§åˆå§‹åŒ–æ–¹å¼&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%95%B0%E7%BB%84%E7%9A%84%E9%81%8D%E5%8E%86\&#34;&gt;æ•°ç»„çš„éå†&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#slice%E5%88%87%E7%89%87\&#34;&gt;sliceåˆ‡ç‰‡&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%88%9B%E5%BB%BA%E8%AF%AD%E6%B3%95\&#34;&gt;åˆ›å»ºè¯­æ³•&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%88%87%E7%89%87%E7%A4%BA%E4%BE%8B\&#34;&gt;åˆ‡ç‰‡ç¤ºä¾‹:&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%88%87%E7%89%87%E7%9A%84append%E8%BF%BD%E5%8A%A0\&#34;&gt;åˆ‡ç‰‡çš„appendè¿½åŠ &lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%88%87%E7%89%87%E7%9A%84copy%E6%93%8D%E4%BD%9C\&#34;&gt;åˆ‡ç‰‡çš„copyæ“ä½œ&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E4%BD%BF%E7%94%A8%E5%88%87%E7%89%87%E6%94%B9%E5%8F%98%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E5%86%85%E5%AE%B9\&#34;&gt;ä½¿ç”¨åˆ‡ç‰‡æ”¹å˜å­—ç¬¦ä¸²çš„å†…å®¹&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#map\&#34;&gt;map&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;pre&gt;&lt;code&gt;HPAå…¨ç§°Horizontal Pod Autoscalingï¼Œæ˜¯K8så®ç°podè‡ªåŠ¨æ°´å¹³æ‰©å®¹ç¼©å®¹çš„ç‰¹æ€§ï¼Œè¿™ä¸ªç‰¹æ€§ä½¿æ•´ä¸ªkubernetesé›†ç¾¤é©¬ä¸Šé«˜å¤§ä¸Šèµ·æ¥äº†ã€‚\nè¦ä½¿ç”¨HPAä¹Ÿä¸æ˜¯è¿™ä¹ˆç®€å•çš„ï¼ŒHPA apiåˆ†v1ã€v2beta1ã€v2bate2ä¸‰ç§ï¼Œv1åªæ”¯æŒé€šè¿‡CPUè¡¡é‡æ‰©ç¼©å®¹ï¼Œv2bate1åŠ å…¥é’ˆå¯¹å†…å­˜ä½œä¸ºåº¦é‡ï¼Œv2bate2å¯ä»¥ç”¨customer metricsä¾‹å¦‚ç½‘ç»œç­‰ï¼Œæ‰€ä»¥v2bate1å¼€å§‹æ‰æ¯”è¾ƒå®ç”¨ã€‚\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;è¦ä½¿ç”¨HPAå¿…é¡»è¦å¼€å¯ä»¥ä¸‹ä¸¤ä¸ªç‰¹æ€§ï¼š&lt;/p&gt;\n&lt;p&gt;Aggregation Layer èšåˆå±‚ï¼Œé€šè¿‡ä¸æ ¸å¿ƒçš„apiserveråˆ†ç¦»ï¼Œå®ç°è‡ªå®šä¹‰çš„æ‰©å±•åŠŸèƒ½&lt;br&gt;\nmetrics-server æ•°æ®æ”¶é›†ï¼Œèƒ½å¤Ÿæ”¶é›†podã€nodeç­‰å®æ—¶è¿è¡ŒæŒ‡æ ‡ï¼ˆcpuã€å†…å­˜ï¼‰ï¼Œç»™k8sé›†ç¾¤ä½¿ç”¨ï¼Œä¾‹å¦‚kubectl topå‘½ä»¤ã€HPA&lt;br&gt;\næ¯”è¾ƒè€çš„ç‰ˆæœ¬ä½¿ç”¨heapster&lt;/p&gt;\n&lt;h1 id=\&#34;aggregation-layer\&#34;&gt;Aggregation Layer&lt;/h1&gt;\n&lt;p&gt;è¦æ‰“å¼€Aggregation Layerï¼Œéœ€è¦é…ç½®ä¸€ä¸‹apiserverï¼Œå¢åŠ ç›¸å…³è®¤è¯è¯ä¹¦ã€‚è®¤è¯æµç¨‹æ˜¯clientå‘èµ·è¯·æ±‚åˆ°apiserverï¼Œapiserverä¸aggergated apiserverå»ºç«‹tlså®‰å…¨é“¾æ¥ï¼ŒæŠŠè¯·æ±‚proxyåˆ°aggergated apiserverï¼Œç»§ç»­è¿›è¡Œâ€“requestheader-*å‚æ•°çš„ç›¸å…³è®¤è¯ã€‚&lt;/p&gt;\n&lt;p&gt;è®¤è¯æµç¨‹&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1589865988979.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;éœ€è¦ç”Ÿæˆaggregateä½¿ç”¨çš„è¯ä¹¦ï¼Œå‚è€ƒcfsslç”Ÿæˆè¯ä¹¦æ–¹æ³•ï¼Œproxy-client-cert-fileçš„CNéœ€è¦ä¸requestheader-allowed-namesåŒ¹é…ã€‚&lt;br&gt;\nåœ¨apiserverå¢åŠ å¦‚ä¸‹å¯åŠ¨å‚æ•°&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;--requestheader-client-ca-file=/etc/kubernetes/pki/agg-ca.pem\n--proxy-client-cert-file=/etc/kubernetes/pki/aggregate.pem\n--proxy-client-key-file=/etc/kubernetes/pki/aggregate-key.pem\n--requestheader-allowed-names=aggregator\n--requestheader-extra-headers-prefix=X-Remote-Extra-\n--requestheader-group-headers=X-Remote-Group\n--requestheader-username-headers=X-Remote-User\n#å¦‚æœkube-proxyæ²¡æœ‰åœ¨Masterä¸Šé¢è¿è¡Œï¼Œè¿˜éœ€è¦é…ç½®\n--enable-aggregator-routing=true\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;metrics-server\&#34;&gt;metrics server&lt;/h1&gt;\n&lt;p&gt;ä»k8s 1.8å¼€å§‹ï¼Œé›†ç¾¤çš„èµ„æºä½¿ç”¨æƒ…å†µéƒ½é€šè¿‡metrics apiæ”¶é›†ï¼Œä¾‹å¦‚å®¹å™¨CPUã€å†…å­˜ã€‚è¿™äº›æŒ‡æ ‡å¯ç”¨äºkuberctl topæˆ–è€…k8sçš„HPAç­‰ç‰¹æ€§ã€‚&lt;br&gt;\nmetrice serverå¯ä»¥åœ¨githubæ‰¾åˆ°å¹¶éƒ¨ç½²&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git clone https://github.com/kubernetes-incubator/metrics-server\ncd metrics-server\nkubectl create -f deploy/1.8+/\n&lt;/code&gt;&lt;/pre&gt;\n&lt;pre&gt;&lt;code&gt;æ³¨1ï¼šmetrics-serveré»˜è®¤ä½¿ç”¨nodeçš„ä¸»æœºåï¼Œä½†æ˜¯corednsé‡Œé¢æ²¡æœ‰ç‰©ç†æœºä¸»æœºåçš„è§£æï¼Œä¸€ç§æ˜¯éƒ¨ç½²çš„æ—¶å€™æ·»åŠ ä¸€ä¸ªå‚æ•°ï¼š â€“kubelet-preferred-address-types=InternalIP,Hostname,InternalDNS,ExternalDNS,ExternalIP,ç¬¬äºŒç§æ˜¯ä½¿ç”¨dnsmasqæ„å»ºä¸€ä¸ªä¸Šæ¸¸çš„dnsæœåŠ¡\næ³¨2ï¼škubelet çš„10250ç«¯å£ä½¿ç”¨çš„æ˜¯httpsåè®®ï¼Œè¿æ¥éœ€è¦éªŒè¯tlsè¯ä¹¦ã€‚å¯ä»¥åœ¨metrics serverå¯åŠ¨å‘½ä»¤æ·»åŠ å‚æ•°â€“kubelet-insecure-tlsä¸éªŒè¯å®¢æˆ·ç«¯è¯ä¹¦\næ³¨3ï¼šyamlæ–‡ä»¶ä¸­çš„imageåœ°å€k8s.gcr.io/metrics-server-amd64:v0.3.3 éœ€è¦æ¢¯å­ï¼Œéœ€è¦æ”¹æˆä¸­å›½å¯ä»¥è®¿é—®çš„imageåœ°å€ï¼Œå¯ä»¥ä½¿ç”¨aliyunçš„ã€‚è¿™é‡Œä½¿ç”¨hub.docker.comé‡Œçš„googleé•œåƒåœ°å€ image: mirrorgooglecontainers/metrics-server-amd64:v0.3.3\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;æˆåŠŸè¿è¡Œkubectl topå‘½ä»¤&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;ubuntu@k8s-dev-m1:~/k8sssl/agglayer$ kubectl top nodes\nNAME                   CPU(cores)   CPU%   MEMORY(bytes)   MEMORY%   \nk8s-dev-node2          103m         5%      2696Mi                 72%       \nk8s-dev-node3.bxr.cn   115m      2%     5312Mi                  67%  \nk8s-dev-node4          57m          2%       2634Mi                  70%     \nk8s-dev-node5          148m         7%       2443Mi                  65%\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;hpa\&#34;&gt;HPA&lt;/h1&gt;\n&lt;pre&gt;&lt;code&gt;æœ‰äº†metricså°±å¯ä»¥å¼€å§‹ä½¿ç”¨HPAç‰¹æ€§äº†ã€‚hpaæœ‰å‡ ä¸ªç‰¹ç‚¹\ndeployæˆ–è€…rsç­‰éœ€è¦è®¾ç½®resourcesæ‰èƒ½ä½¿ç”¨hpa\nå¦‚æœæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªHPA controllerï¼Œå®ƒä¼šæ¯éš”15sï¼ˆå¯ä»¥é€šè¿‡â€“horizontal-pod-autoscaler-sync-periodä¿®æ”¹ï¼‰æ£€æµ‹ä¸€æ¬¡hpaå®šä¹‰çš„èµ„æºä¸å®é™…èµ„æºä½¿ç”¨æƒ…å†µï¼Œå¦‚æœè¾¾åˆ°é˜€å€¼å°±ä¼šè°ƒæ•´podæ•°é‡ã€‚\nHPAè®¾ç½®çš„é˜€å€¼ä¸æ˜¯ç»å¯¹çš„ï¼Œå…è®¸è®¾ç½®ä¸€ä¸ªæµ®åŠ¨èŒƒå›´ï¼Œâ€“horizontal-pod-autoscaler-toleranceé»˜è®¤æ˜¯0.1\npodè°ƒæ•´ç®—æ³• desiredReplicas = ceil[currentReplicas * ( currentMetricValue / desiredMetricValue )]\nscaleæœ‰ä¸€ä¸ªçª—å£æœŸï¼ŒæœŸé—´æ¯æ¬¡å˜åŒ–ä¼šè®°å½•ä¸‹æ¥ï¼Œé€‰æ‹©æœ€ä¼˜çš„è°ƒæ•´å»ºè®®å†è¿›è¡Œscaleï¼Œè¿™æ ·å¯ä»¥ä¿è¯èµ„æºå¹³æ»‘å˜åŠ¨ï¼Œé€šè¿‡â€“horizontal-pod-autoscaler-downscale-stabilizationè®¾å®šï¼Œé»˜è®¤5åˆ†é’Ÿã€‚\né€šè¿‡hpaè°ƒæ•´æ–°å¢çš„podä¸ä¼šé©¬ä¸Šreadyï¼Œè¿™æ—¶å€™æ”¶é›†çš„metricså°±ä¸å‡†ï¼Œä¸ºäº†å‡å°‘å½±å“ï¼Œhpaä¸€å¼€å§‹ä¸ä¼šæ”¶é›†æ–°podçš„metricsã€‚é€šè¿‡â€“horizontal-pod-autoscaler-initial-readiness-delayï¼ˆé»˜è®¤30sï¼‰å’Œ â€“horizontal-pod-autoscaler-cpu-initialization-periodï¼ˆé»˜è®¤ä¸º 5 åˆ†é’Ÿï¼‰è°ƒæ•´\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;img src=\&#34;http://lvelvis.github.io/post-images/1589866316410.svg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\nç¤ºä¾‹hpa.yml:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;apiVersion: autoscaling/v2beta2\nkind: HorizontalPodAutoscaler\nmetadata:\n  name: hpa-test\nspec:\n  scaleTargetRef:\n    apiVersion: apps/v1\n    kind: Deployment\n    name: podinfo\n  minReplicas: 2\n  maxReplicas: 10\n  metrics:\n  - type: Resource\n    resource:\n      name: cpu\n      target:\n        type: Utilization\n        averageUtilization: 75\n  - type: Resource\n    resource:\n      name: memory\n      target:\n        type: Utilization \n        averageUtilization: 160\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;ä¸Šé¢çš„ç¤ºä¾‹åŒ…æ‹¬cpuå’ŒmemoryæŒ‡æ ‡ï¼ŒaverageUtilizationè¿™ä¸ªç™¾åˆ†æ¯”æ˜¯æ ¹æ®deploymentçš„resources.requestsè®¡ç®—çš„ã€‚ä¾‹å¦‚æœ‰deploymenté™åˆ¶requestsæ˜¯512Miï¼Œreplicasæ˜¯2ï¼Œå®é™…pod1ç”¨äº†612Miï¼Œpod2ç”¨äº†598Miï¼Œè®¡ç®—å…¬å¼æ˜¯ (612+598)/2/512 = 118%&lt;/p&gt;\n&lt;p&gt;æŸ¥çœ‹hpaçš„æƒ…å†µï¼Œtargetsç¬¬ä¸€ä¸ªæ˜¯memoryï¼Œç¬¬äºŒä¸ªæ˜¯cpuæŒ‡æ ‡ï¼ŒREPLICASæ˜¯æ ¹æ®è®¡ç®—åçš„å½“å‰podæ•°&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;ubuntu@k8s-m1:~/k8s/hpa$ kubectl get hpa\nNAME       REFERENCE            TARGETS             MINPODS   MAXPODS   REPLICAS   AGE\nhpa-test   Deployment/podinfo   120%/160%, 6%/75%   2         4         3          97m\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;å®˜æ–¹ç¤ºä¾‹è¿˜åŒ…æ‹¬packets-per-secondã€requests-per-secondè¿™äº›æŒ‡æ ‡ï¼Œéœ€è¦è¿›ä¸€æ­¥éªŒè¯&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;apiVersion: autoscaling/v2beta1\nkind: HorizontalPodAutoscaler\nmetadata:\n  name: php-apache\n  namespace: default\nspec:\n  scaleTargetRef:\n    apiVersion: apps/v1\n    kind: Deployment\n    name: php-apache\n  minReplicas: 1\n  maxReplicas: 10\n  metrics:\n  - type: Resource\n    resource:\n      name: cpu\n      target:\n        type: AverageUtilization\n        averageUtilization: 50\n  - type: Pods\n    pods:\n      metric:\n        name: packets-per-second\n      targetAverageValue: 1k\n  - type: Object\n    object:\n      metric:\n        name: requests-per-second\n      describedObject:\n        apiVersion: networking.k8s.io/v1beta1\n        kind: Ingress\n        name: main-route\n      target:\n        kind: Value\n        value: 10k\nstatus:\n  observedGeneration: 1\n  lastScaleTime: &amp;lt;some-time&amp;gt;\n  currentReplicas: 1\n  desiredReplicas: 1\n  currentMetrics:\n  - type: Resource\n    resource:\n      name: cpu\n    current:\n      averageUtilization: 0\n      averageValue: 0\n  - type: Object\n    object:\n      metric:\n        name: requests-per-second\n      describedObject:\n        apiVersion: networking.k8s.io/v1beta1\n        kind: Ingress\n        name: main-route\n      current:\n        value: 10k\n\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;a href=\&#34;https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale-walkthrough/#create-horizontal-pod-autoscaler\&#34;&gt;å®˜æ–¹hpaå‚æ•°&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;k8s-hpa-dan-xing-kuo-rong-pei-zhi&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;k8s hpaå¼¹æ€§æ‰©å®¹é…ç½®&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;hpa&#34;,&#34;slug&#34;:&#34;1VCnVUFme&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/1VCnVUFme/&#34;},{&#34;index&#34;:-1,&#34;name&#34;:&#34;k8s&#34;,&#34;slug&#34;:&#34;Q617Y3Kh2&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/Q617Y3Kh2/&#34;}],&#34;date&#34;:&#34;2020-05-19 13:24:13&#34;,&#34;dateFormat&#34;:&#34;2020-05-19&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;http://lvelvis.github.io/post/k8s-hpa-dan-xing-kuo-rong-pei-zhi/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;6 min read&#34;,&#34;time&#34;:328000,&#34;words&#34;:1211,&#34;minutes&#34;:6},&#34;description&#34;:&#34;HPAå…¨ç§°Horizontal Pod Autoscalingï¼Œæ˜¯K8så®ç°podè‡ªåŠ¨æ°´å¹³æ‰©å®¹ç¼©å®¹çš„ç‰¹æ€§ï¼Œè¿™ä¸ªç‰¹æ€§ä½¿æ•´ä¸ªkubernetesé›†ç¾¤é©¬ä¸Šé«˜å¤§ä¸Šèµ·æ¥äº†ã€‚\nè¦ä½¿ç”¨HPAä¹Ÿä¸æ˜¯è¿™ä¹ˆç®€å•çš„ï¼ŒHPA apiåˆ†v1ã€v2beta1ã€v2ba...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;&lt;a href=\&#34;#aggregation-layer\&#34;&gt;Aggregation Layer&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#metrics-server\&#34;&gt;metrics server&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#hpa\&#34;&gt;HPA&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;Go è¯­è¨€å†…éƒ¨å…¶å®å·²ç»æä¾›äº† http.ServeFileï¼Œé€šè¿‡è¿™ä¸ªå‡½æ•°å¯ä»¥å®ç°é™æ€æ–‡ä»¶çš„æœåŠ¡ã€‚&lt;/p&gt;\n&lt;p&gt;beego é’ˆå¯¹è¿™ä¸ªåŠŸèƒ½è¿›è¡Œäº†ä¸€å±‚å°è£…ï¼Œé€šè¿‡ä¸‹é¢çš„æ–¹å¼è¿›è¡Œé™æ€æ–‡ä»¶æ³¨å†Œï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;beego.SetStaticPath(&amp;quot;/static&amp;quot;,&amp;quot;public&amp;quot;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è·¯å¾„ï¼Œurl è·¯å¾„ä¿¡æ¯&lt;br&gt;\nç¬¬äºŒä¸ªå‚æ•°æ˜¯é™æ€æ–‡ä»¶ç›®å½•ï¼ˆç›¸å¯¹åº”ç”¨æ‰€åœ¨çš„ç›®å½•ï¼‰&lt;br&gt;\nbeego æ”¯æŒå¤šä¸ªç›®å½•çš„é™æ€æ–‡ä»¶æ³¨å†Œï¼Œç”¨æˆ·å¯ä»¥æ³¨å†Œå¦‚ä¸‹çš„é™æ€æ–‡ä»¶ç›®å½•ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;beego.SetStaticPath(&amp;quot;/images&amp;quot;,&amp;quot;images&amp;quot;)\nbeego.SetStaticPath(&amp;quot;/css&amp;quot;,&amp;quot;css&amp;quot;)\nbeego.SetStaticPath(&amp;quot;/js&amp;quot;,&amp;quot;js&amp;quot;)\n```ã€€ã€€\n\nè®¾ç½®äº†å¦‚ä¸Šçš„é™æ€ç›®å½•ä¹‹åï¼Œç”¨æˆ·è®¿é—® /images/login/login.pngï¼Œé‚£ä¹ˆå°±ä¼šè®¿é—®åº”ç”¨å¯¹åº”çš„ç›®å½•ä¸‹é¢çš„ images/login/login.png æ–‡ä»¶ã€‚\n\nå¦‚æœæ˜¯è®¿é—® /static/img/logo.pngï¼Œé‚£ä¹ˆå°±è®¿é—® public/img/logo.pngæ–‡ä»¶ã€‚\n\né»˜è®¤æƒ…å†µä¸‹ beego ä¼šåˆ¤æ–­ç›®å½•ä¸‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨ç›´æ¥è¿”å› 404 é¡µé¢ï¼Œå¦‚æœè¯·æ±‚çš„æ˜¯ index.htmlï¼Œé‚£ä¹ˆç”±äº http.ServeFile é»˜è®¤æ˜¯ä¼šè·³è½¬çš„ï¼Œä¸æä¾›è¯¥é¡µé¢çš„æ˜¾ç¤ºã€‚\n\nå› æ­¤ beego å¯ä»¥è®¾ç½® beego.BConfig.WebConfig.DirectoryIndex=true è¿™æ ·æ¥ä½¿å¾—æ˜¾ç¤º index.html é¡µé¢ã€‚è€Œä¸”å¼€å¯è¯¥åŠŸèƒ½ä¹‹åï¼Œç”¨æˆ·è®¿é—®ç›®å½•å°±ä¼šæ˜¾ç¤ºè¯¥ç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶åˆ—è¡¨ã€‚&lt;/code&gt;&lt;/pre&gt;\n&#34;,&#34;fileName&#34;:&#34;beego-jing-tai-wen-jian-jia-zai-lu-jing-xiu-gai&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;beegoé™æ€æ–‡ä»¶åŠ è½½è·¯å¾„ä¿®æ”¹&#34;,&#34;tags&#34;:[{&#34;index&#34;:-1,&#34;name&#34;:&#34;golang&#34;,&#34;slug&#34;:&#34;oHQV9cP9p&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/oHQV9cP9p/&#34;},{&#34;name&#34;:&#34;beego&#34;,&#34;slug&#34;:&#34;WCSltmB8m&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/WCSltmB8m/&#34;}],&#34;date&#34;:&#34;2020-05-11 12:49:08&#34;,&#34;dateFormat&#34;:&#34;2020-05-11&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;http://lvelvis.github.io/post/beego-jing-tai-wen-jian-jia-zai-lu-jing-xiu-gai/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;2 min read&#34;,&#34;time&#34;:77000,&#34;words&#34;:328,&#34;minutes&#34;:2},&#34;description&#34;:&#34;Go è¯­è¨€å†…éƒ¨å…¶å®å·²ç»æä¾›äº† http.ServeFileï¼Œé€šè¿‡è¿™ä¸ªå‡½æ•°å¯ä»¥å®ç°é™æ€æ–‡ä»¶çš„æœåŠ¡ã€‚\nbeego é’ˆå¯¹è¿™ä¸ªåŠŸèƒ½è¿›è¡Œäº†ä¸€å±‚å°è£…ï¼Œé€šè¿‡ä¸‹é¢çš„æ–¹å¼è¿›è¡Œé™æ€æ–‡ä»¶æ³¨å†Œï¼š\nbeego.SetStaticPath(&amp;quot;/static&amp;...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;p&gt;Ceph v0.55 åŠåç»­ç‰ˆæœ¬é»˜è®¤å¼€å¯äº† cephx è®¤è¯ã€‚ä»ç”¨æˆ·ç©ºé—´ï¼ˆ FUSE ï¼‰æŒ‚è½½ä¸€ Ceph æ–‡ä»¶ç³»ç»Ÿå‰ï¼Œç¡®ä¿å®¢æˆ·ç«¯ä¸»æœºæœ‰ä¸€ä»½ Ceph é…ç½®å‰¯æœ¬ã€å’Œå…·å¤‡ Ceph å…ƒæ•°æ®æœåŠ¡å™¨èƒ½åŠ›çš„å¯†é’¥ç¯ã€‚&lt;/p&gt;\n&lt;p&gt;1ã€ åœ¨å®¢æˆ·ç«¯ä¸»æœºä¸Šï¼ŒæŠŠç›‘è§†å™¨ä¸»æœºä¸Šçš„ Ceph é…ç½®æ–‡ä»¶æ‹·è´åˆ° /etc/ceph/ ç›®å½•ä¸‹&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;sudo mkdir -p /etc/ceph\nsudo scp {user}@{server-machine}:/etc/ceph/ceph.conf /etc/ceph/ceph.conf\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;2ã€ åœ¨å®¢æˆ·ç«¯ä¸»æœºä¸Šï¼ŒæŠŠç›‘è§†å™¨ä¸»æœºä¸Šçš„ Ceph å¯†é’¥ç¯æ‹·è´åˆ° /etc/ceph ç›®å½•ä¸‹&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;sudo scp {user}@{server-machine}:/etc/ceph/ceph.keyring /etc/ceph/ceph.keyring\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;3ã€ ç¡®ä¿å®¢æˆ·ç«¯æœºå™¨ä¸Šçš„ Ceph é…ç½®æ–‡ä»¶å’Œå¯†é’¥ç¯éƒ½æœ‰åˆé€‚çš„æƒé™ä½ï¼Œå¦‚ chmod 644 ã€‚&lt;br&gt;\ncephx å¦‚ä½•é…ç½®è¯·å‚è€ƒ CEPHX é…ç½®å‚è€ƒã€‚&lt;br&gt;\nè¦æŠŠ Ceph æ–‡ä»¶ç³»ç»ŸæŒ‚è½½ä¸ºç”¨æˆ·ç©ºé—´æ–‡ä»¶ç³»ç»Ÿï¼Œå¯ä»¥ç”¨ ceph-fuse å‘½ä»¤ï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;sudo mkdir /home/usernname/cephfs\nsudo ceph-fuse -m 192.168.0.1:6789 /home/username/cephfs\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;è¯¦æƒ…è§ &lt;a href=\&#34;http://docs.ceph.org.cn/man/8/ceph-fuse/\&#34;&gt;ceph-fuse&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;yong-hu-kong-jian-gua-zai-ceph-wen-jian-xi-tong&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;ç”¨æˆ·ç©ºé—´æŒ‚è½½ CEPH æ–‡ä»¶ç³»ç»Ÿ&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;rook-ceph&#34;,&#34;slug&#34;:&#34;hu0mNDfuy&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/hu0mNDfuy/&#34;}],&#34;date&#34;:&#34;2020-05-08 14:03:36&#34;,&#34;dateFormat&#34;:&#34;2020-05-08&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;http://lvelvis.github.io/post/yong-hu-kong-jian-gua-zai-ceph-wen-jian-xi-tong/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;2 min read&#34;,&#34;time&#34;:61000,&#34;words&#34;:242,&#34;minutes&#34;:2},&#34;description&#34;:&#34;Ceph v0.55 åŠåç»­ç‰ˆæœ¬é»˜è®¤å¼€å¯äº† cephx è®¤è¯ã€‚ä»ç”¨æˆ·ç©ºé—´ï¼ˆ FUSE ï¼‰æŒ‚è½½ä¸€ Ceph æ–‡ä»¶ç³»ç»Ÿå‰ï¼Œç¡®ä¿å®¢æˆ·ç«¯ä¸»æœºæœ‰ä¸€ä»½ Ceph é…ç½®å‰¯æœ¬ã€å’Œå…·å¤‡ Ceph å…ƒæ•°æ®æœåŠ¡å™¨èƒ½åŠ›çš„å¯†é’¥ç¯ã€‚\n1ã€ åœ¨å®¢æˆ·ç«¯ä¸»æœºä¸Šï¼ŒæŠŠç›‘è§†å™¨ä¸»æœº...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;h1 id=\&#34;é—®é¢˜\&#34;&gt;é—®é¢˜&lt;/h1&gt;\n&lt;pre&gt;&lt;code&gt;curl https://192.168.0.200:8443\næç¤ºcurl: (60) Peer&#39;s Certificate issuer is not recognized.\ncurl: (60) Peer&#39;s Certificate issuer is not recognized.\nMore details here: http://curl.haxx.se/docs/sslcerts.html\n\ncurl performs SSL certificate verification by default, using a &amp;quot;bundle&amp;quot;\n of Certificate Authority (CA) public keys (CA certs). If the default\n bundle file isn&#39;t adequate, you can specify an alternate file\n using the --cacert option.\nIf this HTTPS server uses a certificate signed by a CA represented in\n the bundle, the certificate verification probably failed due to a\n problem with the certificate (it might be expired, or the name might\n not match the domain name in the URL).\nIf you&#39;d like to turn off curl&#39;s verification of the certificate, use\n the -k (or --insecure) option.\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;mac-os-x\&#34;&gt;Mac OS X&lt;/h1&gt;\n&lt;h2 id=\&#34;æ·»åŠ è¯ä¹¦\&#34;&gt;æ·»åŠ è¯ä¹¦ï¼š&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;sudo security add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain ~/new-root-certificate.crt\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;ç§»é™¤è¯ä¹¦\&#34;&gt;ç§»é™¤è¯ä¹¦ï¼š&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;sudo security delete-certificate -c &amp;quot;&amp;lt;name of existing certificate&amp;gt;&amp;quot;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;windows\&#34;&gt;Windows&lt;/h1&gt;\n&lt;h2 id=\&#34;æ·»åŠ è¯ä¹¦-2\&#34;&gt;æ·»åŠ è¯ä¹¦ï¼š&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;certutil -addstore -f &amp;quot;ROOT&amp;quot; new-root-certificate.crt\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;ç§»é™¤è¯ä¹¦-2\&#34;&gt;ç§»é™¤è¯ä¹¦ï¼š&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;certutil -delstore &amp;quot;ROOT&amp;quot; serial-number-hex\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;linux-ubuntu-debian\&#34;&gt;Linux (Ubuntu, Debian)&lt;/h1&gt;\n&lt;h2 id=\&#34;æ·»åŠ è¯ä¹¦-3\&#34;&gt;æ·»åŠ è¯ä¹¦ï¼š&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;å¤åˆ¶ CA æ–‡ä»¶åˆ°ç›®å½•ï¼š /usr/local/share/ca-certificates/\næ‰§è¡Œ:\nsudo cp foo.crt /usr/local/share/ca-certificates/foo.crt\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;æ›´æ–°-ca-è¯ä¹¦åº“\&#34;&gt;æ›´æ–° CA è¯ä¹¦åº“:&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;sudo update-ca-certificates\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;ç§»é™¤è¯ä¹¦-3\&#34;&gt;ç§»é™¤è¯ä¹¦ï¼š&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;Remove your CA.\n\nUpdate the CA store:\n\nsudo update-ca-certificates --fresh\n\nRestart Kerio Connect to reload the certificates in the 32-bit versions or Debian 7.\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;linux-centos-6\&#34;&gt;Linux (CentOs 6)&lt;/h1&gt;\n&lt;h2 id=\&#34;æ·»åŠ è¯ä¹¦-4\&#34;&gt;æ·»åŠ è¯ä¹¦ï¼š&lt;/h2&gt;\n&lt;p&gt;// root-ca.crt ä¸ºcaè¯ä¹¦&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;å®‰è£… ca-certificates package:\n\nyum install ca-certificates\n\nå¯ç”¨dynamic CA configuration feature:\n\nupdate-ca-trust force-enable\n\nAdd it as a new file to /etc/pki/ca-trust/source/anchors/:\ncp root-ca.crt /etc/pki/ca-trust/source/anchors/\n\næ‰§è¡Œ:\n\nupdate-ca-trust extract\n\nRestart Kerio Connect to reload the certificates in the 32-bit version.\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;linux-centos-5\&#34;&gt;Linux (CentOs 5)&lt;/h1&gt;\n&lt;h2 id=\&#34;æ·»åŠ è¯ä¹¦-5\&#34;&gt;æ·»åŠ è¯ä¹¦ï¼š&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;Append your trusted certificate to file /etc/pki/tls/certs/ca-bundle.crt\n\ncat foo.crt &amp;gt;&amp;gt; /etc/pki/tls/certs/ca-bundle.crt\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;æµ‹è¯•è®¿é—®\&#34;&gt;æµ‹è¯•è®¿é—®&lt;/h1&gt;\n&lt;pre&gt;&lt;code&gt; curl -v &amp;quot;https:/gitlab.test.com/micro-lib/server?go-get=1&amp;quot;\n&lt;/code&gt;&lt;/pre&gt;\n&#34;,&#34;fileName&#34;:&#34;linux-ru-he-dao-ru-zi-ding-yi-zheng-shu&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;linuxå¦‚ä½•å¯¼å…¥è‡ªå®šä¹‰è¯ä¹¦&#34;,&#34;tags&#34;:[{&#34;index&#34;:-1,&#34;name&#34;:&#34;linux&#34;,&#34;slug&#34;:&#34;qf8arSPKY&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/qf8arSPKY/&#34;},{&#34;name&#34;:&#34;ssl&#34;,&#34;slug&#34;:&#34;EVZAZcQaN&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/EVZAZcQaN/&#34;}],&#34;date&#34;:&#34;2020-05-06 16:33:15&#34;,&#34;dateFormat&#34;:&#34;2020-05-06&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;http://lvelvis.github.io/post/linux-ru-he-dao-ru-zi-ding-yi-zheng-shu/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;3 min read&#34;,&#34;time&#34;:141000,&#34;words&#34;:406,&#34;minutes&#34;:3},&#34;description&#34;:&#34;é—®é¢˜\ncurl https://192.168.0.200:8443\næç¤ºcurl: (60) Peer&#39;s Certificate issuer is not recognized.\ncurl: (60) Peer&#39;s Certifica...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E9%97%AE%E9%A2%98\&#34;&gt;é—®é¢˜&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#mac-os-x\&#34;&gt;Mac OS X&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%B7%BB%E5%8A%A0%E8%AF%81%E4%B9%A6\&#34;&gt;æ·»åŠ è¯ä¹¦ï¼š&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%A7%BB%E9%99%A4%E8%AF%81%E4%B9%A6\&#34;&gt;ç§»é™¤è¯ä¹¦ï¼š&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#windows\&#34;&gt;Windows&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%B7%BB%E5%8A%A0%E8%AF%81%E4%B9%A6-2\&#34;&gt;æ·»åŠ è¯ä¹¦ï¼š&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%A7%BB%E9%99%A4%E8%AF%81%E4%B9%A6-2\&#34;&gt;ç§»é™¤è¯ä¹¦ï¼š&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#linux-ubuntu-debian\&#34;&gt;Linux (Ubuntu, Debian)&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%B7%BB%E5%8A%A0%E8%AF%81%E4%B9%A6-3\&#34;&gt;æ·»åŠ è¯ä¹¦ï¼š&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%9B%B4%E6%96%B0-ca-%E8%AF%81%E4%B9%A6%E5%BA%93\&#34;&gt;æ›´æ–° CA è¯ä¹¦åº“:&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%A7%BB%E9%99%A4%E8%AF%81%E4%B9%A6-3\&#34;&gt;ç§»é™¤è¯ä¹¦ï¼š&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#linux-centos-6\&#34;&gt;Linux (CentOs 6)&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%B7%BB%E5%8A%A0%E8%AF%81%E4%B9%A6-4\&#34;&gt;æ·»åŠ è¯ä¹¦ï¼š&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#linux-centos-5\&#34;&gt;Linux (CentOs 5)&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%B7%BB%E5%8A%A0%E8%AF%81%E4%B9%A6-5\&#34;&gt;æ·»åŠ è¯ä¹¦ï¼š&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%B5%8B%E8%AF%95%E8%AE%BF%E9%97%AE\&#34;&gt;æµ‹è¯•è®¿é—®&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;h3 id=\&#34;å‰æ\&#34;&gt;å‰æ&lt;/h3&gt;\n&lt;p&gt;ç”±äºistioéƒ¨ç½²åˆ°IDCã€éäº‘ç¯å¢ƒæ— æ³•è·å–å®¢æˆ·ç«¯çœŸå®IPåœ°å€ï¼Œwebåº”ç”¨æ— æ³•ä½¿ç”¨è¯¥ç»„ä»¶ï¼Œæ—©æœŸç‰ˆæœ¬çš„istioåšäº†å¾ˆå¤šæµ‹è¯•ï¼Œæœ€ç»ˆæ— æ³•å®ç°è·å–remote client addressï¼›&lt;/p&gt;\n&lt;h3 id=\&#34;ç¯å¢ƒ\&#34;&gt;ç¯å¢ƒ&lt;/h3&gt;\n&lt;p&gt;kubernetesç‰ˆæœ¬ï¼šk8s-1.16.9&lt;br&gt;\nistioç‰ˆæœ¬ï¼š1.5&lt;/p&gt;\n&lt;h3 id=\&#34;æ–¹æ³•\&#34;&gt;æ–¹æ³•&lt;/h3&gt;\n&lt;pre&gt;&lt;code&gt;kubectl -n istio-system edit  deployments. istio-pilot\næ·»åŠ å¦‚ä¸‹ï¼š\n       env:\n       - name: PILOT_SIDECAR_USE_REMOTE_ADDRESS\n          value: &amp;quot;true&amp;quot;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;ä»¥ä¸‹æ˜¯githubç›¸åº”çš„issue&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588232244321.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;h3 id=\&#34;å…¶ä»–æµ‹è¯•\&#34;&gt;å…¶ä»–æµ‹è¯•&lt;/h3&gt;\n&lt;p&gt;istio-1.5ç‰ˆæœ¬å›å½’å•ä½“ï¼Œå„ä¸ªç»„ä»¶ä¼˜åŒ–äº†å¾ˆå¤šï¼ŒåæœŸæµ‹è¯•httpé“¾æ¥ä¸tcpé“¾æ¥åº”ç”¨&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;istio-ke-hu-duan-yuan-di-zhi-ru-he-xian-shi&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;istio-å®¢æˆ·ç«¯æºåœ°å€å¦‚ä½•æ˜¾ç¤º&#34;,&#34;tags&#34;:[{&#34;index&#34;:-1,&#34;name&#34;:&#34;istio&#34;,&#34;slug&#34;:&#34;d8Hk7igEb&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/d8Hk7igEb/&#34;},{&#34;index&#34;:-1,&#34;name&#34;:&#34;k8s&#34;,&#34;slug&#34;:&#34;Q617Y3Kh2&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/Q617Y3Kh2/&#34;}],&#34;date&#34;:&#34;2020-04-30 15:32:39&#34;,&#34;dateFormat&#34;:&#34;2020-04-30&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;http://lvelvis.github.io/post/istio-ke-hu-duan-yuan-di-zhi-ru-he-xian-shi/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;1 min read&#34;,&#34;time&#34;:32000,&#34;words&#34;:133,&#34;minutes&#34;:1},&#34;description&#34;:&#34;å‰æ\nç”±äºistioéƒ¨ç½²åˆ°IDCã€éäº‘ç¯å¢ƒæ— æ³•è·å–å®¢æˆ·ç«¯çœŸå®IPåœ°å€ï¼Œwebåº”ç”¨æ— æ³•ä½¿ç”¨è¯¥ç»„ä»¶ï¼Œæ—©æœŸç‰ˆæœ¬çš„istioåšäº†å¾ˆå¤šæµ‹è¯•ï¼Œæœ€ç»ˆæ— æ³•å®ç°è·å–remote client addressï¼›\nç¯å¢ƒ\nkubernetesç‰ˆæœ¬ï¼šk8s-1.16...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%89%8D%E6%8F%90\&#34;&gt;å‰æ&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%8E%AF%E5%A2%83\&#34;&gt;ç¯å¢ƒ&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%96%B9%E6%B3%95\&#34;&gt;æ–¹æ³•&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%85%B6%E4%BB%96%E6%B5%8B%E8%AF%95\&#34;&gt;å…¶ä»–æµ‹è¯•&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;h1 id=\&#34;å‰æ\&#34;&gt;å‰æï¼š&lt;/h1&gt;\n&lt;p&gt;åœ¨kubernetesé›†ç¾¤ä¸­éƒ¨ç½²elkç»„ä»¶ï¼Œesé›†ç¾¤éƒ¨ç½²3ä¸ªèŠ‚ç‚¹ï¼Œkibanaéƒ¨ç½²ä¸€ä¸ªï¼Œå®¹å™¨æ•°æ®æŒä¹…åŒ–éœ€è¦storageclass&lt;/p&gt;\n&lt;p&gt;ä¾èµ–ï¼š&lt;br&gt;\nHelm&lt;br&gt;\nPersistent Volumes&lt;/p&gt;\n&lt;h1 id=\&#34;å‡†å¤‡é…ç½®\&#34;&gt;å‡†å¤‡é…ç½®&lt;/h1&gt;\n&lt;p&gt;ç”±äºrepoåœ¨çº¿å®‰è£…å¤ªæ…¢ï¼Œå»ºè®®ä¸‹è½½charæœ¬åœ°ä¿®æ”¹å‚æ•°åå®‰è£…&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git clone https://github.com/elastic/helm-charts.git\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;éƒ¨ç½²-elk\&#34;&gt;éƒ¨ç½² ELK&lt;/h1&gt;\n&lt;h2 id=\&#34;åˆ›å»ºelkå‘½åç©ºé—´\&#34;&gt;åˆ›å»ºelkå‘½åç©ºé—´&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;#cat elk-ns.yml\napiVersion: v1\nkind: Namespace\nmetadata:\n  name: elk\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;éƒ¨ç½²elasticsearch\&#34;&gt;éƒ¨ç½²elasticsearch&lt;/h2&gt;\n&lt;p&gt;cd helm-charts/elasticsearch&lt;/p&gt;\n&lt;p&gt;helm install --namespace=elk  --name=elasticsearch .&lt;/p&gt;\n&lt;h2 id=\&#34;éƒ¨ç½²-kibana\&#34;&gt;éƒ¨ç½² Kibana&lt;/h2&gt;\n&lt;p&gt;cd helm-charts/kibana&lt;/p&gt;\n&lt;p&gt;helm install --namespace=elk --name=kibana .&lt;br&gt;\né€šè¿‡ kubectl get deploy å’Œ pod äº†è§£éƒ¨ç½²çŠ¶æ€ï¼›&lt;/p&gt;\n&lt;h1 id=\&#34;å°çŸ¥è¯†\&#34;&gt;å°çŸ¥è¯†&lt;/h1&gt;\n&lt;p&gt;Kibana ç›´æ¥é€šè¿‡ K8S å†…éƒ¨ DNS åŸŸå è®¿é—® ESã€‚&lt;/p&gt;\n&lt;p&gt;æŸ¥çœ‹å®¹å™¨å†…çš„é…ç½®&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;kubectl  exec kibana-kibana-7cbc5db55c-6qct7 -c kibana -- cat /usr/share/kibana/config/kibana.yml\n\n# Default Kibana configuration for docker target\nserver.name: kibana\nserver.host: &amp;quot;0&amp;quot;\nelasticsearch.hosts: [ &amp;quot;http://elasticsearch:9200&amp;quot; ]\nxpack.monitoring.ui.container.elasticsearch.enabled: true\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;kibana-æ·»åŠ -ingress\&#34;&gt;Kibana æ·»åŠ  Ingress&lt;/h1&gt;\n&lt;p&gt;é€šè¿‡ Ingress æ·»åŠ è®¿é—®å…¥å£&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;apiVersion: extensions/v1beta1\nkind: Ingress\nmetadata:\n  name: kibana\n  namespace: default\nspec:\n  rules:\n  - host: &amp;lt;YourDomain&amp;gt;  ## è®¿é—® Kibana çš„åŸŸå \n    http:\n      paths:\n      - backend:\n          serviceName: kibana-kibana\n          servicePort: 5601\n        path: /\n status:\n  loadBalancer:\n    ingress:\n    - ip: &amp;lt;YourLoadBalancerIP&amp;gt;  ## LB çš„ IP\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&#34;è®¿é—®æµ‹è¯•\&#34;&gt;è®¿é—®æµ‹è¯•&lt;/h1&gt;\n&lt;p&gt;è®¿é—®åŸŸåï¼Œå³å¯æ‰“å¼€ Kibana 7.3 ç‰ˆæœ¬ï¼›&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588231324831.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;æŸ¥çœ‹é›†ç¾¤çš„è¿è¡ŒçŠ¶æ€&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;2\&#34;&gt;&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588231313286.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;ä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤è¡ŒæŸ¥çœ‹&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;~$ curl  -s &amp;lt;YourESHost&amp;gt;/_cluster/health | jq .\n{\n  &amp;quot;cluster_name&amp;quot;: &amp;quot;elasticsearch&amp;quot;,\n  &amp;quot;status&amp;quot;: &amp;quot;yellow&amp;quot;,\n  &amp;quot;timed_out&amp;quot;: false,\n  &amp;quot;number_of_nodes&amp;quot;: 3,\n  &amp;quot;number_of_data_nodes&amp;quot;: 3,\n  &amp;quot;active_primary_shards&amp;quot;: 19,\n  &amp;quot;active_shards&amp;quot;: 35,\n  &amp;quot;relocating_shards&amp;quot;: 0,\n  &amp;quot;initializing_shards&amp;quot;: 0,\n  &amp;quot;unassigned_shards&amp;quot;: 3,\n  &amp;quot;delayed_unassigned_shards&amp;quot;: 0,\n  &amp;quot;number_of_pending_tasks&amp;quot;: 0,\n  &amp;quot;number_of_in_flight_fetch&amp;quot;: 0,\n  &amp;quot;task_max_waiting_in_queue_millis&amp;quot;: 0,\n  &amp;quot;active_shards_percent_as_number&amp;quot;: 92.10526315789474\n}\n&lt;/code&gt;&lt;/pre&gt;\n&#34;,&#34;fileName&#34;:&#34;k8s-tong-guo-helm-bu-shu-elk-73&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;K8Sé€šè¿‡helm éƒ¨ç½² ELK 7.3&#34;,&#34;tags&#34;:[{&#34;index&#34;:-1,&#34;name&#34;:&#34;elk&#34;,&#34;slug&#34;:&#34;Diytd8lD3&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/Diytd8lD3/&#34;},{&#34;index&#34;:-1,&#34;name&#34;:&#34;k8s&#34;,&#34;slug&#34;:&#34;Q617Y3Kh2&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/Q617Y3Kh2/&#34;}],&#34;date&#34;:&#34;2020-04-30 15:12:33&#34;,&#34;dateFormat&#34;:&#34;2020-04-30&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;http://lvelvis.github.io/post/k8s-tong-guo-helm-bu-shu-elk-73/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;2 min read&#34;,&#34;time&#34;:111000,&#34;words&#34;:366,&#34;minutes&#34;:2},&#34;description&#34;:&#34;å‰æï¼š\nåœ¨kubernetesé›†ç¾¤ä¸­éƒ¨ç½²elkç»„ä»¶ï¼Œesé›†ç¾¤éƒ¨ç½²3ä¸ªèŠ‚ç‚¹ï¼Œkibanaéƒ¨ç½²ä¸€ä¸ªï¼Œå®¹å™¨æ•°æ®æŒä¹…åŒ–éœ€è¦storageclass\nä¾èµ–ï¼š\nHelm\nPersistent Volumes\nå‡†å¤‡é…ç½®\nç”±äºrepoåœ¨çº¿å®‰è£…å¤ªæ…¢ï¼Œå»ºè®®ä¸‹è½½...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%89%8D%E6%8F%90\&#34;&gt;å‰æï¼š&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%87%86%E5%A4%87%E9%85%8D%E7%BD%AE\&#34;&gt;å‡†å¤‡é…ç½®&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E9%83%A8%E7%BD%B2-elk\&#34;&gt;éƒ¨ç½² ELK&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%88%9B%E5%BB%BAelk%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4\&#34;&gt;åˆ›å»ºelkå‘½åç©ºé—´&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E9%83%A8%E7%BD%B2elasticsearch\&#34;&gt;éƒ¨ç½²elasticsearch&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E9%83%A8%E7%BD%B2-kibana\&#34;&gt;éƒ¨ç½² Kibana&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%B0%8F%E7%9F%A5%E8%AF%86\&#34;&gt;å°çŸ¥è¯†&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#kibana-%E6%B7%BB%E5%8A%A0-ingress\&#34;&gt;Kibana æ·»åŠ  Ingress&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%AE%BF%E9%97%AE%E6%B5%8B%E8%AF%95\&#34;&gt;è®¿é—®æµ‹è¯•&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;æœ€è¿‘åˆå‡ºæ¥ä¸ªkubesphereçš„å·¥å…·ç”¨æ¥ç®¡ç†k8sï¼Œä»Šå¤©ç‰¹æ„æ¥å®‰è£…ä½“éªŒä¸‹ï¼›&lt;br&gt;\ngithubåœ°å€ï¼šhttps://github.com/pixiake/ks-installer&lt;/p&gt;\n&lt;p&gt;å®˜æ–¹ä½¿ç”¨æ–‡æ¡£ï¼šhttps://kubesphere.io/docs/advanced-v2.0/zh-CN/installation/all-in-one/&lt;/p&gt;\n&lt;p&gt;å…ˆæ”¾ä¸Šå®‰è£…æ•ˆæœå›¾ï¼ŒUIç•Œé¢è¿˜æ˜¯å¾ˆæ¸…çˆ½çš„ï¼š&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588152934567.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;h3 id=\&#34;å½“å‰ç¯å¢ƒ\&#34;&gt;å½“å‰ç¯å¢ƒï¼š&lt;/h3&gt;\n&lt;pre&gt;&lt;code&gt;k8sé›†ç¾¤å·²ç»å®‰è£…å®Œæˆï¼Œç”¨kubesphereç®¡ç†ç°æœ‰çš„k8sé›†ç¾¤ï¼›\n\nk8sç‰ˆæœ¬ä¸º1.14  \n\nç³»ç»Ÿä¸ºcentos7.6\n\nkubesphereä½¿ç”¨è¦æ±‚ï¼š\n\nkubernetes version &amp;gt; 1.13.0\n\nhelm version &amp;gt; 2.10.0\n\na default storage class must be in kubernetes cluster\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;å®‰è£…å®Œæˆåé»˜è®¤ç”¨æˆ·åå¯†ç ï¼š&lt;/p&gt;\n&lt;p&gt;ç”¨æˆ·åï¼šadmin&lt;/p&gt;\n&lt;p&gt;å¯†ç ï¼šP@88w0rd&lt;/p&gt;\n&lt;h3 id=\&#34;å¼€å§‹å®‰è£…\&#34;&gt;å¼€å§‹å®‰è£…&lt;/h3&gt;\n&lt;p&gt;å®‰è£…æ­¥éª¤å¤§æ¦‚è®°å½•ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;kubectl create ns kubesphere-system\nkubectl create ns kubesphere-monitoring-system\n\n#è®¿é—®etcdç”¨åˆ°çš„secret\nkubectl -n kubesphere-monitoring-system create secret generic kube-etcd-client-certs  --from-file=etcd-client-ca.crt=ca.pem  --from-file=etcd-client.crt=etcd-key.pem  --from-file=etcd-client.key=etcd.pem\n\n#ç®¡ç†k8sç”¨åˆ°çš„secret\n\nkubectl -n kubesphere-system create secret generic kubesphere-ca  --from-file=ca.crt=ca.pem --from-file=ca.key=ca-key.pem\n\n#cloneå¥½githubé¡¹ç›®ï¼Œæ‰§è¡Œä¸‹é¢çš„è¿™æ¡å‘½ä»¤\n\ncd deploy\nkubectl apply -f kubesphere-installer.yaml\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;æ‰§è¡Œå®Œä¸Šé¢çš„å‘½ä»¤ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤ï¼ŒæŸ¥çœ‹å®‰è£…è¿‡ç¨‹æ—¥å¿—&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;kubectl logs -n kubesphere-system $(kubectl get pod -n kubesphere-system -l job-name=kubesphere-installer -o jsonpath=&#39;{.items[0].metadata.name}&#39;) -f\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;æŸ¥çœ‹å®‰è£…ç»“æœï¼ŒSTATUSè·Ÿä¸‹é¢ä¿æŒä¸€è‡´æ‰è¯´æ˜å®‰è£…æˆåŠŸ&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;[root@ks-allinone deploy]# kubectl get pods -n kubesphere-system\nNAME                                     READY   STATUS      RESTARTS   AGE\nks-account-6db466d8dc-srrwj              1/1     Running     0          149m\nks-apigateway-7d77cb9495-jzmg6           1/1     Running     0          170m\nks-apiserver-f8469fd47-b58rm             1/1     Running     0          166m\nks-console-54c849bdc9-dfkbf              1/1     Running     0          168m\nks-console-54c849bdc9-z2d5q              1/1     Running     0          168m\nks-controller-manager-569456b4cd-gngm5   1/1     Running     0          170m\nks-docs-6bbdcc9bfb-6jldz                 1/1     Running     0          3h7m\nkubesphere-installer-7ph6l               0/1     Completed   1          3h11m\nopenldap-5c986c5bff-rzqwv                1/1     Running     0          3h25m\nredis-76dc4db5dd-lv6kg                   1/1     Running     0          149m\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&#34;å®‰è£…è¿‡ç¨‹å‡ºç°çš„é”™è¯¯\&#34;&gt;å®‰è£…è¿‡ç¨‹å‡ºç°çš„é”™è¯¯&lt;/h3&gt;\n&lt;p&gt;1.åœ¨å®‰è£…çš„æ—¶æç¤ºmetrics-serverå·²ç»å®‰è£…ï¼Œå¯¼è‡´å®‰è£…ä¸­æ–­ï¼›&lt;/p&gt;\n&lt;p&gt;è§£æåŠæ³•ï¼šåœ¨kubesphere-installer.yamlçš„configMapå¢åŠ é…ç½®ï¼šmetrics_server_enable: Falseï¼ˆé»˜è®¤æ˜¯æ²¡æœ‰çš„ï¼‰&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;apiVersion: v1\ndata:\n  ks-config.yaml: |\n    kube_apiserver_host: 10.10.5.208:6443\n    etcd_tls_enable: True\n    etcd_endpoint_ips: 10.10.5.169,10.10.5.183,10.10.5.184\n    disableMultiLogin: True\n    elk_prefix: logstash\n    metrics_server_enable: False\n  #  local_registry: 192.168.1.2:5000\nkind: ConfigMap\nmetadata:\n  name: kubesphere-config\n  namespace: kubesphere-system\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;å¢åŠ Ingressé…ç½®ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;apiVersion: extensions/v1beta1\nkind: Ingress\nmetadata:\n  name: kubesphere\n  namespace: kubesphere-system\n  annotations:\n    #kubernetes.io/ingress.class: traefik\n    kubernetes.io/ingress.class: nginx\nspec:\n  rules:\n  - host: ks.staplescn.com\n    http:\n      paths:\n      - path:\n        backend:\n          serviceName: ks-console\n          servicePort: 80\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;è®¿é—®ç•Œé¢ï¼š&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588153130667.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;kubesphere-an-zhuang-shi-yong-ti-yan&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;kubesphereå®‰è£…ä½¿ç”¨ä½“éªŒ&#34;,&#34;tags&#34;:[{&#34;index&#34;:-1,&#34;name&#34;:&#34;kubesphere&#34;,&#34;slug&#34;:&#34;BU7sbQs51&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/BU7sbQs51/&#34;},{&#34;index&#34;:-1,&#34;name&#34;:&#34;k8s&#34;,&#34;slug&#34;:&#34;Q617Y3Kh2&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/Q617Y3Kh2/&#34;}],&#34;date&#34;:&#34;2020-04-29 17:33:05&#34;,&#34;dateFormat&#34;:&#34;2020-04-29&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;http://lvelvis.github.io/post/kubesphere-an-zhuang-shi-yong-ti-yan/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;3 min read&#34;,&#34;time&#34;:176000,&#34;words&#34;:576,&#34;minutes&#34;:3},&#34;description&#34;:&#34;æœ€è¿‘åˆå‡ºæ¥ä¸ªkubesphereçš„å·¥å…·ç”¨æ¥ç®¡ç†k8sï¼Œä»Šå¤©ç‰¹æ„æ¥å®‰è£…ä½“éªŒä¸‹ï¼›\ngithubåœ°å€ï¼šhttps://github.com/pixiake/ks-installer\nå®˜æ–¹ä½¿ç”¨æ–‡æ¡£ï¼šhttps://kubesphere.io/doc...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%BD%93%E5%89%8D%E7%8E%AF%E5%A2%83\&#34;&gt;å½“å‰ç¯å¢ƒï¼š&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%BC%80%E5%A7%8B%E5%AE%89%E8%A3%85\&#34;&gt;å¼€å§‹å®‰è£…&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%AE%89%E8%A3%85%E8%BF%87%E7%A8%8B%E5%87%BA%E7%8E%B0%E7%9A%84%E9%94%99%E8%AF%AF\&#34;&gt;å®‰è£…è¿‡ç¨‹å‡ºç°çš„é”™è¯¯&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;h1 id=\&#34;å‰è¨€\&#34;&gt;å‰è¨€&lt;/h1&gt;\n&lt;p&gt;æˆ‘ä»¬é€šå¸¸çš„å¼€å‘æµç¨‹æ˜¯ï¼Œåœ¨æœ¬åœ°å¼€å‘å®Œæˆåº”ç”¨ä¹‹åï¼Œä½¿ç”¨gitä½œä¸ºç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œå°†æœ¬åœ°ä»£ç æäº¤åˆ°ç±»ä¼¼Githubè¿™æ ·çš„ä»“åº“ä¸­åšæŒä¹…åŒ–å­˜å‚¨ï¼Œå½“æˆ‘ä»¬å¯èƒ½æ¥è‡ªå¤šä¸ªä»“åº“ã€å¯èƒ½æ¶‰åŠåˆ°å¤šä¸ªä¸­é—´ä»¶ä½œä¸ºåº•å±‚ä¾èµ–ä¸€èµ·éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¸­æ—¶ï¼Œç›¸ä¿¡ä¸å°‘åœ¨å¤§ä¸­å‹ä¼ä¸šå·¥ä½œçš„å°ä¼™ä¼´éƒ½çŸ¥é“å…¬å¸å†…éƒ¨é€šå¸¸ä¼šæœ‰å‘å¸ƒç³»ç»Ÿï¼Œé‚£ä¹ˆäº‘åŸç”ŸæŠ€æœ¯æ ˆä¸­æœ‰æ²¡æœ‰ä¸ºæˆ‘ä»¬æä¾›ç±»ä¼¼çš„å‘å¸ƒç³»ç»Ÿå‘¢ï¼Ÿæ¡£æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œè€Œä¸”ä¸ä¹ç«äº‰è€…ï¼Œä¸šå†…çŸ¥åçš„æœ‰knavtie Build/jekinsX/spinnaker/orgo/tektonï¼Œå…¶ä¸­ï¼Œtekonå‡­å€Ÿå…¶ä¼—å¤šä¼˜è‰¯ç‰¹æ€§åœ¨ä¸€ä¼—ç«äº‰è€…ä¸­èƒœå‡ºï¼Œæˆä¸ºé¢†åŸŸå†…çš„äº‹å®æ ‡å‡†ï¼Œä»Šå¤©æˆ‘ä»¬å°±æ¥æ­å¼€Tektonçš„ç¥ç§˜é¢çº±ã€‚&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588236885419.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;h1 id=\&#34;æ­£æ–‡\&#34;&gt;æ­£æ–‡&lt;/h1&gt;\n&lt;h3 id=\&#34;ä»€ä¹ˆæ˜¯tekton\&#34;&gt;ä»€ä¹ˆæ˜¯Tekton&lt;/h3&gt;\n&lt;p&gt;&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588236902661.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\né‚£Tektonéƒ½æä¾›äº†å“ªäº›CRDå‘¢ï¼Ÿ&lt;br&gt;\nâ€¢\tTaskï¼šé¡¾åæ€ä¹‰ï¼Œtaskè¡¨ç¤ºä¸€ä¸ªæ„å»ºä»»åŠ¡ï¼Œtaské‡Œå¯ä»¥å®šä¹‰ä¸€ç³»åˆ—çš„stepsï¼Œä¾‹å¦‚ç¼–è¯‘ä»£ç ã€æ„å»ºé•œåƒã€æ¨é€é•œåƒç­‰ï¼Œæ¯ä¸ªstepå®é™…ç”±ä¸€ä¸ªPodæ‰§è¡Œã€‚&lt;br&gt;\nâ€¢\tTaskRunï¼štaskåªæ˜¯å®šä¹‰äº†ä¸€ä¸ªæ¨¡ç‰ˆï¼ŒtaskRunæ‰çœŸæ­£ä»£è¡¨äº†ä¸€æ¬¡å®é™…çš„è¿è¡Œï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥è‡ªå·±æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªtaskRunï¼ŒtaskRunåˆ›å»ºå‡ºæ¥ä¹‹åï¼Œå°±ä¼šè‡ªåŠ¨è§¦å‘taskæè¿°çš„æ„å»ºä»»åŠ¡ã€‚&lt;br&gt;\nâ€¢\tPipelineï¼šä¸€ä¸ªæˆ–å¤šä¸ªtaskã€PipelineResourceä»¥åŠå„ç§å®šä¹‰å‚æ•°çš„é›†åˆã€‚&lt;br&gt;\nâ€¢\tPipelineRunï¼šç±»ä¼¼taskå’ŒtaskRunçš„å…³ç³»ï¼ŒpipelineRunä¹Ÿè¡¨ç¤ºæŸä¸€æ¬¡å®é™…è¿è¡Œçš„pipelineï¼Œä¸‹å‘ä¸€ä¸ªpipelineRun CRDå®ä¾‹åˆ°kubernetesåï¼ŒåŒæ ·ä¹Ÿä¼šè§¦å‘ä¸€æ¬¡pipelineçš„æ„å»ºã€‚&lt;br&gt;\nâ€¢\tPipelineResourceï¼šè¡¨ç¤ºpipeline inputèµ„æºï¼Œæ¯”å¦‚githubä¸Šçš„æºç ï¼Œæˆ–è€…pipeline outputèµ„æºï¼Œä¾‹å¦‚ä¸€ä¸ªå®¹å™¨é•œåƒæˆ–è€…æ„å»ºç”Ÿæˆçš„jaråŒ…ç­‰ã€‚&lt;br&gt;\nä»–ä»¬å¤§æ¦‚æœ‰å¦‚ä¸‹å›¾æ‰€ç¤ºçš„å…³ç³»ï¼š&lt;br&gt;\nå®˜æ–¹ä»‹ç»ï¼š&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;Tekton æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ä¸”çµæ´»çš„ Kubernetes åŸç”Ÿå¼€æºæ¡†æ¶ï¼Œç”¨äºåˆ›å»ºæŒç»­é›†æˆå’Œäº¤ä»˜ï¼ˆCI/CDï¼‰ç³»ç»Ÿã€‚é€šè¿‡æŠ½è±¡åº•å±‚å®ç°ç»†èŠ‚ï¼Œç”¨æˆ·å¯ä»¥è·¨å¤šäº‘å¹³å°å’Œæœ¬åœ°ç³»ç»Ÿè¿›è¡Œæ„å»ºã€æµ‹è¯•å’Œéƒ¨ç½²ã€‚\n&lt;/code&gt;&lt;/pre&gt;\n&lt;pre&gt;&lt;code&gt;ä¸ªäººç†è§£ï¼š\nâ€¢\tä»¥yamlæ–‡ä»¶ç¼–æ’åº”ç”¨æ„å»ºåŠéƒ¨ç½²æµç¨‹\nâ€¢\tknavtive buildæ¨¡å—å‡çº§ç‰ˆï¼Œç¤¾åŒºæœ€ç»ˆé‡‡ç”¨ Tekton æ›¿ä»£ knavtive Buildä½œä¸ºäº‘åŸç”Ÿé¢†åŸŸçš„CI/CD è§£å†³æ–¹æ¡ˆ\nâ€¢\tæ ‡å‡†åŒ–CI/CDæµæ°´çº¿æ„å»ºã€æµ‹è¯•åŠéƒ¨ç½²æµç¨‹çš„å·¥å…·\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Tektonåœ¨ä¸€ä¼—ç«äº‰å¯¹æ‰‹çš„æ¯”æ‹¼ä¸­PKèƒœå‡ºï¼š&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588236947460.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;ä¸‹é¢å°±è®©æˆ‘ä»¬ä¸€èµ·æ¥æ·±å…¥è¯¦ç»†äº†è§£ä¸‹Tektonåˆ°åº•æ€ä¹ˆç©ã€‚&lt;br&gt;\nTekton Pipelineä¸­æœ‰5ç±»å¯¹è±¡ï¼Œæ ¸å¿ƒç†å¿µæ˜¯é€šè¿‡å®šä¹‰yamlå®šä¹‰æ„å»ºè¿‡ç¨‹ã€‚&lt;br&gt;\nâ€¢\tTaskï¼šä¸€ä¸ªä»»åŠ¡çš„æ‰§è¡Œæ¨¡æ¿ï¼Œç”¨äºæè¿°å•ä¸ªä»»åŠ¡çš„æ„å»ºè¿‡ç¨‹&lt;br&gt;\nâ€¢\tTaskRunï¼šéœ€è¦é€šè¿‡å®šä¹‰TaskRunä»»åŠ¡å»è¿è¡ŒTaskã€‚&lt;br&gt;\nâ€¢\tPipelineï¼šåŒ…å«å¤šä¸ªTask,å¹¶åœ¨æ­¤åŸºç¡€ä¸Šå®šä¹‰inputå’Œoutput,inputå’Œoutputä»¥PipelineResourceä½œä¸ºäº¤ä»˜ã€‚&lt;br&gt;\nâ€¢\tPipelineRunï¼šéœ€è¦å®šä¹‰PipelineRunæ‰ä¼šè¿è¡ŒPipelineã€‚&lt;br&gt;\nâ€¢\tPipelineResourceï¼šå¯ç”¨äºinputå’Œoutputçš„å¯¹è±¡é›†åˆã€‚&lt;/p&gt;\n&lt;h3 id=\&#34;task\&#34;&gt;Task&lt;/h3&gt;\n&lt;p&gt;Task å°±æ˜¯ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œæ¨¡æ¿ï¼Œä¹‹æ‰€ä»¥è¯´ Task æ˜¯ä¸€ä¸ªæ¨¡æ¿æ˜¯å› ä¸º Task å®šä¹‰ä¸­å¯ä»¥åŒ…å«å˜é‡ï¼ŒTask åœ¨çœŸæ­£æ‰§è¡Œçš„æ—¶å€™éœ€è¦ç»™å®šå˜é‡çš„å…·ä½“å€¼ã€‚å¦‚æœæŠŠ Tekton çš„ Task æœ‰ç‚¹å„¿ç±»ä¼¼äºå®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼ŒTask é€šè¿‡ inputs.params å®šä¹‰éœ€è¦å“ªäº›å…¥å‚ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªå…¥å‚è¿˜å¯ä»¥æŒ‡å®šé»˜è®¤å€¼ã€‚Task çš„ steps å­—æ®µè¡¨ç¤ºå½“å‰ Task æ˜¯æœ‰å“ªäº›æ­¥éª¤ç»„æˆçš„ï¼Œæ¯ä¸€ä¸ªæ­¥éª¤å…·ä½“å°±æ˜¯åŸºäºé•œåƒå¯åŠ¨ä¸€ä¸ª container æ‰§è¡Œä¸€äº›æ“ä½œï¼Œcontainer çš„å¯åŠ¨å‚æ•°å¯ä»¥é€šè¿‡ Task çš„å…¥å‚ä½¿ç”¨æ¨¡æ¿è¯­æ³•è¿›è¡Œé…ç½®ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªDemoï¼š&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588236983683.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;h3 id=\&#34;taskrun\&#34;&gt;TaskRun&lt;/h3&gt;\n&lt;p&gt;Task å®šä¹‰å¥½ä»¥åæ˜¯ä¸èƒ½æ‰§è¡Œçš„ï¼Œå°±åƒä¸€ä¸ªå‡½æ•°å®šä¹‰å¥½ä»¥åéœ€è¦è°ƒç”¨æ‰èƒ½æ‰§è¡Œä¸€æ ·ã€‚æ‰€ä»¥éœ€è¦å†å®šä¹‰ä¸€ä¸ª TaskRun å»æ‰§è¡Œ Taskã€‚&lt;br&gt;\nTaskRun ä¸»è¦æ˜¯è´Ÿè´£è®¾ç½® Task éœ€è¦çš„å‚æ•°ï¼Œå¹¶é€šè¿‡ taskRef å­—æ®µå¼•ç”¨è¦æ‰§è¡Œçš„ Taskã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªDemoï¼š&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588237005091.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;ä½†æ˜¯åœ¨å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬å¾ˆå°‘ä½¿ç”¨TaskRunï¼Œå› ä¸ºå®ƒåªèƒ½ç»™ä¸ä¸€ä¸ªTask ä¼ å‚ï¼ŒTektonæä¾›äº†ç»™å¤šä¸ªTaskåŒæ—¶ä¼ å‚çš„è§£å†³æ–¹æ¡ˆPipelineå’ŒPipelineRunï¼Œä¸”çœ‹ä¸‹æ–‡è¯¦è§£ï¼Œè¿™é‡Œåªæ˜¯å¤šå˜´ä¸€ä¸‹ï¼Œè¿™ä¸ªTaskRunå¾ˆå°‘ä½¿ç”¨ï¼Œç¨å¾®äº†è§£ä¸‹å°±å¯ä»¥äº†ã€‚&lt;/p&gt;\n&lt;h3 id=\&#34;pipeline\&#34;&gt;Pipeline&lt;/h3&gt;\n&lt;p&gt;ä¸€ä¸ª TaskRun åªèƒ½æ‰§è¡Œä¸€ä¸ª Taskï¼Œå½“éœ€è¦ç¼–æ’å¤šä¸ª Task çš„æ—¶å€™å°±éœ€è¦ Pipeline å‡ºé©¬äº†ã€‚Pipeline æ˜¯ä¸€ä¸ªç¼–æ’ Task çš„æ¨¡æ¿ã€‚Pipeline çš„ params å£°æ˜äº†æ‰§è¡Œæ—¶éœ€è¦çš„å…¥å‚ã€‚ Pipeline çš„ spec.tasks å®šä¹‰äº†éœ€è¦ç¼–æ’çš„ Taskã€‚Tasks æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­çš„ task å¹¶ä¸æ˜¯é€šè¿‡æ•°ç»„å£°æ˜çš„é¡ºåºå»æ‰§è¡Œçš„ï¼Œè€Œæ˜¯é€šè¿‡ runAfter æ¥å£°æ˜ task æ‰§è¡Œçš„é¡ºåºã€‚Tekton controller åœ¨è§£æ CRD çš„æ—¶å€™ä¼šè§£æ Task çš„é¡ºåºï¼Œç„¶åæ ¹æ® runAfter è®¾ç½®ç”Ÿæˆçš„ä¾æ¬¡æ ‘ä¾æ¬¡å»æ‰§è¡Œã€‚Pipeline åœ¨ç¼–æ’ Task çš„æ—¶å€™éœ€è¦ç»™æ¯ä¸€ä¸ª Task ä¼ å…¥å¿…é¡»çš„å‚æ•°ï¼Œè¿™äº›å‚æ•°çš„å€¼å¯ä»¥æ¥è‡ª Pipeline è‡ªèº«çš„ params è®¾ç½®ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªDemoï¼š&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588237033509.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588237113343.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;h3 id=\&#34;pipelinerun\&#34;&gt;PipelineRun&lt;/h3&gt;\n&lt;p&gt;å’Œ Task ä¸€æ · Pipeline å®šä¹‰å®Œæˆä»¥åä¹Ÿæ˜¯ä¸èƒ½ç›´æ¥æ‰§è¡Œçš„ï¼Œéœ€è¦ PipelineRun æ‰èƒ½æ‰§è¡Œ Pipelineã€‚PipelineRun çš„ä¸»è¦ä½œç”¨æ˜¯ç»™ Pipeline ä¼ å…¥å¿…è¦çš„å…¥å‚ï¼Œå¹¶æ‰§è¡Œ Pipelineã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªDemoï¼š&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588237145814.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588237151158.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;h3 id=\&#34;pipelineresource\&#34;&gt;PipelineResource&lt;/h3&gt;\n&lt;p&gt;å¯èƒ½ä½ è¿˜æƒ³åœ¨ Task ä¹‹é—´å…±äº«èµ„æºï¼Œè¿™å°±æ˜¯ PipelineResource çš„ä½œç”¨ã€‚æ¯”å¦‚æˆ‘ä»¬å¯ä»¥æŠŠ git ä»“åº“ä¿¡æ¯æ”¾åœ¨ PipelineResource ä¸­ã€‚è¿™æ ·æ‰€æœ‰ Task å°±å¯ä»¥å…±äº«è¿™äº›ä¿¡æ¯äº†ã€‚&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588237189249.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588237194640.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588237221271.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;h1 id=\&#34;å®æˆ˜\&#34;&gt;å®æˆ˜&lt;/h1&gt;\n&lt;p&gt;å…³äºTektonçš„å®æˆ˜ï¼Œå¯ä»¥å‚è€ƒGithubé‡Œé¢çš„è¿™ä¸ªå®Œæ•´çš„Demoï¼Œé‡Œé¢æ˜¯ä¸€ä¸ªgoè¯­è¨€å§ç¼–å†™çš„webæœåŠ¡ï¼Œæ¥å£å¯ä»¥æ‰“å°&amp;quot;Hello world&amp;quot;ã€‚æ—¶é—´æœ‰é™ï¼Œå°±ä¸åšæ¼”ç¤ºäº†ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥åœ¨è‡ªå·±çš„k8sé›†ç¾¤ä¸Šé¢è·‘ä¸€ä¸‹æ„Ÿå—ä¸€ä¸‹ï¼Œç›¸å…³çš„yamlæ–‡ä»¶ä¹Ÿå¯ä»¥æ‹·è´ä¸‹æ¥ï¼Œä½œä¸ºåé¢æ”¹å†™çš„æ¨¡æ¿ã€‚&lt;br&gt;\nå‡†å¤‡ PIpeline çš„èµ„æº&lt;br&gt;\nkubectl apply -f tasks/source-to-image.yaml -f tasks/deploy-using-kubectl.yaml  -f resources/picalc-git.yaml -f image-secret.yaml -f pipeline-account.yaml -f pipeline/build-and-deploy-pipeline.yaml&lt;br&gt;\næ‰§è¡Œ create æŠŠ pipelieRun æäº¤åˆ° Kubernetes é›†ç¾¤ã€‚ä¹‹æ‰€ä»¥è¿™é‡Œä½¿ç”¨ create è€Œä¸æ˜¯ä½¿ç”¨ apply æ˜¯å› ä¸º PIpelineRun æ¯æ¬¡éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ï¼Œkubectl çš„ create æŒ‡ä»¤ä¼šåŸºäº generateName åˆ›å»ºæ–°çš„ PIpelineRun èµ„æºã€‚&lt;br&gt;\nkubectl create -f run/picalc-pipeline-run.yaml&lt;/p&gt;\n&lt;h1 id=\&#34;æ€»ç»“\&#34;&gt;æ€»ç»“&lt;/h1&gt;\n&lt;p&gt;Tektonä»¥K8Sä¸ºä¾æ‰˜ï¼Œæˆä¸ºäº‘åŸç”Ÿé¢†åŸŸCI/CDçš„äº‹å®æ€§æ ‡å‡†ï¼Œå¸®åŠ©æˆ‘ä»¬æé«˜äº‘åŸç”Ÿç¯å¢ƒä¸‹çš„åº”ç”¨æ„å»ºå’Œéƒ¨ç½²æ•ˆç‡ã€‚&lt;br&gt;\næ¥ä¸€å¼ å›¾å¯¹å…¨æ–‡åšä¸€ä¸ªç®€å•çš„æ€»ç»“ï¼š&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588236724398.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;h1 id=\&#34;å‚è€ƒèµ„æ–™\&#34;&gt;å‚è€ƒèµ„æ–™&lt;/h1&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;a href=\&#34;https://cloud.google.com/tekton/\&#34;&gt;Tektonå®˜ç½‘&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://github.com/knative-sample/tekton-knative/tree/b1.0?spm=ata.13261165.0.0.21213a182xyMm5&amp;amp;file=b1.0\&#34;&gt;Tekton Demo&lt;/a&gt;&lt;/li&gt;\n&lt;/ol&gt;\n&#34;,&#34;fileName&#34;:&#34;kubernetes-tekton-cicd-chi-xu-ji-cheng-liu-shui-xian&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;kubernetes Tekton-CI/CD æŒç»­é›†æˆæµæ°´çº¿&#34;,&#34;tags&#34;:[{&#34;index&#34;:-1,&#34;name&#34;:&#34;tekton&#34;,&#34;slug&#34;:&#34;nN9-7w-_h&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/nN9-7w-_h/&#34;},{&#34;index&#34;:-1,&#34;name&#34;:&#34;k8s&#34;,&#34;slug&#34;:&#34;Q617Y3Kh2&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/Q617Y3Kh2/&#34;}],&#34;date&#34;:&#34;2020-01-20 16:48:40&#34;,&#34;dateFormat&#34;:&#34;2020-01-20&#34;,&#34;feature&#34;:&#34;http://lvelvis.github.io/post-images/kubernetes-tekton-cicd-chi-xu-ji-cheng-liu-shui-xian.png&#34;,&#34;link&#34;:&#34;http://lvelvis.github.io/post/kubernetes-tekton-cicd-chi-xu-ji-cheng-liu-shui-xian/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;7 min read&#34;,&#34;time&#34;:363000,&#34;words&#34;:1633,&#34;minutes&#34;:7},&#34;description&#34;:&#34;å‰è¨€\næˆ‘ä»¬é€šå¸¸çš„å¼€å‘æµç¨‹æ˜¯ï¼Œåœ¨æœ¬åœ°å¼€å‘å®Œæˆåº”ç”¨ä¹‹åï¼Œä½¿ç”¨gitä½œä¸ºç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œå°†æœ¬åœ°ä»£ç æäº¤åˆ°ç±»ä¼¼Githubè¿™æ ·çš„ä»“åº“ä¸­åšæŒä¹…åŒ–å­˜å‚¨ï¼Œå½“æˆ‘ä»¬å¯èƒ½æ¥è‡ªå¤šä¸ªä»“åº“ã€å¯èƒ½æ¶‰åŠåˆ°å¤šä¸ªä¸­é—´ä»¶ä½œä¸ºåº•å±‚ä¾èµ–ä¸€èµ·éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¸­æ—¶ï¼Œç›¸ä¿¡ä¸å°‘åœ¨å¤§ä¸­å‹ä¼ä¸šå·¥...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%89%8D%E8%A8%80\&#34;&gt;å‰è¨€&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%AD%A3%E6%96%87\&#34;&gt;æ­£æ–‡&lt;/a&gt;&lt;br&gt;\n*\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E4%BB%80%E4%B9%88%E6%98%AFtekton\&#34;&gt;ä»€ä¹ˆæ˜¯Tekton&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#task\&#34;&gt;Task&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#taskrun\&#34;&gt;TaskRun&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#pipeline\&#34;&gt;Pipeline&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#pipelinerun\&#34;&gt;PipelineRun&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#pipelineresource\&#34;&gt;PipelineResource&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%AE%9E%E6%88%98\&#34;&gt;å®æˆ˜&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%80%BB%E7%BB%93\&#34;&gt;æ€»ç»“&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99\&#34;&gt;å‚è€ƒèµ„æ–™&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;h1 id=\&#34;ç®€ä»‹\&#34;&gt;ç®€ä»‹&lt;/h1&gt;\n&lt;p&gt;Rookå®˜ç½‘ï¼šhttps://rook.io&lt;br&gt;\nRookæ˜¯äº‘åŸç”Ÿè®¡ç®—åŸºé‡‘ä¼š(CNCF)çš„å­µåŒ–çº§é¡¹ç›®.&lt;br&gt;\nRookæ˜¯Kubernetesçš„å¼€æºäº‘æœ¬åœ°å­˜å‚¨åè°ƒå™¨ï¼Œä¸ºå„ç§å­˜å‚¨è§£å†³æ–¹æ¡ˆæä¾›å¹³å°ï¼Œæ¡†æ¶å’Œæ”¯æŒï¼Œä»¥ä¾¿ä¸äº‘åŸç”Ÿç¯å¢ƒæœ¬åœ°é›†æˆã€‚&lt;br&gt;\nè‡³äºCEPHï¼Œå®˜ç½‘åœ¨è¿™ï¼šhttps://ceph.com/&lt;br&gt;\ncephå®˜æ–¹æä¾›çš„helméƒ¨ç½²ï¼Œè‡³ä»Šæˆ‘æ²¡æˆåŠŸè¿‡ï¼Œæ‰€ä»¥è½¬å‘ä½¿ç”¨rookæä¾›çš„æ–¹æ¡ˆ&lt;br&gt;\næœ‰é“ç¬”è®°åŸæ–‡ï¼šhttp://note.youdao.com/noteshare?id=281719f1f0374f787effc90067e0d5ad&amp;amp;sub=0B59EA339D4A4769B55F008D72C1A4C0&lt;/p&gt;\n&lt;h1 id=\&#34;ç¯å¢ƒ\&#34;&gt;ç¯å¢ƒ&lt;/h1&gt;\n&lt;pre&gt;&lt;code&gt;centos 7.5\nkernel 4.18.7-1.el7.elrepo.x86_64\ndocker 18.06\nkubernetes v1.12.2\n    kubeadméƒ¨ç½²ï¼š\n        ç½‘ç»œ: canal\n        DNS: coredns\n    é›†ç¾¤æˆå‘˜ï¼š    \n    192.168.1.1 kube-master\n    192.168.1.2 kube-node1\n    192.168.1.3 kube-node2\n    192.168.1.4 kube-node3\n    192.168.1.5 kube-node4\n\næ‰€æœ‰nodeèŠ‚ç‚¹å‡†å¤‡ä¸€å—200Gçš„ç£ç›˜ï¼š/dev/sdb\nkubernetesæ­å»ºrook-ceph\n&lt;/code&gt;&lt;/pre&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588233297037.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;h1 id=\&#34;å‡†å¤‡å·¥ä½œ\&#34;&gt;å‡†å¤‡å·¥ä½œ&lt;/h1&gt;\n&lt;p&gt;æ‰€æœ‰èŠ‚ç‚¹å¼€å¯ip_forward&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;cat &amp;lt;&amp;lt;EOF &amp;gt;  /etc/sysctl.d/ceph.conf\nnet.ipv4.ip_forward = 1\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.bridge.bridge-nf-call-iptables = 1\nEOF\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;sysctl -p&lt;/p&gt;\n&lt;h1 id=\&#34;å¼€å§‹éƒ¨ç½²operator\&#34;&gt;å¼€å§‹éƒ¨ç½²Operator&lt;/h1&gt;\n&lt;h2 id=\&#34;éƒ¨ç½²rook-operator\&#34;&gt;éƒ¨ç½²Rook Operator&lt;/h2&gt;\n&lt;pre&gt;&lt;code&gt;cd $HOME\ngit clone https://github.com/rook/rook.git\n\ncd rook\ncd cluster/examples/kubernetes/ceph\nkubectl apply -f operator.yaml\n&lt;/code&gt;&lt;/pre&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;2\&#34;&gt;&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588233371696.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;h2 id=\&#34;æŸ¥çœ‹operatorçš„çŠ¶æ€\&#34;&gt;æŸ¥çœ‹Operatorçš„çŠ¶æ€&lt;/h2&gt;\n&lt;p&gt;æ‰§è¡Œapplyä¹‹åç¨ç­‰ä¸€ä¼š&lt;br&gt;\noperatorä¼šåœ¨é›†ç¾¤å†…çš„æ¯ä¸ªä¸»æœºåˆ›å»ºä¸¤ä¸ªpod:rook-discover,rook-ceph-agent&lt;/p&gt;\n&lt;p&gt;kubectl -n rook-ceph-system get pod -o wide&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588233523024.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;ç»™èŠ‚ç‚¹æ‰“æ ‡ç­¾\&#34;&gt;ç»™èŠ‚ç‚¹æ‰“æ ‡ç­¾&lt;/h2&gt;\n&lt;p&gt;è¿è¡Œceph-monçš„èŠ‚ç‚¹æ‰“ä¸Šï¼šceph-mon=enabled&lt;br&gt;\nkubectl label nodes {kube-node1,kube-node2,kube-node3} ceph-mon=enabled&lt;br&gt;\nè¿è¡Œceph-osdçš„èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯å­˜å‚¨èŠ‚ç‚¹ï¼Œæ‰“ä¸Šï¼šceph-osd=enabled&lt;br&gt;\nkubectl label nodes {kube-node1,kube-node2,kube-node3} ceph-osd=enabled&lt;br&gt;\nè¿è¡Œceph-mgrçš„èŠ‚ç‚¹ï¼Œæ‰“ä¸Šï¼šceph-mgr=enabled&lt;br&gt;\nmgråªèƒ½æ”¯æŒä¸€ä¸ªèŠ‚ç‚¹è¿è¡Œï¼Œè¿™æ˜¯cephè·‘k8sé‡Œçš„å±€é™&lt;br&gt;\nkubectl label nodes kube-node1 ceph-mgr=enabled&lt;/p&gt;\n&lt;h2 id=\&#34;é…ç½®clusteryamlæ–‡ä»¶\&#34;&gt;é…ç½®cluster.yamlæ–‡ä»¶&lt;/h2&gt;\n&lt;p&gt;å®˜æ–¹é…ç½®æ–‡ä»¶è¯¦è§£ï¼šhttps://rook.io/docs/rook/v0.8/ceph-cluster-crd.html&lt;br&gt;\næ–‡ä»¶ä¸­æœ‰å‡ ä¸ªåœ°æ–¹è¦æ³¨æ„ï¼š&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;dataDirHostPath: è¿™ä¸ªè·¯å¾„æ˜¯ä¼šåœ¨å®¿ä¸»æœºä¸Šç”Ÿæˆçš„ï¼Œä¿å­˜çš„æ˜¯cephçš„ç›¸å…³çš„é…ç½®æ–‡ä»¶ï¼Œå†é‡æ–°ç”Ÿæˆ*é›†ç¾¤çš„æ—¶å€™è¦ç¡®ä¿è¿™ä¸ªç›®å½•ä¸ºç©ºï¼Œå¦åˆ™monä¼šæ— æ³•å¯åŠ¨&lt;/li&gt;\n&lt;li&gt;useAllDevices: ä½¿ç”¨æ‰€æœ‰çš„è®¾å¤‡ï¼Œå»ºè®®ä¸ºfalseï¼Œå¦åˆ™ä¼šæŠŠå®¿ä¸»æœºæ‰€æœ‰å¯ç”¨çš„ç£ç›˜éƒ½å¹²æ‰&lt;/li&gt;\n&lt;li&gt;useAllNodesï¼šä½¿ç”¨æ‰€æœ‰çš„nodeèŠ‚ç‚¹ï¼Œå»ºè®®ä¸ºfalseï¼Œè‚¯å®šä¸ä¼šç”¨k8sé›†ç¾¤å†…çš„æ‰€æœ‰nodeæ¥æ­å»ºcephçš„&lt;/li&gt;\n&lt;li&gt;databaseSizeMBå’ŒjournalSizeMBï¼šå½“ç£ç›˜å¤§äº100Gçš„æ—¶å€™ï¼Œå°±æ³¨é‡Šè¿™ä¿©é¡¹å°±è¡Œäº†&lt;br&gt;\næœ¬æ¬¡å®éªŒç”¨åˆ°çš„ cluster.yaml æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre&gt;&lt;code&gt;apiVersion: v1\nkind: Namespace\nmetadata:\n  name: rook-ceph\n---\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: rook-ceph-cluster\n  namespace: rook-ceph\n---\nkind: Role\napiVersion: rbac.authorization.k8s.io/v1beta1\nmetadata:\n  name: rook-ceph-cluster\n  namespace: rook-ceph\nrules:\n- apiGroups: [&amp;quot;&amp;quot;]\n  resources: [&amp;quot;configmaps&amp;quot;]\n  verbs: [ &amp;quot;get&amp;quot;, &amp;quot;list&amp;quot;, &amp;quot;watch&amp;quot;, &amp;quot;create&amp;quot;, &amp;quot;update&amp;quot;, &amp;quot;delete&amp;quot; ]\n---\n# Allow the operator to create resources in this cluster&#39;s namespace\nkind: RoleBinding\napiVersion: rbac.authorization.k8s.io/v1beta1\nmetadata:\n  name: rook-ceph-cluster-mgmt\n  namespace: rook-ceph\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: rook-ceph-cluster-mgmt\nsubjects:\n- kind: ServiceAccount\n  name: rook-ceph-system\n  namespace: rook-ceph-system\n---\n# Allow the pods in this namespace to work with configmaps\nkind: RoleBinding\napiVersion: rbac.authorization.k8s.io/v1beta1\nmetadata:\n  name: rook-ceph-cluster\n  namespace: rook-ceph\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: Role\n  name: rook-ceph-cluster\nsubjects:\n- kind: ServiceAccount\n  name: rook-ceph-cluster\n  namespace: rook-ceph\n---\napiVersion: ceph.rook.io/v1beta1\nkind: Cluster\nmetadata:\n  name: rook-ceph\n  namespace: rook-ceph\nspec:\n  cephVersion:\n    # The container image used to launch the Ceph daemon pods (mon, mgr, osd, mds, rgw).\n    # v12 is luminous, v13 is mimic, and v14 is nautilus.\n    # RECOMMENDATION: In production, use a specific version tag instead of the general v13 flag, which pulls the latest release and could result in different\n    # versions running within the cluster. See tags available at https://hub.docker.com/r/ceph/ceph/tags/.\n    image: ceph/ceph:v13\n    # Whether to allow unsupported versions of Ceph. Currently only luminous and mimic are supported.\n    # After nautilus is released, Rook will be updated to support nautilus.\n    # Do not set to true in production.\n    allowUnsupported: false\n  # The path on the host where configuration files will be persisted. If not specified, a kubernetes emptyDir will be created (not recommended).\n  # Important: if you reinstall the cluster, make sure you delete this directory from each host or else the mons will fail to start on the new cluster.\n  # In Minikube, the &#39;/data&#39; directory is configured to persist across reboots. Use &amp;quot;/data/rook&amp;quot; in Minikube environment.\n  dataDirHostPath: /var/lib/rook\n  # The service account under which to run the daemon pods in this cluster if the default account is not sufficient (OSDs)\n  serviceAccount: rook-ceph-cluster\n  # set the amount of mons to be started\n  # countå¯ä»¥å®šä¹‰ceph-monè¿è¡Œçš„æ•°é‡ï¼Œè¿™é‡Œé»˜è®¤ä¸‰ä¸ªå°±è¡Œäº†\n  mon:\n    count: 3\n    allowMultiplePerNode: true\n  # enable the ceph dashboard for viewing cluster status\n  # å¼€å¯cephèµ„æºé¢æ¿\n  dashboard:\n    enabled: true\n    # serve the dashboard under a subpath (useful when you are accessing the dashboard via a reverse proxy)\n    # urlPrefix: /ceph-dashboard\n  network:\n    # toggle to use hostNetwork\n    # ä½¿ç”¨å®¿ä¸»æœºçš„ç½‘ç»œè¿›è¡Œé€šè®¯\n    # ä½¿ç”¨å®¿ä¸»æœºçš„ç½‘ç»œè²Œä¼¼å¯ä»¥è®©é›†ç¾¤å¤–çš„ä¸»æœºæŒ‚è½½ceph\n    # ä½†æ˜¯æˆ‘æ²¡è¯•è¿‡ï¼Œæœ‰å…´è¶£çš„å…„å¼Ÿå¯ä»¥è¯•è¯•æ”¹æˆtrue\n    # åæ­£è¿™é‡Œåªæ˜¯é›†ç¾¤å†…ç”¨ï¼Œæˆ‘å°±ä¸æ”¹äº†\n    hostNetwork: false\n  # To control where various services will be scheduled by kubernetes, use the placement configuration sections below.\n  # The example under &#39;all&#39; would have all services scheduled on kubernetes nodes labeled with &#39;role=storage-node&#39; and\n  # tolerate taints with a key of &#39;storage-node&#39;.\n  placement:\n#    all:\n#      nodeAffinity:\n#        requiredDuringSchedulingIgnoredDuringExecution:\n#          nodeSelectorTerms:\n#          - matchExpressions:\n#            - key: role\n#              operator: In\n#              values:\n#              - storage-node\n#      podAffinity:\n#      podAntiAffinity:\n#      tolerations:\n#      - key: storage-node\n#        operator: Exists\n# The above placement information can also be specified for mon, osd, and mgr components\n#    mon:\n#    osd:\n#    mgr:\n# nodeAffinityï¼šé€šè¿‡é€‰æ‹©æ ‡ç­¾çš„æ–¹å¼ï¼Œå¯ä»¥é™åˆ¶podè¢«è°ƒåº¦åˆ°ç‰¹å®šçš„èŠ‚ç‚¹ä¸Š\n# å»ºè®®é™åˆ¶ä¸€ä¸‹ï¼Œä¸ºäº†è®©è¿™å‡ ä¸ªpodä¸ä¹±è·‘\n    mon:\n      nodeAffinity:\n        requiredDuringSchedulingIgnoredDuringExecution:\n          nodeSelectorTerms:\n          - matchExpressions:\n            - key: ceph-mon\n              operator: In\n              values:\n              - enabled\n    osd:\n      nodeAffinity:\n        requiredDuringSchedulingIgnoredDuringExecution:\n          nodeSelectorTerms:\n          - matchExpressions:\n            - key: ceph-osd\n              operator: In\n              values:\n              - enabled\n    mgr:\n      nodeAffinity:\n        requiredDuringSchedulingIgnoredDuringExecution:\n          nodeSelectorTerms:\n          - matchExpressions:\n            - key: ceph-mgr\n              operator: In\n              values:\n              - enabled\n  resources:\n# The requests and limits set here, allow the mgr pod to use half of one CPU core and 1 gigabyte of memory\n#    mgr:\n#      limits:\n#        cpu: &amp;quot;500m&amp;quot;\n#        memory: &amp;quot;1024Mi&amp;quot;\n#      requests:\n#        cpu: &amp;quot;500m&amp;quot;\n#        memory: &amp;quot;1024Mi&amp;quot;\n# The above example requests/limits can also be added to the mon and osd components\n#    mon:\n#    osd:\n  storage: # cluster level storage configuration and selection\n    useAllNodes: false\n    useAllDevices: false\n    deviceFilter:\n    location:\n    config:\n      # The default and recommended storeType is dynamically set to bluestore for devices and filestore for directories.\n      # Set the storeType explicitly only if it is required not to use the default.\n      # storeType: bluestore\n      # databaseSizeMB: &amp;quot;1024&amp;quot; # this value can be removed for environments with normal sized disks (100 GB or larger)\n      # journalSizeMB: &amp;quot;1024&amp;quot;  # this value can be removed for environments with normal sized disks (20 GB or larger)\n# Cluster level list of directories to use for storage. These values will be set for all nodes that have no `directories` set.\n#    directories:\n#    - path: /rook/storage-dir\n# Individual nodes and their config can be specified as well, but &#39;useAllNodes&#39; above must be set to false. Then, only the named\n# nodes below will be used as storage resources.  Each node&#39;s &#39;name&#39; field should match their &#39;kubernetes.io/hostname&#39; label.\n#å»ºè®®ç£ç›˜é…ç½®æ–¹å¼å¦‚ä¸‹ï¼š\n#name: é€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹åå­—ä¸ºkubernetes.io/hostnameçš„æ ‡ç­¾ï¼Œä¹Ÿå°±æ˜¯kubectl get nodesçœ‹åˆ°çš„åå­—\n#devices: é€‰æ‹©ç£ç›˜è®¾ç½®ä¸ºOSD\n# - name: &amp;quot;sdb&amp;quot;:å°†/dev/sdbè®¾ç½®ä¸ºosd\n    nodes:\n    - name: &amp;quot;kube-node1&amp;quot;\n      devices:\n      - name: &amp;quot;sdb&amp;quot;\n    - name: &amp;quot;kube-node2&amp;quot;\n      devices:\n      - name: &amp;quot;sdb&amp;quot;\n    - name: &amp;quot;kube-node3&amp;quot;\n      devices:\n      - name: &amp;quot;sdb&amp;quot;\n\n#      directories: # specific directories to use for storage can be specified for each node\n#      - path: &amp;quot;/rook/storage-dir&amp;quot;\n#      resources:\n#        limits:\n#          cpu: &amp;quot;500m&amp;quot;\n#          memory: &amp;quot;1024Mi&amp;quot;\n#        requests:\n#          cpu: &amp;quot;500m&amp;quot;\n#          memory: &amp;quot;1024Mi&amp;quot;\n#    - name: &amp;quot;172.17.4.201&amp;quot;\n#      devices: # specific devices to use for storage can be specified for each node\n#      - name: &amp;quot;sdb&amp;quot;\n#      - name: &amp;quot;sdc&amp;quot;\n#      config: # configuration can be specified at the node level which overrides the cluster level config\n#        storeType: filestore\n#    - name: &amp;quot;172.17.4.301&amp;quot;\n#      deviceFilter: &amp;quot;^sd.&amp;quot;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;å¼€å§‹éƒ¨ç½²ceph\&#34;&gt;å¼€å§‹éƒ¨ç½²ceph&lt;/h2&gt;\n&lt;p&gt;éƒ¨ç½²ceph&lt;br&gt;\nkubectl apply -f cluster.yaml&lt;br&gt;\nclusterä¼šåœ¨rook-cephè¿™ä¸ªnamesapceåˆ›å»ºèµ„æº&lt;br&gt;\nçœ‹åˆ°æ‰€æœ‰çš„podéƒ½Runningå°±è¡Œäº†&lt;br&gt;\næ³¨æ„çœ‹ä¸€ä¸‹podåˆ†å¸ƒçš„å®¿ä¸»æœºï¼Œè·Ÿæˆ‘ä»¬æ‰“æ ‡ç­¾çš„ä¸»æœºæ˜¯ä¸€è‡´çš„&lt;br&gt;\nkubectl -n rook-ceph get pod -o wide&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588233756856.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;åˆ‡æ¢åˆ°å…¶ä»–ä¸»æœºçœ‹ä¸€ä¸‹ç£ç›˜&lt;/p&gt;\n&lt;p&gt;åˆ‡æ¢åˆ°kube-node1&lt;br&gt;\nlsblk&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588233803458.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;é…ç½®ceph-dashboard\&#34;&gt;é…ç½®ceph dashboard&lt;/h2&gt;\n&lt;p&gt;çœ‹ä¸€çœ¼dashboardåœ¨å“ªä¸ªserviceä¸Š&lt;br&gt;\nkubectl -n rook-ceph get service&lt;br&gt;\nå¯ä»¥çœ‹åˆ°dashboardç›‘å¬äº†8443ç«¯å£&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588233853544.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;åˆ›å»ºä¸ªnodeportç±»å‹çš„serviceä»¥ä¾¿é›†ç¾¤å¤–éƒ¨è®¿é—®&lt;br&gt;\nkubectl apply -f dashboard-external-https.yaml&lt;/p&gt;\n&lt;p&gt;æŸ¥çœ‹ä¸€ä¸‹nodeportåœ¨å“ªä¸ªç«¯å£&lt;br&gt;\nkubectl -n rook-ceph get service&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588233909644.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;æ‰¾å‡ºDashboardçš„ç™»é™†è´¦å·å’Œå¯†ç &lt;br&gt;\nMGR_POD=&lt;code&gt;kubectl get pod -n rook-ceph | grep mgr | awk &#39;{print $1}&#39;&lt;/code&gt;&lt;br&gt;\nkubectl -n rook-ceph logs $MGR_POD | grep password&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588233955731.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;æ‰“å¼€æµè§ˆå™¨è¾“å…¥ä»»æ„ä¸€ä¸ªNodeçš„IP+nodeportç«¯å£&lt;br&gt;\nè¿™é‡Œæˆ‘çš„å°±æ˜¯ï¼šhttps://192.168.1.2:30290&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588234024005.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588234065656.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;é…ç½®cephä¸ºstorageclass\&#34;&gt;é…ç½®cephä¸ºstorageclass&lt;/h2&gt;\n&lt;p&gt;å®˜æ–¹ç»™äº†ä¸€ä¸ªæ ·æœ¬æ–‡ä»¶ï¼šstorageclass.yaml&lt;br&gt;\nè¿™ä¸ªæ–‡ä»¶ä½¿ç”¨çš„æ˜¯ RBD å—å­˜å‚¨&lt;br&gt;\npoolåˆ›å»ºè¯¦è§£ï¼šhttps://rook.io/docs/rook/v0.8/ceph-pool-crd.html&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;apiVersion: ceph.rook.io/v1beta1\nkind: Pool\nmetadata:\n  #è¿™ä¸ªnameå°±æ˜¯åˆ›å»ºæˆceph poolä¹‹åçš„poolåå­—\n  name: replicapool\n  namespace: rook-ceph\nspec:\n  replicated:\n    size: 1\n  # size æ± ä¸­æ•°æ®çš„å‰¯æœ¬æ•°,1å°±æ˜¯ä¸ä¿å­˜ä»»ä½•å‰¯æœ¬\n  failureDomain: osd\n  #  failureDomainï¼šæ•°æ®å—çš„æ•…éšœåŸŸï¼Œ\n  #  å€¼ä¸ºhostæ—¶ï¼Œæ¯ä¸ªæ•°æ®å—å°†æ”¾ç½®åœ¨ä¸åŒçš„ä¸»æœºä¸Š\n  #  å€¼ä¸ºosdæ—¶ï¼Œæ¯ä¸ªæ•°æ®å—å°†æ”¾ç½®åœ¨ä¸åŒçš„osdä¸Š\n---\napiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n   name: ceph\n   # StorageClassçš„åå­—ï¼Œpvcè°ƒç”¨æ—¶å¡«çš„åå­—\nprovisioner: ceph.rook.io/block\nparameters:\n  pool: replicapool\n  # Specify the namespace of the rook cluster from which to create volumes.\n  # If not specified, it will use `rook` as the default namespace of the cluster.\n  # This is also the namespace where the cluster will be\n  clusterNamespace: rook-ceph\n  # Specify the filesystem type of the volume. If not specified, it will use `ext4`.\n  fstype: xfs\n# è®¾ç½®å›æ”¶ç­–ç•¥é»˜è®¤ä¸ºï¼šRetain\nreclaimPolicy: Retain\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;åˆ›å»ºstorageclass\&#34;&gt;åˆ›å»ºStorageClass&lt;/h2&gt;\n&lt;p&gt;kubectl apply -f storageclass.yaml&lt;br&gt;\nkubectl get storageclasses.storage.k8s.io  -n rook-ceph&lt;br&gt;\nkubectl describe storageclasses.storage.k8s.io  -n rook-ceph&lt;br&gt;\nkubernetesæ­å»ºrook-ceph&lt;/p&gt;\n&lt;p&gt;åˆ›å»ºä¸ªnginx podå°è¯•æŒ‚è½½&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;cat &amp;lt;&amp;lt; EOF &amp;gt; nginx.yaml\n---\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: nginx-pvc\nspec:\n  accessModes:\n    - ReadWriteMany\n  resources:\n    requests:\n      storage: 1Gi\n  storageClassName: ceph\n\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: nginx\nspec:\n  selector:\n    app: nginx\n  ports: \n  - port: 80\n    name: nginx-port\n    targetPort: 80\n    protocol: TCP\n\n---\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx\n        ports:\n        - containerPort: 80\n        volumeMounts:\n        - mountPath: /html\n          name: http-file\n      volumes:\n      - name: http-file\n        persistentVolumeClaim:\n          claimName: nginx-pvc\nEOF\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;kubectl apply -f nginx.yaml&lt;br&gt;\næŸ¥çœ‹pv,pvcæ˜¯å¦åˆ›å»ºäº†&lt;br&gt;\nkubectl get pv,pvc&lt;/p&gt;\n&lt;p&gt;çœ‹ä¸€ä¸‹nginxè¿™ä¸ªpodä¹Ÿè¿è¡Œäº†&lt;br&gt;\nkubectl get pod&lt;/p&gt;\n&lt;p&gt;åˆ é™¤è¿™ä¸ªpod,çœ‹pvæ˜¯å¦è¿˜å­˜åœ¨&lt;br&gt;\nkubectl delete -f nginx.yaml&lt;/p&gt;\n&lt;p&gt;kubectl get pv,pvc&lt;br&gt;\nå¯ä»¥çœ‹åˆ°ï¼Œpodå’Œpvcéƒ½å·²ç»è¢«åˆ é™¤äº†ï¼Œä½†æ˜¯pvè¿˜åœ¨ï¼ï¼ï¼&lt;/p&gt;\n&lt;h2 id=\&#34;æ·»åŠ æ–°èŠ‚ç‚¹è¿›å…¥é›†ç¾¤\&#34;&gt;æ·»åŠ æ–°èŠ‚ç‚¹è¿›å…¥é›†ç¾¤&lt;/h2&gt;\n&lt;p&gt;è¿™æ¬¡æˆ‘ä»¬è¦æŠŠnode4æ·»åŠ è¿›é›†ç¾¤ï¼Œå…ˆæ‰“æ ‡ç­¾&lt;br&gt;\nkubectl label nodes kube-node4 ceph-osd=enabled&lt;br&gt;\né‡æ–°ç¼–è¾‘cluster.yamlæ–‡ä»¶&lt;br&gt;\nåŸæ¥çš„åŸºç¡€ä¸Šæ·»åŠ node4çš„ä¿¡æ¯&lt;/p&gt;\n&lt;p&gt;cd $HOME/rook/cluster/examples/kubernetes/ceph/&lt;br&gt;\nvi cluster.yam&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588234207475.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;applyä¸€ä¸‹cluster.yamlæ–‡ä»¶&lt;br&gt;\nkubectl apply -f cluster.yaml&lt;/p&gt;\n&lt;p&gt;ç›¯ç€rook-cephåç§°ç©ºé—´,é›†ç¾¤ä¼šè‡ªåŠ¨æ·»åŠ node4è¿›æ¥&lt;br&gt;\nkubectl -n rook-ceph get pod -o wide -w&lt;br&gt;\nkubectl -n rook-ceph get pod -o wide&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588234283568.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588234307875.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\nå»node4èŠ‚ç‚¹çœ‹ä¸€ä¸‹ç£ç›˜&lt;br&gt;\nlsblk&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588234334204.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹\&#34;&gt;åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹&lt;/h2&gt;\n&lt;p&gt;å»æ‰node3çš„æ ‡ç­¾&lt;br&gt;\nkubectl label nodes kube-node3 ceph-osd-&lt;br&gt;\né‡æ–°ç¼–è¾‘cluster.yamlæ–‡ä»¶&lt;br&gt;\nåˆ é™¤node3çš„ä¿¡æ¯&lt;br&gt;\ncd $HOME/rook/cluster/examples/kubernetes/ceph/&lt;br&gt;\nvi cluster.yam&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588234380826.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;applyä¸€ä¸‹cluster.yamlæ–‡ä»¶&lt;br&gt;\nkubectl apply -f cluster.yaml&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588234493936.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;kubectl -n rook-ceph get pod -o wide&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588234548709.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\n&lt;img src=\&#34;http://lvelvis.github.io/post-images/1588234579591.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\næœ€åè®°å¾—åˆ é™¤å®¿ä¸»æœºçš„/var/lib/rookæ–‡ä»¶å¤¹&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;kubernetesæ­å»ºrook-ceph&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;kubernetesæ­å»ºrook-ceph&#34;,&#34;tags&#34;:[{&#34;index&#34;:-1,&#34;name&#34;:&#34;k8s&#34;,&#34;slug&#34;:&#34;Q617Y3Kh2&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/Q617Y3Kh2/&#34;},{&#34;name&#34;:&#34;rook-ceph&#34;,&#34;slug&#34;:&#34;hu0mNDfuy&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/hu0mNDfuy/&#34;},{&#34;name&#34;:&#34;ceph&#34;,&#34;slug&#34;:&#34;MkN4-Vurh-&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;http://lvelvis.github.io/tag/MkN4-Vurh-/&#34;}],&#34;date&#34;:&#34;2019-12-12 00:00:00&#34;,&#34;dateFormat&#34;:&#34;2019-12-12&#34;,&#34;feature&#34;:&#34;http://lvelvis.github.io/post-images/kubernetesæ­å»ºrook-ceph.png&#34;,&#34;link&#34;:&#34;http://lvelvis.github.io/post/kubernetesæ­å»ºrook-ceph/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;13 min read&#34;,&#34;time&#34;:779000,&#34;words&#34;:2524,&#34;minutes&#34;:13},&#34;description&#34;:&#34;ç®€ä»‹\nRookå®˜ç½‘ï¼šhttps://rook.io\nRookæ˜¯äº‘åŸç”Ÿè®¡ç®—åŸºé‡‘ä¼š(CNCF)çš„å­µåŒ–çº§é¡¹ç›®.\nRookæ˜¯Kubernetesçš„å¼€æºäº‘æœ¬åœ°å­˜å‚¨åè°ƒå™¨ï¼Œä¸ºå„ç§å­˜å‚¨è§£å†³æ–¹æ¡ˆæä¾›å¹³å°ï¼Œæ¡†æ¶å’Œæ”¯æŒï¼Œä»¥ä¾¿ä¸äº‘åŸç”Ÿç¯å¢ƒæœ¬åœ°é›†æˆã€‚\nè‡³äºCEPH...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%AE%80%E4%BB%8B\&#34;&gt;ç®€ä»‹&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%8E%AF%E5%A2%83\&#34;&gt;ç¯å¢ƒ&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C\&#34;&gt;å‡†å¤‡å·¥ä½œ&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%BC%80%E5%A7%8B%E9%83%A8%E7%BD%B2operator\&#34;&gt;å¼€å§‹éƒ¨ç½²Operator&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E9%83%A8%E7%BD%B2rook-operator\&#34;&gt;éƒ¨ç½²Rook Operator&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%9F%A5%E7%9C%8Boperator%E7%9A%84%E7%8A%B6%E6%80%81\&#34;&gt;æŸ¥çœ‹Operatorçš„çŠ¶æ€&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%BB%99%E8%8A%82%E7%82%B9%E6%89%93%E6%A0%87%E7%AD%BE\&#34;&gt;ç»™èŠ‚ç‚¹æ‰“æ ‡ç­¾&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E9%85%8D%E7%BD%AEclusteryaml%E6%96%87%E4%BB%B6\&#34;&gt;é…ç½®cluster.yamlæ–‡ä»¶&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%BC%80%E5%A7%8B%E9%83%A8%E7%BD%B2ceph\&#34;&gt;å¼€å§‹éƒ¨ç½²ceph&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E9%85%8D%E7%BD%AEceph-dashboard\&#34;&gt;é…ç½®ceph dashboard&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E9%85%8D%E7%BD%AEceph%E4%B8%BAstorageclass\&#34;&gt;é…ç½®cephä¸ºstorageclass&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%88%9B%E5%BB%BAstorageclass\&#34;&gt;åˆ›å»ºStorageClass&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%B7%BB%E5%8A%A0%E6%96%B0%E8%8A%82%E7%82%B9%E8%BF%9B%E5%85%A5%E9%9B%86%E7%BE%A4\&#34;&gt;æ·»åŠ æ–°èŠ‚ç‚¹è¿›å…¥é›†ç¾¤&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%88%A0%E9%99%A4%E4%B8%80%E4%B8%AA%E8%8A%82%E7%82%B9\&#34;&gt;åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;blockquote&gt;\n&lt;p&gt;æ¬¢è¿æ¥åˆ°æˆ‘çš„å°ç«™å‘€ï¼Œå¾ˆé«˜å…´é‡è§ä½ ï¼ğŸ¤&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;h2 id=\&#34;å…³äºæœ¬ç«™\&#34;&gt;ğŸ  å…³äºæœ¬ç«™&lt;/h2&gt;\n&lt;p&gt;è®°å½•å¹³æ—¶è¿ç»´ç›¸å…³çš„æŠ€æœ¯:&lt;br&gt;\n1.ç½‘ç»œ&lt;br&gt;\n2.ç³»ç»Ÿ&lt;br&gt;\n3.è™šæ‹ŸåŒ–&lt;br&gt;\n4.æ•°æ®åº“&lt;br&gt;\n5.ä¸­é—´ä»¶&lt;br&gt;\n...&lt;/p&gt;\n&lt;h2 id=\&#34;åšä¸»æ˜¯è°\&#34;&gt;ğŸ‘¨â€ğŸ’» åšä¸»æ˜¯è°&lt;/h2&gt;\n&lt;p&gt;ç›®å‰åœ¨èŒäºå·¨äººç½‘ç»œ&lt;/p&gt;\n&lt;h2 id=\&#34;å…´è¶£çˆ±å¥½\&#34;&gt;â›¹ å…´è¶£çˆ±å¥½&lt;/h2&gt;\n&lt;p&gt;ç•ªå‰§ FPSå°„å‡»æ¸¸æˆ dota&lt;/p&gt;\n&lt;h2 id=\&#34;è”ç³»æˆ‘å‘€\&#34;&gt;ğŸ“¬ è”ç³»æˆ‘å‘€&lt;/h2&gt;\n&#34;,&#34;fileName&#34;:&#34;about&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;å…³äº&#34;,&#34;tags&#34;:[],&#34;date&#34;:&#34;2019-01-25 19:09:48&#34;,&#34;dateFormat&#34;:&#34;2019-01-25&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;http://lvelvis.github.io/post/about/&#34;,&#34;hideInList&#34;:true,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;1 min read&#34;,&#34;time&#34;:16000,&#34;words&#34;:77,&#34;minutes&#34;:1},&#34;description&#34;:&#34;\næ¬¢è¿æ¥åˆ°æˆ‘çš„å°ç«™å‘€ï¼Œå¾ˆé«˜å…´é‡è§ä½ ï¼ğŸ¤\n\nğŸ  å…³äºæœ¬ç«™\nè®°å½•å¹³æ—¶è¿ç»´ç›¸å…³çš„æŠ€æœ¯:\n1.ç½‘ç»œ\n2.ç³»ç»Ÿ\n3.è™šæ‹ŸåŒ–\n4.æ•°æ®åº“\n5.ä¸­é—´ä»¶\n...\nğŸ‘¨â€ğŸ’» åšä¸»æ˜¯è°\nç›®å‰åœ¨èŒäºå·¨äººç½‘ç»œ\nâ›¹ å…´è¶£çˆ±å¥½\nç•ªå‰§ FPSå°„å‡»æ¸¸æˆ dota\n\ud83d...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%85%B3%E4%BA%8E%E6%9C%AC%E7%AB%99\&#34;&gt;ğŸ  å…³äºæœ¬ç«™&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%8D%9A%E4%B8%BB%E6%98%AF%E8%B0%81\&#34;&gt;ğŸ‘¨â€ğŸ’» åšä¸»æ˜¯è°&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%85%B4%E8%B6%A3%E7%88%B1%E5%A5%BD\&#34;&gt;â›¹ å…´è¶£çˆ±å¥½&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%81%94%E7%B3%BB%E6%88%91%E5%91%80\&#34;&gt;ğŸ“¬ è”ç³»æˆ‘å‘€&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;}]";
  // var json = escape.substr(1, escape.length - 2);
  // var datas = json.split(',');
  // for (let i=0; i < datas.length; i++) {
  //   let item = datas[i];
  //   let attrs = item.split('34;:&#34')
  //   debugger
  //   console.log(datas[i])
  // }
  let escapeMap = new Map();
  escapeMap.set('&#34;', '"');
  escapeMap.set('&gt;', '>');
  escapeMap.set('&#39;', "'");
  escapeMap.set('&lt;', '<');
  escapeMap.set('&quot;', '"');
  escapeMap.set('&amp;', '&');
</script> -->

<script src="/media/js/mouse/peace.js"></script>


<script src=" /media/js/cool.js"></script>


</html>